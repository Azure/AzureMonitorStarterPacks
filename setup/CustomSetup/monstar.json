{
  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.32.4.45862",
      "templateHash": "6745167425505354642"
    }
  },
  "parameters": {
    "mgname": {
      "type": "string"
    },
    "subscriptionId": {
      "type": "string"
    },
    "resourceGroupName": {
      "type": "string"
    },
    "createNewResourceGroup": {
      "type": "bool",
      "defaultValue": false
    },
    "location": {
      "type": "string"
    },
    "newLogAnalyticsWSName": {
      "type": "string",
      "defaultValue": ""
    },
    "createNewLogAnalyticsWS": {
      "type": "bool"
    },
    "existingLogAnalyticsWSId": {
      "type": "string",
      "defaultValue": ""
    },
    "grafanaLocation": {
      "type": "string",
      "defaultValue": ""
    },
    "grafanaName": {
      "type": "string",
      "defaultValue": ""
    },
    "newGrafana": {
      "type": "bool"
    },
    "existingGrafanaResourceId": {
      "type": "string",
      "defaultValue": ""
    },
    "storageAccountName": {
      "type": "string"
    },
    "createNewStorageAccount": {
      "type": "bool",
      "defaultValue": false
    },
    "resourceGroupId": {
      "type": "string",
      "defaultValue": ""
    },
    "instanceName": {
      "type": "string"
    },
    "deployGrafana": {
      "type": "bool"
    },
    "actionGroupName": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "Name of the Action Group to be used or created."
      }
    },
    "existingActionGroupId": {
      "type": "string",
      "defaultValue": ""
    },
    "emailreceiver": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "Email receiver names to be used for the Action Group if being created."
      }
    },
    "emailreiceversemail": {
      "type": "string",
      "metadata": {
        "description": "Email addresses to be used for the Action Group if being created."
      }
    },
    "useExistingAG": {
      "type": "bool",
      "defaultValue": false,
      "metadata": {
        "description": "If set to true, a new Action group will be created"
      }
    },
    "customerTags": {
      "type": "object"
    },
    "deployAllPacks": {
      "type": "bool"
    },
    "deployIaaSPacks": {
      "type": "bool",
      "defaultValue": false
    },
    "deployDiscovery": {
      "type": "bool",
      "defaultValue": false
    },
    "collectTelemetry": {
      "type": "bool",
      "defaultValue": true
    },
    "appInsightsLocation": {
      "type": "string"
    }
  },
  "variables": {
    "deployPacks": "[or(parameters('deployAllPacks'), parameters('deployIaaSPacks'))]",
    "solutionTag": "MonitorStarterPacks",
    "solutionTagComponents": "MonitorStarterPacksComponents",
    "solutionVersion": "0.1",
    "tempTags": {
      "[format('{0}', variables('solutionTagComponents'))]": "BackendComponent",
      "solutionVersion": "[variables('solutionVersion')]",
      "instanceName": "[parameters('instanceName')]"
    },
    "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
    "functionName": "[format('AMP-{0}-{1}-Function', parameters('instanceName'), split(parameters('subscriptionId'), '-')[0])]",
    "logicAppName": "[format('AMP-{0}-LogicApp', parameters('instanceName'))]",
    "ImageGalleryName": "[format('AMP{0}Gallery', parameters('instanceName'))]"
  },
  "resources": [
    {
      "condition": "[parameters('createNewResourceGroup')]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('RGMonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName'))]",
      "subscriptionId": "[parameters('subscriptionId')]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "resourceGroupName": {
            "value": "[parameters('resourceGroupName')]"
          },
          "location": {
            "value": "[parameters('location')]"
          },
          "Tags": {
            "value": "[variables('Tags')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "17175818948770477909"
            }
          },
          "parameters": {
            "resourceGroupName": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "Tags": {
              "type": "object"
            }
          },
          "resources": [
            {
              "type": "Microsoft.Resources/resourceGroups",
              "apiVersion": "2023-07-01",
              "name": "[parameters('resourceGroupName')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('Tags')]"
            }
          ],
          "outputs": {
            "newResourceGroupId": {
              "type": "string",
              "value": "[subscriptionResourceId('Microsoft.Resources/resourceGroups', parameters('resourceGroupName'))]"
            }
          }
        }
      }
    },
    {
      "condition": "[parameters('createNewStorageAccount')]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('STOmonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName'))]",
      "subscriptionId": "[parameters('subscriptionId')]",
      "resourceGroup": "[parameters('resourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('location')]"
          },
          "Tags": {
            "value": "[variables('Tags')]"
          },
          "storageAccountName": {
            "value": "[parameters('storageAccountName')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "17891774439403355544"
            }
          },
          "parameters": {
            "storageAccountName": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "Tags": {
              "type": "object"
            }
          },
          "resources": [
            {
              "type": "Microsoft.Storage/storageAccounts/blobServices/containers",
              "apiVersion": "2023-01-01",
              "name": "[format('{0}/{1}/{2}', parameters('storageAccountName'), 'default', 'discovery')]",
              "properties": {
                "immutableStorageWithVersioning": {
                  "enabled": false
                },
                "denyEncryptionScopeOverride": false,
                "defaultEncryptionScope": "$account-encryption-key",
                "publicAccess": "None"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts/blobServices', parameters('storageAccountName'), 'default')]"
              ]
            },
            {
              "type": "Microsoft.Storage/storageAccounts/blobServices/containers",
              "apiVersion": "2023-01-01",
              "name": "[format('{0}/{1}/{2}', parameters('storageAccountName'), 'default', 'applications')]",
              "properties": {
                "immutableStorageWithVersioning": {
                  "enabled": false
                },
                "denyEncryptionScopeOverride": false,
                "defaultEncryptionScope": "$account-encryption-key",
                "publicAccess": "None"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts/blobServices', parameters('storageAccountName'), 'default')]"
              ]
            },
            {
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "apiVersion": "2023-01-01",
              "name": "[format('{0}/{1}', parameters('storageAccountName'), 'default')]",
              "properties": {
                "cors": {
                  "corsRules": []
                },
                "deleteRetentionPolicy": {
                  "enabled": false
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
              ]
            },
            {
              "type": "Microsoft.Storage/storageAccounts",
              "apiVersion": "2023-01-01",
              "name": "[parameters('storageAccountName')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('Tags')]",
              "sku": {
                "name": "Standard_LRS"
              },
              "kind": "StorageV2",
              "properties": {
                "accessTier": "Hot",
                "allowBlobPublicAccess": false,
                "allowSharedKeyAccess": true,
                "supportsHttpsTrafficOnly": true
              }
            }
          ],
          "outputs": {
            "storageAccountName": {
              "type": "string",
              "value": "[parameters('storageAccountName')]"
            },
            "storageAccountResourceId": {
              "type": "string",
              "value": "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
            }
          }
        }
      },
      "dependsOn": [
        "[subscriptionResourceId(parameters('subscriptionId'), 'Microsoft.Resources/deployments', format('RGMonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName')))]"
      ]
    },
    {
      "condition": "[not(parameters('createNewStorageAccount'))]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "existingstorage-deployment",
      "subscriptionId": "[parameters('subscriptionId')]",
      "resourceGroup": "[parameters('resourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "storageAccountName": {
            "value": "[parameters('storageAccountName')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "2152510934760472014"
            }
          },
          "parameters": {
            "storageAccountName": {
              "type": "string"
            }
          },
          "resources": [
            {
              "type": "Microsoft.Storage/storageAccounts/blobServices/containers",
              "apiVersion": "2023-01-01",
              "name": "[format('{0}/{1}/{2}', parameters('storageAccountName'), 'default', 'discovery')]",
              "properties": {
                "immutableStorageWithVersioning": {
                  "enabled": false
                },
                "denyEncryptionScopeOverride": false,
                "defaultEncryptionScope": "$account-encryption-key",
                "publicAccess": "None"
              },
              "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts/blobServices', parameters('storageAccountName'), 'default')]"
              ]
            },
            {
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "apiVersion": "2023-01-01",
              "name": "[format('{0}/{1}', parameters('storageAccountName'), 'default')]",
              "properties": {
                "cors": {
                  "corsRules": []
                },
                "deleteRetentionPolicy": {
                  "enabled": false
                }
              }
            }
          ],
          "outputs": {
            "storageAccountName": {
              "type": "string",
              "value": "[parameters('storageAccountName')]"
            },
            "storageAccountResourceId": {
              "type": "string",
              "value": "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
            }
          }
        }
      }
    },
    {
      "condition": "[parameters('createNewLogAnalyticsWS')]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "logAnalytics-Deployment",
      "subscriptionId": "[parameters('subscriptionId')]",
      "resourceGroup": "[parameters('resourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('location')]"
          },
          "logAnalyticsWorkspaceName": {
            "value": "[parameters('newLogAnalyticsWSName')]"
          },
          "Tags": {
            "value": "[variables('Tags')]"
          },
          "createNewLogAnalyticsWS": {
            "value": "[parameters('createNewLogAnalyticsWS')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "1432940353596262082"
            }
          },
          "parameters": {
            "logAnalyticsWorkspaceName": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "newLogAnalyticsWSName": {
              "type": "string",
              "defaultValue": ""
            },
            "createNewLogAnalyticsWS": {
              "type": "bool",
              "defaultValue": false
            },
            "Tags": {
              "type": "object"
            }
          },
          "resources": [
            {
              "type": "Microsoft.OperationalInsights/workspaces",
              "apiVersion": "2022-10-01",
              "name": "[parameters('logAnalyticsWorkspaceName')]",
              "location": "[parameters('location')]",
              "tags": "[parameters('Tags')]",
              "properties": {
                "sku": {
                  "name": "PerGB2018"
                }
              }
            }
          ],
          "outputs": {
            "customerId": {
              "type": "string",
              "value": "[reference(resourceId('Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName')), '2022-10-01').customerId]"
            },
            "lawresourceid": {
              "type": "string",
              "value": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))]"
            }
          }
        }
      },
      "dependsOn": [
        "[subscriptionResourceId(parameters('subscriptionId'), 'Microsoft.Resources/deployments', format('RGMonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName')))]"
      ]
    },
    {
      "condition": "[parameters('deployDiscovery')]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('DeployDiscovery-{0}', parameters('instanceName'))]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('location')]"
          },
          "resourceGroupName": {
            "value": "[parameters('resourceGroupName')]"
          },
          "solutionTag": {
            "value": "[variables('solutionTag')]"
          },
          "solutionVersion": {
            "value": "[variables('solutionVersion')]"
          },
          "subscriptionId": {
            "value": "[parameters('subscriptionId')]"
          },
          "dceId": {
            "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('MonitoringPacks-backend-{0}', parameters('instanceName'))), '2022-09-01').outputs.dceId.value]"
          },
          "imageGalleryName": {
            "value": "[variables('ImageGalleryName')]"
          },
          "lawResourceId": "[if(parameters('createNewLogAnalyticsWS'), createObject('value', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', 'logAnalytics-Deployment'), '2022-09-01').outputs.lawresourceid.value), createObject('value', parameters('existingLogAnalyticsWSId')))]",
          "mgname": {
            "value": "[parameters('mgname')]"
          },
          "storageAccountname": {
            "value": "[parameters('storageAccountName')]"
          },
          "tableName": {
            "value": "Discovery"
          },
          "userManagedIdentityResourceId": {
            "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('MonitoringPacks-backend-{0}', parameters('instanceName'))), '2022-09-01').outputs.packsUserManagedResourceId.value]"
          },
          "Tags": {
            "value": "[variables('Tags')]"
          },
          "instanceName": {
            "value": "[parameters('instanceName')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "591116481738387430"
            }
          },
          "parameters": {
            "location": {
              "type": "string"
            },
            "solutionTag": {
              "type": "string"
            },
            "solutionVersion": {
              "type": "string"
            },
            "subscriptionId": {
              "type": "string"
            },
            "resourceGroupName": {
              "type": "string"
            },
            "storageAccountname": {
              "type": "string"
            },
            "imageGalleryName": {
              "type": "string"
            },
            "lawResourceId": {
              "type": "string"
            },
            "tableName": {
              "type": "string"
            },
            "userManagedIdentityResourceId": {
              "type": "string"
            },
            "mgname": {
              "type": "string"
            },
            "dceId": {
              "type": "string"
            },
            "Tags": {
              "type": "object"
            },
            "instanceName": {
              "type": "string"
            }
          },
          "variables": {
            "tableNameToUse": "[format('{0}_CL', parameters('tableName'))]",
            "lawFriendlyName": "[split(parameters('lawResourceId'), '/')[8]]"
          },
          "resources": [
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('{0}-{1}-{2}', variables('tableNameToUse'), parameters('instanceName'), parameters('location'))]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "parentname": {
                    "value": "[variables('lawFriendlyName')]"
                  },
                  "tableName": {
                    "value": "[variables('tableNameToUse')]"
                  },
                  "retentionDays": {
                    "value": 31
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "2081426938105913058"
                    }
                  },
                  "parameters": {
                    "parentname": {
                      "type": "string"
                    },
                    "tableName": {
                      "type": "string"
                    },
                    "retentionDays": {
                      "type": "int",
                      "defaultValue": 31
                    }
                  },
                  "resources": [
                    {
                      "type": "Microsoft.OperationalInsights/workspaces/tables",
                      "apiVersion": "2022-10-01",
                      "name": "[format('{0}/{1}', parameters('parentname'), parameters('tableName'))]",
                      "properties": {
                        "totalRetentionInDays": "[parameters('retentionDays')]",
                        "plan": "Analytics",
                        "schema": {
                          "name": "[parameters('tableName')]",
                          "columns": [
                            {
                              "name": "TimeGenerated",
                              "type": "datetime"
                            },
                            {
                              "name": "RawData",
                              "type": "string"
                            }
                          ]
                        },
                        "retentionInDays": "[parameters('retentionDays')]"
                      }
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('WindowsDiscovery-{0}-{1}', parameters('instanceName'), parameters('location'))]",
              "location": "[deployment().location]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  },
                  "subscriptionId": {
                    "value": "[parameters('subscriptionId')]"
                  },
                  "resourceGroupName": {
                    "value": "[parameters('resourceGroupName')]"
                  },
                  "storageAccountname": {
                    "value": "[parameters('storageAccountname')]"
                  },
                  "imageGalleryName": {
                    "value": "[parameters('imageGalleryName')]"
                  },
                  "lawResourceId": {
                    "value": "[parameters('lawResourceId')]"
                  },
                  "tableNameToUse": {
                    "value": "[variables('tableNameToUse')]"
                  },
                  "userManagedIdentityResourceId": {
                    "value": "[parameters('userManagedIdentityResourceId')]"
                  },
                  "mgname": {
                    "value": "[parameters('mgname')]"
                  },
                  "dceId": {
                    "value": "[parameters('dceId')]"
                  },
                  "tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "instanceName": {
                    "value": "[parameters('instanceName')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "13331780847572411691"
                    }
                  },
                  "parameters": {
                    "location": {
                      "type": "string"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "subscriptionId": {
                      "type": "string"
                    },
                    "resourceGroupName": {
                      "type": "string"
                    },
                    "storageAccountname": {
                      "type": "string"
                    },
                    "imageGalleryName": {
                      "type": "string"
                    },
                    "lawResourceId": {
                      "type": "string"
                    },
                    "userManagedIdentityResourceId": {
                      "type": "string"
                    },
                    "mgname": {
                      "type": "string"
                    },
                    "dceId": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object"
                    },
                    "instanceName": {
                      "type": "string"
                    },
                    "tableNameToUse": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "ruleshortname": "[format('amp{0}windisc', parameters('instanceName'))]",
                    "appName": "[format('{0}-windiscovery', parameters('instanceName'))]",
                    "appDescription": "Windows Workload discovery",
                    "OS": "Windows",
                    "appVersionName": "1.0.0"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('amp-{0}-Discovery-{1}', parameters('instanceName'), variables('OS'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "aigname": {
                            "value": "[parameters('imageGalleryName')]"
                          },
                          "appDescription": {
                            "value": "[variables('appDescription')]"
                          },
                          "appName": {
                            "value": "[variables('appName')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "osType": {
                            "value": "[variables('OS')]"
                          },
                          "tags": {
                            "value": "[parameters('tags')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "17117017597267615596"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "aigname": {
                              "type": "string"
                            },
                            "osType": {
                              "type": "string"
                            },
                            "appDescription": {
                              "type": "string"
                            },
                            "appName": {
                              "type": "string"
                            },
                            "tags": {
                              "type": "object"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Compute/galleries/applications",
                              "apiVersion": "2022-03-03",
                              "name": "[format('{0}/{1}', parameters('aigname'), parameters('appName'))]",
                              "location": "[parameters('location')]",
                              "tags": "[parameters('tags')]",
                              "properties": {
                                "supportedOSType": "[parameters('osType')]",
                                "description": "[parameters('appDescription')]"
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('upload-discovery-{0}', variables('OS'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "containerName": {
                            "value": "discovery"
                          },
                          "filename": {
                            "value": "discover.zip"
                          },
                          "storageAccountName": {
                            "value": "[parameters('storageAccountname')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "tags": {
                            "value": "[parameters('tags')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "17364207548447032469"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "storageAccountName": {
                              "type": "string"
                            },
                            "sasExpiry": {
                              "type": "string",
                              "defaultValue": "[dateTimeAdd(utcNow(), 'PT2H')]"
                            },
                            "filename": {
                              "type": "string"
                            },
                            "containerName": {
                              "type": "string"
                            },
                            "tags": {
                              "type": "object"
                            }
                          },
                          "variables": {
                            "$fxv#0": "UEsDBBQAAAAIAGpQf1qAZr56zAIAAL4HAAAMAAAAZGlzY292ZXIucHMxxZPNTttAEMfvlvwOIycSWMpaVXupInGI0qRQNRARBBcktHgnycJ6190dU1zCk/XQR+orVOuPEL4EiENv9szOf75+8/f3nw5MueUZElpYospBoEutzEkaHQZdW+gjmeHOAokJTghsbGzGCSIThUFnu7XHCRlHVurFdlSWZckmEyYE7O72s6zvXBSHQRh0hXSpuUJbjo0SaHeitH96IrUwP93gV2Hx9Ev7wIuvkz+bZTIRYnfXi8s5bFfPJGEGDxMBG1lr7CD1XcFMKtSkyqHRJHWBcQw3EAYAAFGbE/pwcJk00VxZ5KIEvJaOXAQrMAWxuVQIbcHfzSKhawI2yHPUIgxuIQxQOYSbx8pDi5ykXsC81n9ULtcCXHFeu10SwatS+jTZpZBPCNbOTu2NHrpPlVm46IU3RokoDG6rPc6RU2HR7XxFYs0Cx7VtBSdLtMgOzi8wJbjpniV72hFXakYVP/gDthoLiq1bWMEMFabURuzzDHu+yVzxsv5ppI/K3HswpyV0VjA3Fnm6hJuN2Xa3u2eJD4p71eeGTGPZ0GrfeME4gtuaonVzSWoKTcAWBB/ido0dOCw0yQx7dTUHs15d8ZBXJ9ODY9TC2HtF16FrYVjB2NgRT5frKd210Ds0CnvQDLWucKP8Jk3cm8jUGmfm9LitCPxUDwpiY8/L41XKdvxNlEtSdxW1IAEb6dQIz2dB88/Vzp8jed9A1RU6mJtCi+SVx+Gve2McAyHYBLNzf6n7hnBqTY6Wqr3B1mGdbuu+75irAmFdC5ty546WtoAVjK5zY4ml7sqbafmeEQxmw709YA8KHhp9hZaODPvmjH7rtC+c0VEYdHmeNyeUyYYENlTcOb/+Tx/PptaIIqVnTqQFrUECGny96LvQbWj1Ok+QegfqIM+VTHkV+iKu1V+tH0evxXOQ5+5ksvceOrnv4s1oNr3/RyxfaL2i8h9QSwMEFAAAAAgAV3o/Wl3kd4qrAwAAQA4AABEAAABEaXNjb3ZlcnlUYXNrLnhtbJ2XXW/aWBCGn+uV9j8g7sFA0u0uYl3lo22Qst0oUOWGGxY7xArYyDYh9Me3q5njGNvHBJIr4Mz3O++ZOfz6OeATzyxZ0OAJn5iEgIiQv2nSpU2HJg18QmZEeASEzFX6nTFfaNHlD5p8wuV3fmPAmCkJj3s99tSjiRqS6PkDKSkr+jg4JMx4wGepntosCZgRE5EQcU9KW7NZ4rDRjDwiNiQ49OjQ4RSHDj0ctU1xSLOsmlmeDRoMuMVnTkBCSsyUNMt1SMg9UUHX6F+qjo+rcXqcaP1dWvprTJcOfbqc0ueEv2jzQSUdTjhlgFPwUPZ8xpqUByJiXNUsn5S1v3PLEJcJl5q9oGHQ3qrti3xXqfOGWqWHMQFz5lkHq/EvmLJQVnhMiSv6ZW1jMdIOxKScE7HOLbcHsBRZX3sqNbzmxY75mZAp/2mmHq7WvcZXT1VZXcaGhR5r1Tpnq92ri7Vjx5ZEEZUexzwpTi7dvPf1cju6c3R80T22H6K7v7cDblQmdz1gpT7t3ts6DQI8vcdFzhZvWpG5icYdKuoj7XmLD/r5Z8bdoobt4Vb7fo2vjBf0rrQewUq4faaoBizy/hr2V62qGNp1lXF7HRvhi69TzExIG7d/tI8iX2lWwgLJd6o+JfcbIhY666THQ+aEiqTPN3w2msVbvVTnl9x/yX2hE3N3n4bc8y8h5zoZDDsD9Ve+N+/zUM5CbCJWavGVKEPsmOhvs6xO2JecrzRjj7Fqy4YI86lcjHachV2bweNOGRnW8NHlPuPPrqrDNuU4hs9S+YKt4iEcSdkoYx6PiPoeD+Uc5IbK+evML/dc4r3YyQyuzuXX9OpmgbnzBr2ijV3tfs3qJDiuriKjRiXPl9nbxa7uOItylPdusYHORQ9PGVXFoyw7xK39qO7XLPu8Y8ojPmOizKrqq06jisQzPjPdMebtMiZgic+1fspLz+WGMR/pcZUhdIxN3YaTWyBSmaIfCxugeF7cD/vZIkyZ5fETGlzoN5kfz6QHN+eu8ro7IL6WBfZc0GfCXeldPGGkLw+JuOSEnqUhW2Oj022kM0h4OuEp+w8wYZXLk1ze1vxN96pZ2HmeETNnrdhL7YJQi29Eiqu862XW+DSy02si5kT5b/NSNRN+muEpu1zkdpeLW7ChbyfZ2Ymi3+JLHqtZi9cZP1jr5q17YdtnbVYkdGlmt9yu1MbjLpuzhi/iUeJJXXIu7Hp7ZuYeHfJbnXc2u0wVRc6+/LuT96P5J+XyP1BLAwQUAAAACABXej9aD6NjQTABAADbAQAACwAAAGluc3RhbGwucHMxbZC9bsIwHMT3SHmHU2Aog1N1ReoQUZj6gQqVOmSx7D/BimNHtgMJtE/WoY/UV6hIIVKrrqf7ne7u6+NzhJkjHghSeWF35DpsrJbk4mh8d5EWvXKbiGm+V0bavc8OjaN8MCRxpDa4uiooMBWowlj+ZsHmzlmXiaCswUppMkF3M2uCMg1NJjgijgAgGbvGrFVFmOKpTM8014647ECt8sEneINtAtsoTbh0uLdFGtoAltU1GRlH73FE2hOOP8FVKZXD3029bTRva24ky5zYqh0hzS/t04Oq40jYuhv+SWt/80/MMxXKB3JsJbYkG01yzX0J9lpp9LcIawKZgPR6YE+OtK30eY4PTpliAnbSH3lFSB6s8YE7LLko/TC1S8AW1gkCe/HksOr86fOeW/KwRZIn31BLAQIUABQAAAAIAGpQf1qAZr56zAIAAL4HAAAMAAAAAAAAAAAAAAAAAAAAAABkaXNjb3Zlci5wczFQSwECFAAUAAAACABXej9aXeR3iqsDAABADgAAEQAAAAAAAAAAAAAAAAD2AgAARGlzY292ZXJ5VGFzay54bWxQSwECFAAUAAAACABXej9aD6NjQTABAADbAQAACwAAAAAAAAAAAAAAAADQBgAAaW5zdGFsbC5wczFQSwUGAAAAAAMAAwCyAAAAKQgAAAAA",
                            "discoveryContainerName": "discovery",
                            "tempfilename": "download.tmp",
                            "sasConfig": {
                              "signedResourceTypes": "sco",
                              "signedPermission": "r",
                              "signedServices": "b",
                              "signedExpiry": "[parameters('sasExpiry')]",
                              "signedProtocol": "https",
                              "keyToSign": "key2"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deploymentScripts",
                              "apiVersion": "2020-10-01",
                              "name": "deployscript-windiscover",
                              "tags": "[parameters('tags')]",
                              "location": "[parameters('location')]",
                              "kind": "AzureCLI",
                              "properties": {
                                "azCliVersion": "2.42.0",
                                "timeout": "PT5M",
                                "retentionInterval": "PT1H",
                                "environmentVariables": [
                                  {
                                    "name": "AZURE_STORAGE_ACCOUNT",
                                    "value": "[parameters('storageAccountName')]"
                                  },
                                  {
                                    "name": "AZURE_STORAGE_KEY",
                                    "secureValue": "[listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').keys[0].value]"
                                  },
                                  {
                                    "name": "CONTENT",
                                    "value": "[variables('$fxv#0')]"
                                  }
                                ],
                                "scriptContent": "[format('echo \"$CONTENT\" > {0} && cat {1} | base64 -d > {2} && az storage blob upload -f {3} -c {4} -n {5} --overwrite true', variables('tempfilename'), variables('tempfilename'), parameters('filename'), parameters('filename'), variables('discoveryContainerName'), parameters('filename'))]"
                              }
                            }
                          ],
                          "outputs": {
                            "fileURL": {
                              "type": "string",
                              "value": "[format('{0}{1}/{2}?{3}', reference(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').primaryEndpoints.blob, parameters('containerName'), parameters('filename'), listAccountSAS(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01', variables('sasConfig')).accountSasToken)]"
                            }
                          }
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('amp-{0}-Discovery-{1}-App', parameters('instanceName'), variables('OS'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "aigname": {
                            "value": "[parameters('imageGalleryName')]"
                          },
                          "appName": {
                            "value": "[variables('appName')]"
                          },
                          "appVersionName": {
                            "value": "[variables('appVersionName')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "targetRegion": {
                            "value": "[parameters('location')]"
                          },
                          "mediaLink": {
                            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('upload-discovery-{0}', variables('OS'))), '2022-09-01').outputs.fileURL.value]"
                          },
                          "installCommands": {
                            "value": "powershell -command \"ren windiscovery discover.zip; expand-archive ./discover.zip . ; ./install.ps1\""
                          },
                          "removeCommands": {
                            "value": "powershell -command \"Unregister-ScheduledTask -TaskName 'Monstar Packs Discovery' '\\'\""
                          },
                          "tags": {
                            "value": "[parameters('tags')]"
                          },
                          "packageFileName": {
                            "value": "discover.zip"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "12441285522123093851"
                            }
                          },
                          "parameters": {
                            "aigname": {
                              "type": "string"
                            },
                            "appName": {
                              "type": "string"
                            },
                            "appVersionName": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string"
                            },
                            "targetRegion": {
                              "type": "string"
                            },
                            "mediaLink": {
                              "type": "string"
                            },
                            "packageFileName": {
                              "type": "string"
                            },
                            "installCommands": {
                              "type": "string"
                            },
                            "removeCommands": {
                              "type": "string"
                            },
                            "tags": {
                              "type": "object"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Compute/galleries/applications/versions",
                              "apiVersion": "2022-03-03",
                              "name": "[format('{0}/{1}/{2}', parameters('aigname'), parameters('appName'), parameters('appVersionName'))]",
                              "location": "[parameters('location')]",
                              "tags": "[parameters('tags')]",
                              "properties": {
                                "publishingProfile": {
                                  "source": {
                                    "mediaLink": "[parameters('mediaLink')]"
                                  },
                                  "manageActions": {
                                    "install": "[parameters('installCommands')]",
                                    "remove": "[parameters('removeCommands')]"
                                  },
                                  "settings": {
                                    "packageFileName": "[parameters('packageFileName')]"
                                  },
                                  "enableHealthCheck": false,
                                  "targetRegions": [
                                    {
                                      "name": "[parameters('targetRegion')]",
                                      "regionalReplicaCount": 1,
                                      "storageAccountType": "Standard_LRS"
                                    }
                                  ],
                                  "replicaCount": 1,
                                  "excludeFromLatest": false,
                                  "storageAccountType": "Standard_LRS"
                                }
                              }
                            }
                          ],
                          "outputs": {
                            "appVersionId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Compute/galleries/applications/versions', parameters('aigname'), parameters('appName'), parameters('appVersionName'))]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('upload-discovery-{0}', variables('OS')))]",
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('amp-{0}-Discovery-{1}', parameters('instanceName'), variables('OS')))]"
                      ]
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('amp-{0}-DCR-{1}Discovery', parameters('instanceName'), variables('OS'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "endpointResourceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "filepatterns": {
                            "value": [
                              "C:\\WindowsAzure\\Discovery\\*.csv"
                            ]
                          },
                          "kind": {
                            "value": "Windows"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "lawResourceId": {
                            "value": "[parameters('lawResourceId')]"
                          },
                          "OS": {
                            "value": "Windows"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "tableName": {
                            "value": "[parameters('tableNameToUse')]"
                          },
                          "packtag": {
                            "value": "WinDisc"
                          },
                          "packtype": {
                            "value": "Discovery"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "1128108251442731456"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "lawResourceId": {
                              "type": "string"
                            },
                            "tableName": {
                              "type": "string"
                            },
                            "packtag": {
                              "type": "string"
                            },
                            "kind": {
                              "type": "string"
                            },
                            "filepatterns": {
                              "type": "array"
                            },
                            "OS": {
                              "type": "string"
                            },
                            "packtype": {
                              "type": "string"
                            },
                            "endpointResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Specifies the resource id of the data collection endpoint."
                              }
                            },
                            "instanceName": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "streamName": "[format('Custom-{0}', parameters('tableName'))]",
                            "lawFriendlyName": "[split(parameters('lawResourceId'), '/')[8]]"
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Insights/dataCollectionRules",
                              "apiVersion": "2022-06-01",
                              "name": "[format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS'))]",
                              "location": "[parameters('location')]",
                              "tags": {
                                "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                                "MonitoringPackType": "[parameters('packtype')]"
                              },
                              "kind": "[parameters('kind')]",
                              "properties": {
                                "dataSources": {
                                  "logFiles": [
                                    {
                                      "streams": [
                                        "[variables('streamName')]"
                                      ],
                                      "filePatterns": "[parameters('filepatterns')]",
                                      "format": "text",
                                      "settings": {
                                        "text": {
                                          "recordStartTimestampFormat": "ISO 8601"
                                        }
                                      },
                                      "name": "[parameters('tableName')]"
                                    }
                                  ]
                                },
                                "destinations": {
                                  "logAnalytics": [
                                    {
                                      "workspaceResourceId": "[parameters('lawResourceId')]",
                                      "name": "[variables('lawFriendlyName')]"
                                    }
                                  ]
                                },
                                "dataFlows": [
                                  {
                                    "streams": [
                                      "[variables('streamName')]"
                                    ],
                                    "destinations": [
                                      "[variables('lawFriendlyName')]"
                                    ],
                                    "transformKql": "source",
                                    "outputStream": "[variables('streamName')]"
                                  }
                                ],
                                "dataCollectionEndpointId": "[parameters('endpointResourceId')]",
                                "streamDeclarations": {
                                  "[format('{0}', variables('streamName'))]": {
                                    "columns": [
                                      {
                                        "name": "TimeGenerated",
                                        "type": "datetime"
                                      },
                                      {
                                        "name": "RawData",
                                        "type": "string"
                                      }
                                    ]
                                  }
                                }
                              }
                            }
                          ],
                          "outputs": {
                            "ruleId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Insights/dataCollectionRules', format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS')))]"
                            },
                            "ruleName": {
                              "type": "string",
                              "value": "[format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS'))]"
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              },
              "dependsOn": [
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}-{2}', variables('tableNameToUse'), parameters('instanceName'), parameters('location')))]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('LinuxDiscovery-{0}-{1}', parameters('instanceName'), parameters('location'))]",
              "location": "[deployment().location]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  },
                  "solutionVersion": {
                    "value": "[parameters('solutionVersion')]"
                  },
                  "subscriptionId": {
                    "value": "[parameters('subscriptionId')]"
                  },
                  "resourceGroupName": {
                    "value": "[parameters('resourceGroupName')]"
                  },
                  "storageAccountname": {
                    "value": "[parameters('storageAccountname')]"
                  },
                  "imageGalleryName": {
                    "value": "[parameters('imageGalleryName')]"
                  },
                  "lawResourceId": {
                    "value": "[parameters('lawResourceId')]"
                  },
                  "tableNameToUse": {
                    "value": "[variables('tableNameToUse')]"
                  },
                  "userManagedIdentityResourceId": {
                    "value": "[parameters('userManagedIdentityResourceId')]"
                  },
                  "mgname": {
                    "value": "[parameters('mgname')]"
                  },
                  "dceId": {
                    "value": "[parameters('dceId')]"
                  },
                  "tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "instanceName": {
                    "value": "[parameters('instanceName')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "13440623184375052361"
                    }
                  },
                  "parameters": {
                    "location": {
                      "type": "string"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "solutionVersion": {
                      "type": "string"
                    },
                    "subscriptionId": {
                      "type": "string"
                    },
                    "resourceGroupName": {
                      "type": "string"
                    },
                    "storageAccountname": {
                      "type": "string"
                    },
                    "imageGalleryName": {
                      "type": "string"
                    },
                    "lawResourceId": {
                      "type": "string"
                    },
                    "tableNameToUse": {
                      "type": "string"
                    },
                    "userManagedIdentityResourceId": {
                      "type": "string"
                    },
                    "mgname": {
                      "type": "string"
                    },
                    "dceId": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object"
                    },
                    "instanceName": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "ruleshortname": "[format('amp{0}lxdisc', parameters('instanceName'))]",
                    "appName": "[format('{0}-LxDiscovery', parameters('instanceName'))]",
                    "appDescription": "Linux Workload discovery",
                    "OS": "Linux",
                    "appVersionName": "1.0.0"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('amp-{0}-Discovery-{1}-{2}', parameters('instanceName'), variables('OS'), parameters('location'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "aigname": {
                            "value": "[parameters('imageGalleryName')]"
                          },
                          "appDescription": {
                            "value": "[variables('appDescription')]"
                          },
                          "appName": {
                            "value": "[variables('appName')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "osType": {
                            "value": "[variables('OS')]"
                          },
                          "tags": {
                            "value": "[parameters('tags')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "17117017597267615596"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "aigname": {
                              "type": "string"
                            },
                            "osType": {
                              "type": "string"
                            },
                            "appDescription": {
                              "type": "string"
                            },
                            "appName": {
                              "type": "string"
                            },
                            "tags": {
                              "type": "object"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Compute/galleries/applications",
                              "apiVersion": "2022-03-03",
                              "name": "[format('{0}/{1}', parameters('aigname'), parameters('appName'))]",
                              "location": "[parameters('location')]",
                              "tags": "[parameters('tags')]",
                              "properties": {
                                "supportedOSType": "[parameters('osType')]",
                                "description": "[parameters('appDescription')]"
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('upload-discovery-{0}-{1}-{2}', variables('OS'), parameters('instanceName'), parameters('location'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "containerName": {
                            "value": "discovery"
                          },
                          "filename": {
                            "value": "discover.tar"
                          },
                          "storageAccountName": {
                            "value": "[parameters('storageAccountname')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "tags": {
                            "value": "[parameters('tags')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "15925273555610006101"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "storageAccountName": {
                              "type": "string"
                            },
                            "sasExpiry": {
                              "type": "string",
                              "defaultValue": "[dateTimeAdd(utcNow(), 'PT2H')]"
                            },
                            "filename": {
                              "type": "string"
                            },
                            "containerName": {
                              "type": "string"
                            },
                            "tags": {
                              "type": "object"
                            }
                          },
                          "variables": {
                            "$fxv#0": "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dGFiIC0NCmNobW9kIDc3NyAvb3B0L21pY3Jvc29mdC9kaXNjb3ZlcnkvZGlzY292ZXJ5LnNoDQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==",
                            "discoveryContainerName": "discovery",
                            "tempfilename": "download.tmp",
                            "sasConfig": {
                              "signedResourceTypes": "sco",
                              "signedPermission": "r",
                              "signedServices": "b",
                              "signedExpiry": "[parameters('sasExpiry')]",
                              "signedProtocol": "https",
                              "keyToSign": "key2"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deploymentScripts",
                              "apiVersion": "2020-10-01",
                              "name": "deployscript-MonstarPacks",
                              "tags": "[parameters('tags')]",
                              "location": "[parameters('location')]",
                              "kind": "AzureCLI",
                              "properties": {
                                "azCliVersion": "2.42.0",
                                "timeout": "PT5M",
                                "retentionInterval": "PT1H",
                                "environmentVariables": [
                                  {
                                    "name": "AZURE_STORAGE_ACCOUNT",
                                    "value": "[parameters('storageAccountName')]"
                                  },
                                  {
                                    "name": "AZURE_STORAGE_KEY",
                                    "secureValue": "[listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').keys[0].value]"
                                  },
                                  {
                                    "name": "CONTENT",
                                    "value": "[variables('$fxv#0')]"
                                  }
                                ],
                                "scriptContent": "[format('echo \"$CONTENT\" > {0} && cat {1} | base64 -d > {2} && az storage blob upload -f {3} -c {4} -n {5} --overwrite true', variables('tempfilename'), variables('tempfilename'), parameters('filename'), parameters('filename'), variables('discoveryContainerName'), parameters('filename'))]"
                              }
                            }
                          ],
                          "outputs": {
                            "fileURL": {
                              "type": "string",
                              "value": "[format('{0}{1}/{2}?{3}', reference(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').primaryEndpoints.blob, parameters('containerName'), parameters('filename'), listAccountSAS(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01', variables('sasConfig')).accountSasToken)]"
                            }
                          }
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('amp-{0}-Discovery-{1}-App-{2}', parameters('instanceName'), variables('OS'), parameters('location'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "aigname": {
                            "value": "[parameters('imageGalleryName')]"
                          },
                          "appName": {
                            "value": "[variables('appName')]"
                          },
                          "appVersionName": {
                            "value": "[variables('appVersionName')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "targetRegion": {
                            "value": "[parameters('location')]"
                          },
                          "mediaLink": {
                            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('upload-discovery-{0}-{1}-{2}', variables('OS'), parameters('instanceName'), parameters('location'))), '2022-09-01').outputs.fileURL.value]"
                          },
                          "installCommands": {
                            "value": "[format('tar -xvf {0} && chmod +x ./install.sh && ./install.sh', variables('appName'))]"
                          },
                          "removeCommands": {
                            "value": "/opt/microsoft/discovery/uninstall.sh"
                          },
                          "tags": {
                            "value": "[parameters('tags')]"
                          },
                          "packageFileName": {
                            "value": "discover.tar"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "12441285522123093851"
                            }
                          },
                          "parameters": {
                            "aigname": {
                              "type": "string"
                            },
                            "appName": {
                              "type": "string"
                            },
                            "appVersionName": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string"
                            },
                            "targetRegion": {
                              "type": "string"
                            },
                            "mediaLink": {
                              "type": "string"
                            },
                            "packageFileName": {
                              "type": "string"
                            },
                            "installCommands": {
                              "type": "string"
                            },
                            "removeCommands": {
                              "type": "string"
                            },
                            "tags": {
                              "type": "object"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Compute/galleries/applications/versions",
                              "apiVersion": "2022-03-03",
                              "name": "[format('{0}/{1}/{2}', parameters('aigname'), parameters('appName'), parameters('appVersionName'))]",
                              "location": "[parameters('location')]",
                              "tags": "[parameters('tags')]",
                              "properties": {
                                "publishingProfile": {
                                  "source": {
                                    "mediaLink": "[parameters('mediaLink')]"
                                  },
                                  "manageActions": {
                                    "install": "[parameters('installCommands')]",
                                    "remove": "[parameters('removeCommands')]"
                                  },
                                  "settings": {
                                    "packageFileName": "[parameters('packageFileName')]"
                                  },
                                  "enableHealthCheck": false,
                                  "targetRegions": [
                                    {
                                      "name": "[parameters('targetRegion')]",
                                      "regionalReplicaCount": 1,
                                      "storageAccountType": "Standard_LRS"
                                    }
                                  ],
                                  "replicaCount": 1,
                                  "excludeFromLatest": false,
                                  "storageAccountType": "Standard_LRS"
                                }
                              }
                            }
                          ],
                          "outputs": {
                            "appVersionId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Compute/galleries/applications/versions', parameters('aigname'), parameters('appName'), parameters('appVersionName'))]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('amp-{0}-Discovery-{1}-{2}', parameters('instanceName'), variables('OS'), parameters('location')))]",
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('upload-discovery-{0}-{1}-{2}', variables('OS'), parameters('instanceName'), parameters('location')))]"
                      ]
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "LinuxDiscoveryDCR",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "endpointResourceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "filepatterns": {
                            "value": [
                              "/opt/microsoft/discovery/*.csv"
                            ]
                          },
                          "kind": {
                            "value": "Linux"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "lawResourceId": {
                            "value": "[parameters('lawResourceId')]"
                          },
                          "OS": {
                            "value": "Linux"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "tableName": {
                            "value": "[parameters('tableNameToUse')]"
                          },
                          "packtag": {
                            "value": "LxDisc"
                          },
                          "packtype": {
                            "value": "Discovery"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "1128108251442731456"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "lawResourceId": {
                              "type": "string"
                            },
                            "tableName": {
                              "type": "string"
                            },
                            "packtag": {
                              "type": "string"
                            },
                            "kind": {
                              "type": "string"
                            },
                            "filepatterns": {
                              "type": "array"
                            },
                            "OS": {
                              "type": "string"
                            },
                            "packtype": {
                              "type": "string"
                            },
                            "endpointResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Specifies the resource id of the data collection endpoint."
                              }
                            },
                            "instanceName": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "streamName": "[format('Custom-{0}', parameters('tableName'))]",
                            "lawFriendlyName": "[split(parameters('lawResourceId'), '/')[8]]"
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Insights/dataCollectionRules",
                              "apiVersion": "2022-06-01",
                              "name": "[format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS'))]",
                              "location": "[parameters('location')]",
                              "tags": {
                                "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                                "MonitoringPackType": "[parameters('packtype')]"
                              },
                              "kind": "[parameters('kind')]",
                              "properties": {
                                "dataSources": {
                                  "logFiles": [
                                    {
                                      "streams": [
                                        "[variables('streamName')]"
                                      ],
                                      "filePatterns": "[parameters('filepatterns')]",
                                      "format": "text",
                                      "settings": {
                                        "text": {
                                          "recordStartTimestampFormat": "ISO 8601"
                                        }
                                      },
                                      "name": "[parameters('tableName')]"
                                    }
                                  ]
                                },
                                "destinations": {
                                  "logAnalytics": [
                                    {
                                      "workspaceResourceId": "[parameters('lawResourceId')]",
                                      "name": "[variables('lawFriendlyName')]"
                                    }
                                  ]
                                },
                                "dataFlows": [
                                  {
                                    "streams": [
                                      "[variables('streamName')]"
                                    ],
                                    "destinations": [
                                      "[variables('lawFriendlyName')]"
                                    ],
                                    "transformKql": "source",
                                    "outputStream": "[variables('streamName')]"
                                  }
                                ],
                                "dataCollectionEndpointId": "[parameters('endpointResourceId')]",
                                "streamDeclarations": {
                                  "[format('{0}', variables('streamName'))]": {
                                    "columns": [
                                      {
                                        "name": "TimeGenerated",
                                        "type": "datetime"
                                      },
                                      {
                                        "name": "RawData",
                                        "type": "string"
                                      }
                                    ]
                                  }
                                }
                              }
                            }
                          ],
                          "outputs": {
                            "ruleId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Insights/dataCollectionRules', format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS')))]"
                            },
                            "ruleName": {
                              "type": "string",
                              "value": "[format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS'))]"
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              },
              "dependsOn": [
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}-{2}', variables('tableNameToUse'), parameters('instanceName'), parameters('location')))]"
              ]
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('MonitoringPacks-backend-{0}', parameters('instanceName')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', 'logAnalytics-Deployment')]"
      ]
    },
    {
      "condition": "[and(parameters('newGrafana'), parameters('deployGrafana'))]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('azureManagedGrafana-{0}', parameters('instanceName'))]",
      "subscriptionId": "[parameters('subscriptionId')]",
      "resourceGroup": "[parameters('resourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "Tags": {
            "value": "[variables('Tags')]"
          },
          "location": {
            "value": "[parameters('grafanaLocation')]"
          },
          "grafanaName": {
            "value": "[parameters('grafanaName')]"
          },
          "solutionTag": {
            "value": "[variables('solutionTag')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "14855733454842223127"
            }
          },
          "parameters": {
            "grafanaName": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "Tags": {
              "type": "object"
            },
            "solutionTag": {
              "type": "string"
            }
          },
          "variables": {
            "ReaderRoleId": "acdd72a7-3385-48ef-bd42-f606fba81ae7",
            "LogAnalyticsContribuorRoleId": "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "MonitoringContributorRoleId": "749f88d5-cbae-40b8-bcfc-e573ddc772fa"
          },
          "resources": [
            {
              "type": "Microsoft.Dashboard/grafana",
              "apiVersion": "2022-08-01",
              "name": "[parameters('grafanaName')]",
              "tags": "[parameters('Tags')]",
              "sku": {
                "name": "Standard"
              },
              "identity": {
                "type": "SystemAssigned"
              },
              "location": "[parameters('location')]"
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('AMGRReadP-{0}-{1}', parameters('grafanaName'), parameters('location'))]",
              "subscriptionId": "[subscription().subscriptionId]",
              "location": "[resourceGroup().location]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "principalId": {
                    "value": "[reference(resourceId('Microsoft.Dashboard/grafana', parameters('grafanaName')), '2022-08-01', 'full').identity.principalId]"
                  },
                  "resourcename": {
                    "value": "[parameters('grafanaName')]"
                  },
                  "roleDefinitionId": {
                    "value": "[variables('ReaderRoleId')]"
                  },
                  "roleShortName": {
                    "value": "Reader"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "5009626312759808178"
                    }
                  },
                  "parameters": {
                    "resourcename": {
                      "type": "string"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "principalId": {
                      "type": "string"
                    },
                    "roleDefinitionId": {
                      "type": "string"
                    },
                    "roleShortName": {
                      "type": "string"
                    },
                    "utcValue": {
                      "type": "string",
                      "defaultValue": "[utcNow()]"
                    }
                  },
                  "variables": {
                    "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Authorization/roleAssignments",
                      "apiVersion": "2022-04-01",
                      "name": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]",
                      "properties": {
                        "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                        "principalId": "[parameters('principalId')]",
                        "principalType": "ServicePrincipal",
                        "roleDefinitionId": "[variables('roleIdtoUse')]"
                      }
                    }
                  ],
                  "outputs": {
                    "roleassignmentname": {
                      "type": "string",
                      "value": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Dashboard/grafana', parameters('grafanaName'))]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('AMGLAWP-{0}-{1}', parameters('grafanaName'), parameters('location'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "principalId": {
                    "value": "[reference(resourceId('Microsoft.Dashboard/grafana', parameters('grafanaName')), '2022-08-01', 'full').identity.principalId]"
                  },
                  "resourcename": {
                    "value": "[parameters('grafanaName')]"
                  },
                  "roleDefinitionId": {
                    "value": "[variables('LogAnalyticsContribuorRoleId')]"
                  },
                  "roleShortName": {
                    "value": "Log Analytics Contributor"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "18441567381332934980"
                    }
                  },
                  "parameters": {
                    "resourcename": {
                      "type": "string"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "principalId": {
                      "type": "string"
                    },
                    "roleDefinitionId": {
                      "type": "string"
                    },
                    "roleShortName": {
                      "type": "string"
                    },
                    "utcValue": {
                      "type": "string",
                      "defaultValue": "[utcNow()]"
                    }
                  },
                  "variables": {
                    "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Authorization/roleAssignments",
                      "apiVersion": "2022-04-01",
                      "name": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]",
                      "properties": {
                        "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                        "principalId": "[parameters('principalId')]",
                        "principalType": "ServicePrincipal",
                        "roleDefinitionId": "[variables('roleIdtoUse')]"
                      }
                    }
                  ],
                  "outputs": {
                    "roleassignmentname": {
                      "type": "string",
                      "value": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Dashboard/grafana', parameters('grafanaName'))]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('AMGMonitorP-{0}-{1}', parameters('grafanaName'), parameters('location'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "principalId": {
                    "value": "[reference(resourceId('Microsoft.Dashboard/grafana', parameters('grafanaName')), '2022-08-01', 'full').identity.principalId]"
                  },
                  "resourcename": {
                    "value": "[parameters('grafanaName')]"
                  },
                  "roleDefinitionId": {
                    "value": "[variables('MonitoringContributorRoleId')]"
                  },
                  "roleShortName": {
                    "value": "Monitor Contributor Role"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "18441567381332934980"
                    }
                  },
                  "parameters": {
                    "resourcename": {
                      "type": "string"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "principalId": {
                      "type": "string"
                    },
                    "roleDefinitionId": {
                      "type": "string"
                    },
                    "roleShortName": {
                      "type": "string"
                    },
                    "utcValue": {
                      "type": "string",
                      "defaultValue": "[utcNow()]"
                    }
                  },
                  "variables": {
                    "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Authorization/roleAssignments",
                      "apiVersion": "2022-04-01",
                      "name": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]",
                      "properties": {
                        "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                        "principalId": "[parameters('principalId')]",
                        "principalType": "ServicePrincipal",
                        "roleDefinitionId": "[variables('roleIdtoUse')]"
                      }
                    }
                  ],
                  "outputs": {
                    "roleassignmentname": {
                      "type": "string",
                      "value": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[resourceId('Microsoft.Dashboard/grafana', parameters('grafanaName'))]"
              ]
            }
          ],
          "outputs": {
            "grafanaId": {
              "type": "string",
              "value": "[resourceId('Microsoft.Dashboard/grafana', parameters('grafanaName'))]"
            }
          }
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', 'logAnalytics-Deployment')]",
        "[subscriptionResourceId(parameters('subscriptionId'), 'Microsoft.Resources/deployments', format('RGMonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName')))]"
      ]
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('MonitoringPacks-backend-{0}', parameters('instanceName'))]",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "appInsightsLocation": {
            "value": "[parameters('appInsightsLocation')]"
          },
          "functionname": {
            "value": "[variables('functionName')]"
          },
          "lawresourceid": "[if(parameters('createNewLogAnalyticsWS'), createObject('value', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', 'logAnalytics-Deployment'), '2022-09-01').outputs.lawresourceid.value), createObject('value', parameters('existingLogAnalyticsWSId')))]",
          "location": {
            "value": "[parameters('location')]"
          },
          "mgname": {
            "value": "[parameters('mgname')]"
          },
          "resourceGroupName": {
            "value": "[parameters('resourceGroupName')]"
          },
          "Tags": {
            "value": "[variables('Tags')]"
          },
          "storageAccountName": {
            "value": "[parameters('storageAccountName')]"
          },
          "subscriptionId": {
            "value": "[parameters('subscriptionId')]"
          },
          "solutionTag": {
            "value": "[variables('solutionTag')]"
          },
          "imageGalleryName": {
            "value": "[variables('ImageGalleryName')]"
          },
          "logicappname": {
            "value": "[variables('logicAppName')]"
          },
          "instanceName": {
            "value": "[parameters('instanceName')]"
          },
          "collectTelemetry": {
            "value": "[parameters('collectTelemetry')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "10704995410416150773"
            }
          },
          "parameters": {
            "functionname": {
              "type": "string",
              "metadata": {
                "description": "The name for the function app that you wish to create"
              }
            },
            "logicappname": {
              "type": "string"
            },
            "instanceName": {
              "type": "string"
            },
            "location": {
              "type": "string"
            },
            "storageAccountName": {
              "type": "string"
            },
            "solutionTag": {
              "type": "string"
            },
            "lawresourceid": {
              "type": "string"
            },
            "appInsightsLocation": {
              "type": "string"
            },
            "Tags": {
              "type": "object",
              "metadata": {
                "description": "UTC timestamp used to create distinct deployment scripts for each deployment"
              }
            },
            "subscriptionId": {
              "type": "string"
            },
            "resourceGroupName": {
              "type": "string"
            },
            "mgname": {
              "type": "string"
            },
            "imageGalleryName": {
              "type": "string"
            },
            "collectTelemetry": {
              "type": "bool"
            }
          },
          "variables": {
            "$fxv#0": "{\r\n  \"customerUsageAttribution\": {\r\n    \"SolutionIdentifier\": \"pid-be73d263-1f29-42ad-adf2-253234454db6\"\r\n  }\r\n}",
            "packPolicyRoleDefinitionIds": [
              "b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "backendFunctionRoleDefinitionIds": [
              "4a9ae827-6dc8-4573-8ac7-8239d42aa03f",
              "9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
              "48b40c6e-82e0-4eb3-90d5-19e40f49b624",
              "acdd72a7-3385-48ef-bd42-f606fba81ae7",
              "92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "36243c78-bf99-498c-9df9-86d9f8d28608",
              "f1a07417-d97a-45cb-824c-7a7467783830"
            ],
            "logicappRequiredRoleassignments": [
              "4633458b-17de-408a-b874-0445c86b69e6"
            ],
            "telemetryInfo": "[json(variables('$fxv#0'))]"
          },
          "resources": [
            {
              "condition": "[parameters('collectTelemetry')]",
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[variables('telemetryInfo').customerUsageAttribution.SolutionIdentifier]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {},
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "16208364426447542075"
                    }
                  },
                  "resources": []
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[parameters('imageGalleryName')]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "galleryname": {
                    "value": "[parameters('imageGalleryName')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "tags": {
                    "value": "[parameters('Tags')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "2475307255965847113"
                    }
                  },
                  "parameters": {
                    "location": {
                      "type": "string"
                    },
                    "galleryname": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "object"
                    }
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Compute/galleries",
                      "apiVersion": "2022-03-03",
                      "name": "[parameters('galleryname')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('tags')]",
                      "properties": {
                        "description": "Monitoring gallery"
                      }
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[parameters('functionname')]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "appInsightsLocation": {
                    "value": "[parameters('appInsightsLocation')]"
                  },
                  "functionname": {
                    "value": "[parameters('functionname')]"
                  },
                  "lawresourceid": {
                    "value": "[parameters('lawresourceid')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "Tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "storageAccountName": {
                    "value": "[parameters('storageAccountName')]"
                  },
                  "userManagedIdentity": {
                    "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('AMP-{0}-UMI-AzFun-{1}', parameters('instanceName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityResourceId.value]"
                  },
                  "userManagedIdentityClientId": {
                    "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('AMP-{0}-UMI-AzFun-{1}', parameters('instanceName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityClientId.value]"
                  },
                  "packsUserManagedId": {
                    "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('AMP-{0}-UMI-Packs-{1}', parameters('instanceName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityResourceId.value]"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  },
                  "instanceName": {
                    "value": "[parameters('instanceName')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "8189292297702201004"
                    }
                  },
                  "parameters": {
                    "functionname": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "Tags": {
                      "type": "object"
                    },
                    "userManagedIdentity": {
                      "type": "string"
                    },
                    "userManagedIdentityClientId": {
                      "type": "string"
                    },
                    "packsUserManagedId": {
                      "type": "string"
                    },
                    "storageAccountName": {
                      "type": "string"
                    },
                    "filename": {
                      "type": "string",
                      "defaultValue": "discovery.zip"
                    },
                    "sasExpiry": {
                      "type": "string",
                      "defaultValue": "[dateTimeAdd(utcNow(), 'PT2H')]"
                    },
                    "lawresourceid": {
                      "type": "string"
                    },
                    "appInsightsLocation": {
                      "type": "string"
                    },
                    "apiManagementKey": {
                      "type": "string",
                      "defaultValue": "[base64(newGuid())]"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "instanceName": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "$fxv#0": "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",
                    "discoveryContainerName": "discovery",
                    "tempfilename": "[format('{0}.tmp', parameters('filename'))]",
                    "ambaJsonURL": "https://azure.github.io/azure-monitor-baseline-alerts/amba-alerts.json",
                    "sasConfig": {
                      "signedResourceTypes": "sco",
                      "signedPermission": "r",
                      "signedServices": "b",
                      "signedExpiry": "[parameters('sasExpiry')]",
                      "signedProtocol": "https",
                      "keyToSign": "key2"
                    },
                    "keyName": "monitoringKey"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Resources/deploymentScripts",
                      "apiVersion": "2020-10-01",
                      "name": "[format('deployscript-Function-{0}', parameters('instanceName'))]",
                      "tags": "[parameters('Tags')]",
                      "location": "[parameters('location')]",
                      "kind": "AzureCLI",
                      "properties": {
                        "azCliVersion": "2.42.0",
                        "timeout": "PT5M",
                        "retentionInterval": "PT1H",
                        "environmentVariables": [
                          {
                            "name": "AZURE_STORAGE_ACCOUNT",
                            "value": "[parameters('storageAccountName')]"
                          },
                          {
                            "name": "AZURE_STORAGE_KEY",
                            "secureValue": "[listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').keys[0].value]"
                          },
                          {
                            "name": "CONTENT",
                            "value": "[variables('$fxv#0')]"
                          }
                        ],
                        "scriptContent": "[format('echo \"$CONTENT\" > {0} && cat {1} | base64 -d > {2} && az storage blob upload -f {3} -c {4} -n {5} --overwrite true', variables('tempfilename'), variables('tempfilename'), parameters('filename'), parameters('filename'), variables('discoveryContainerName'), parameters('filename'))]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Web/sites/config', parameters('functionname'), 'appsettings')]"
                      ]
                    },
                    {
                      "type": "Microsoft.Web/serverfarms",
                      "apiVersion": "2021-03-01",
                      "name": "[format('{0}-farm', parameters('functionname'))]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('Tags')]",
                      "sku": {
                        "name": "Y1",
                        "tier": "Dynamic",
                        "size": "Y1",
                        "family": "Y",
                        "capacity": 0
                      },
                      "kind": "functioapp",
                      "properties": {
                        "perSiteScaling": false,
                        "elasticScaleEnabled": false,
                        "maximumElasticWorkerCount": 1,
                        "isSpot": false,
                        "reserved": false,
                        "isXenon": false,
                        "hyperV": false,
                        "targetWorkerCount": 0,
                        "targetWorkerSizeId": 0,
                        "zoneRedundant": false
                      }
                    },
                    {
                      "type": "Microsoft.Web/sites",
                      "apiVersion": "2023-01-01",
                      "name": "[parameters('functionname')]",
                      "location": "[parameters('location')]",
                      "kind": "functionapp",
                      "tags": "[parameters('Tags')]",
                      "identity": {
                        "type": "UserAssigned",
                        "userAssignedIdentities": {
                          "[format('{0}', parameters('userManagedIdentity'))]": {}
                        }
                      },
                      "properties": {
                        "enabled": true,
                        "hostNameSslStates": [
                          {
                            "name": "[format('{0}.azurewebsites.net', parameters('functionname'))]",
                            "sslState": "Disabled",
                            "hostType": "Standard"
                          },
                          {
                            "name": "[format('{0}.azurewebsites.net', parameters('functionname'))]",
                            "sslState": "Disabled",
                            "hostType": "Repository"
                          }
                        ],
                        "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', format('{0}-farm', parameters('functionname')))]",
                        "reserved": false,
                        "isXenon": false,
                        "hyperV": false,
                        "siteConfig": {
                          "numberOfWorkers": 1,
                          "acrUseManagedIdentityCreds": false,
                          "alwaysOn": false,
                          "ipSecurityRestrictions": [
                            {
                              "ipAddress": "Any",
                              "action": "Allow",
                              "priority": 1,
                              "name": "Allow all",
                              "description": "Allow all access"
                            }
                          ],
                          "scmIpSecurityRestrictions": [
                            {
                              "ipAddress": "Any",
                              "action": "Allow",
                              "priority": 1,
                              "name": "Allow all",
                              "description": "Allow all access"
                            }
                          ],
                          "http20Enabled": false,
                          "functionAppScaleLimit": 200,
                          "minimumElasticInstanceCount": 0,
                          "minTlsVersion": "1.2",
                          "cors": {
                            "allowedOrigins": [
                              "https://portal.azure.com"
                            ],
                            "supportCredentials": true
                          }
                        },
                        "scmSiteAlsoStopped": false,
                        "clientAffinityEnabled": false,
                        "clientCertEnabled": false,
                        "clientCertMode": "Required",
                        "hostNamesDisabled": false,
                        "containerSize": 1536,
                        "dailyMemoryTimeQuota": 0,
                        "httpsOnly": true,
                        "redundancyMode": "None",
                        "storageAccountRequired": false,
                        "keyVaultReferenceIdentity": "SystemAssigned"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Web/serverfarms', format('{0}-farm', parameters('functionname')))]"
                      ]
                    },
                    {
                      "type": "Microsoft.Web/sites/config",
                      "apiVersion": "2021-03-01",
                      "name": "[format('{0}/{1}', parameters('functionname'), 'appsettings')]",
                      "properties": {
                        "WEBSITE_CONTENTAZUREFILECONNECTIONSTRING": "[format('DefaultEndpointsProtocol=https;AccountName={0};AccountKey={1};EndpointSuffix={2}', parameters('storageAccountName'), listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').keys[0].value, environment().suffixes.storage)]",
                        "AzureWebJobsStorage": "[format('DefaultEndpointsProtocol=https;AccountName={0};AccountKey={1};EndpointSuffix={2}', parameters('storageAccountName'), listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').keys[0].value, environment().suffixes.storage)]",
                        "WEBSITE_CONTENTSHARE": "[parameters('storageAccountName')]",
                        "FUNCTIONS_WORKER_RUNTIME": "powershell",
                        "FUNCTIONS_EXTENSION_VERSION": "~4",
                        "ResourceGroup": "[resourceGroup().name]",
                        "SolutionTag": "[parameters('solutionTag')]",
                        "APPINSIGHTS_INSTRUMENTATIONKEY": "[reference(resourceId('Microsoft.Insights/components', parameters('functionname')), '2020-02-02-preview').InstrumentationKey]",
                        "APPLICATIONINSIGHTS_CONNECTION_STRING": "[format('InstrumentationKey={0}', reference(resourceId('Microsoft.Insights/components', parameters('functionname')), '2020-02-02-preview').InstrumentationKey)]",
                        "ApplicationInsightsAgent_EXTENSION_VERSION": "~2",
                        "MSI_CLIENT_ID": "[parameters('userManagedIdentityClientId')]",
                        "PacksUserManagedId": "[parameters('packsUserManagedId')]",
                        "InstanceName": "[parameters('instanceName')]",
                        "AMBAJsonURL": "[variables('ambaJsonURL')]",
                        "servicesBaseURL": "https://raw.githubusercontent.com/Azure/azure-monitor-baseline-alerts/main/services"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Insights/components', parameters('functionname'))]",
                        "[resourceId('Microsoft.Web/sites', parameters('functionname'))]"
                      ]
                    },
                    {
                      "type": "Microsoft.Web/sites/extensions",
                      "apiVersion": "2021-02-01",
                      "name": "[format('{0}/{1}', parameters('functionname'), 'MSDeploy')]",
                      "properties": {
                        "packageUri": "[format('{0}{1}/{2}?{3}', reference(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').primaryEndpoints.blob, variables('discoveryContainerName'), parameters('filename'), listAccountSAS(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01', variables('sasConfig')).accountSasToken)]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Web/sites', parameters('functionname'))]",
                        "[resourceId('Microsoft.Resources/deploymentScripts', format('deployscript-Function-{0}', parameters('instanceName')))]"
                      ]
                    },
                    {
                      "type": "Microsoft.Insights/components",
                      "apiVersion": "2020-02-02",
                      "name": "[parameters('functionname')]",
                      "tags": "[parameters('Tags')]",
                      "location": "[parameters('appInsightsLocation')]",
                      "kind": "web",
                      "properties": {
                        "Application_Type": "web",
                        "publicNetworkAccessForIngestion": "Enabled",
                        "publicNetworkAccessForQuery": "Enabled",
                        "WorkspaceResourceId": "[parameters('lawresourceid')]"
                      }
                    },
                    {
                      "type": "Microsoft.Web/sites/host/functionKeys",
                      "apiVersion": "2022-03-01",
                      "name": "[format('{0}/default/{1}', parameters('functionname'), variables('keyName'))]",
                      "tags": "[parameters('Tags')]",
                      "properties": {
                        "name": "[variables('keyName')]",
                        "value": "[parameters('apiManagementKey')]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Web/sites/config', parameters('functionname'), 'appsettings')]"
                      ]
                    }
                  ]
                }
              },
              "dependsOn": [
                "[extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('AMP-{0}-UMI-AzFun-{1}', parameters('instanceName'), parameters('location')))]",
                "[extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('AMP-{0}-UMI-Packs-{1}', parameters('instanceName'), parameters('location')))]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[parameters('logicappname')]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "functioname": {
                    "value": "[parameters('functionname')]"
                  },
                  "logicAppName": {
                    "value": "[parameters('logicappname')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "Tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "keyvaultid": {
                    "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('amp-{0}-kv-{1}', parameters('instanceName'), substring(uniqueString(parameters('subscriptionId'), parameters('resourceGroupName'), 'keyvault'), 0, 6))), '2022-09-01').outputs.kvResourceId.value]"
                  },
                  "subscriptionId": {
                    "value": "[parameters('subscriptionId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "10657779016395385871"
                    }
                  },
                  "parameters": {
                    "functioname": {
                      "type": "string"
                    },
                    "Tags": {
                      "type": "object"
                    },
                    "location": {
                      "type": "string"
                    },
                    "keyvaultid": {
                      "type": "string"
                    },
                    "subscriptionId": {
                      "type": "string"
                    },
                    "logicAppName": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "keyVaultName": "[split(parameters('keyvaultid'), '/')[8]]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Logic/workflows",
                      "apiVersion": "2019-05-01",
                      "name": "[parameters('logicAppName')]",
                      "tags": "[parameters('Tags')]",
                      "location": "[parameters('location')]",
                      "identity": {
                        "type": "SystemAssigned"
                      },
                      "properties": {
                        "state": "Enabled",
                        "definition": {
                          "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                          "contentVersion": "1.0.0.0",
                          "parameters": {
                            "$connections": {
                              "defaultValue": {},
                              "type": "Object"
                            }
                          },
                          "triggers": {
                            "manual": {
                              "type": "Request",
                              "kind": "Http",
                              "inputs": {}
                            }
                          },
                          "actions": {
                            "Get_Secret": {
                              "runAfter": {
                                "Parse_JSON": [
                                  "Succeeded"
                                ]
                              },
                              "type": "ApiConnection",
                              "inputs": {
                                "host": {
                                  "connection": {
                                    "name": "@parameters('$connections')['keyvault']['connectionId']"
                                  }
                                },
                                "method": "get",
                                "path": "/secrets/@{encodeURIComponent('FunctionKey')}/value"
                              }
                            },
                            "Parse_JSON": {
                              "runAfter": {},
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@triggerBody()",
                                "schema": {
                                  "properties": {
                                    "function": {
                                      "type": "string"
                                    },
                                    "functionBody": {
                                      "properties": {},
                                      "type": "object"
                                    }
                                  },
                                  "type": "object"
                                }
                              }
                            },
                            "Switch": {
                              "runAfter": {
                                "Get_Secret": [
                                  "Succeeded"
                                ]
                              },
                              "cases": {
                                "Case": {
                                  "case": "tagmgmt",
                                  "actions": {
                                    "tagmgmt": {
                                      "runAfter": {},
                                      "type": "Function",
                                      "inputs": {
                                        "body": "@body('Parse_JSON')?['functionBody']",
                                        "Headers": {
                                          "x-functions-key": "[listKeys(resourceId('Microsoft.Web/sites/host', parameters('functioname'), 'default'), '2022-09-01').functionKeys.monitoringKey]"
                                        },
                                        "function": {
                                          "id": "[format('{0}/functions/tagmgmt', resourceId('Microsoft.Web/sites', parameters('functioname')))]"
                                        },
                                        "headers": {
                                          "x-functions-key": "@body('Get_secret')?['value']"
                                        }
                                      }
                                    }
                                  }
                                },
                                "Case_2": {
                                  "case": "alertmgmt",
                                  "actions": {
                                    "alertConfigMgmt": {
                                      "runAfter": {},
                                      "type": "Function",
                                      "inputs": {
                                        "body": "@body('Parse_JSON')?['functionBody']",
                                        "function": {
                                          "id": "[format('{0}/functions/alertConfigMgmt', resourceId('Microsoft.Web/sites', parameters('functioname')))]"
                                        },
                                        "headers": {
                                          "x-functions-key": "@body('Get_secret')?['value']"
                                        }
                                      }
                                    }
                                  }
                                },
                                "Case_3": {
                                  "case": "policymgmt",
                                  "actions": {
                                    "policymgmt": {
                                      "runAfter": {},
                                      "type": "Function",
                                      "inputs": {
                                        "body": "@body('Parse_JSON')?['functionBody']",
                                        "function": {
                                          "id": "[format('{0}/functions/policymgmt', resourceId('Microsoft.Web/sites', parameters('functioname')))]"
                                        },
                                        "headers": {
                                          "x-functions-key": "@body('Get_secret')?['value']"
                                        }
                                      }
                                    }
                                  }
                                },
                                "Case_4": {
                                  "case": "agentMgmt",
                                  "actions": {
                                    "agentMgmt": {
                                      "runAfter": {},
                                      "type": "Function",
                                      "inputs": {
                                        "body": "@body('Parse_JSON')?['functionBody']",
                                        "function": {
                                          "id": "[format('{0}/functions/agentmgmt', resourceId('Microsoft.Web/sites', parameters('functioname')))]"
                                        },
                                        "headers": {
                                          "x-functions-key": "@body('Get_secret')?['value']"
                                        }
                                      }
                                    }
                                  }
                                }
                              },
                              "default": {
                                "actions": {}
                              },
                              "expression": "@body('Parse_JSON')?['Function']",
                              "type": "Switch"
                            }
                          },
                          "outputs": {}
                        },
                        "parameters": {
                          "$connections": {
                            "value": {
                              "keyvault": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', 'keyvault')]",
                                "connectionName": "keyvault",
                                "connectionProperties": {
                                  "authentication": {
                                    "type": "ManagedServiceIdentity"
                                  }
                                },
                                "id": "[format('/subscriptions/{0}/providers/Microsoft.Web/locations/eastus/managedApis/keyvault', parameters('subscriptionId'))]"
                              }
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.Web/connections', 'keyvault')]"
                      ]
                    },
                    {
                      "type": "Microsoft.Web/connections",
                      "apiVersion": "2018-07-01-preview",
                      "name": "keyvault",
                      "properties": {
                        "displayName": "KeyVault",
                        "authenticatedUser": {},
                        "overallStatus": "Ready",
                        "statuses": [
                          {
                            "status": "Ready"
                          }
                        ],
                        "connectionState": "Enabled",
                        "parameterValueSet": {
                          "name": "oauthMI",
                          "values": {
                            "vaultName": {
                              "value": "[variables('keyVaultName')]"
                            }
                          }
                        },
                        "customParameterValues": {},
                        "createdTime": "2023-10-12T20:52:26.0864876Z",
                        "changedTime": "2023-10-12T20:52:26.0864876Z",
                        "api": {
                          "name": "keyvault",
                          "displayName": "Azure Key Vault",
                          "description": "Azure Key Vault is a service to securely store and access secrets.",
                          "iconUri": "https://connectoricons-prod.azureedge.net/releases/v1.0.1656/1.0.1656.3432/keyvault/icon.png",
                          "brandColor": "#0079d6",
                          "category": "Standard",
                          "id": "[format('/subscriptions/{0}/providers/Microsoft.Web/locations/{1}/managedApis/keyvault', parameters('subscriptionId'), parameters('location'))]",
                          "type": "Microsoft.Web/locations/managedApis"
                        },
                        "testLinks": [],
                        "testRequests": []
                      },
                      "location": "[parameters('location')]"
                    }
                  ],
                  "outputs": {
                    "logicAppPrincipalId": {
                      "type": "string",
                      "value": "[reference(resourceId('Microsoft.Logic/workflows', parameters('logicAppName')), '2019-05-01', 'full').identity.principalId]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', parameters('functionname'))]",
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('amp-{0}-kv-{1}', parameters('instanceName'), substring(uniqueString(parameters('subscriptionId'), parameters('resourceGroupName'), 'keyvault'), 0, 6)))]"
              ]
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "workbook2deployment",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "lawresourceid": {
                    "value": "[parameters('lawresourceid')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "Tags": {
                    "value": "[parameters('Tags')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "18188190261874203369"
                    }
                  },
                  "parameters": {
                    "Tags": {
                      "type": "object"
                    },
                    "location": {
                      "type": "string"
                    },
                    "lawresourceid": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "$fxv#0": {
                      "version": "Notebook/1.0",
                      "items": [
                        {
                          "type": 1,
                          "content": {
                            "json": "# Azure Monitor Starter Packs - Extended Admin Centre - V3.0 (Beta)\n\n\n"
                          },
                          "customWidth": "50",
                          "name": "textTitle"
                        },
                        {
                          "type": 9,
                          "content": {
                            "version": "KqlParameterItem/1.0",
                            "parameters": [
                              {
                                "id": "741661c9-5e51-44bc-8e8e-bfc6396f2646",
                                "version": "KqlParameterItem/1.0",
                                "name": "showHelp",
                                "label": "Show Help Info",
                                "type": 10,
                                "isRequired": true,
                                "typeSettings": {
                                  "additionalResourceOptions": [],
                                  "showDefault": false
                                },
                                "jsonData": "[[\n    { \"value\":\"yes\", \"label\":\"Yes\",\"default\": \"yes\" },\n    { \"value\":\"no\", \"label\":\"No\" }\n]",
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "value": "no"
                              },
                              {
                                "version": "KqlParameterItem/1.0",
                                "name": "showHidden",
                                "label": "Show Hidden Items",
                                "type": 10,
                                "isRequired": true,
                                "typeSettings": {
                                  "additionalResourceOptions": [],
                                  "showDefault": false
                                },
                                "jsonData": "[[\n    { \"value\":\"yes\", \"label\":\"Yes\",\"default\": \"yes\" },\n    { \"value\":\"no\", \"label\":\"No\" }\n]",
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "value": "no",
                                "id": "f538abc2-3e09-45aa-a81e-b966a64e0703"
                              }
                            ],
                            "style": "above",
                            "queryType": 0,
                            "resourceType": "microsoft.operationalinsights/workspaces"
                          },
                          "customWidth": "50",
                          "name": "showHelpparameter"
                        },
                        {
                          "type": 11,
                          "content": {
                            "version": "LinkItem/1.0",
                            "style": "tabs",
                            "links": [
                              {
                                "id": "a9a63932-4a11-4fe1-938c-02619e609193",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Getting Started",
                                "subTarget": "gettingstarted",
                                "style": "link"
                              },
                              {
                                "id": "4f0ca437-37b0-42f6-a150-e994338f5185",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Status",
                                "subTarget": "status",
                                "style": "link"
                              },
                              {
                                "id": "15f0fa97-4286-48d6-9dea-26a956197d26",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Servers",
                                "subTarget": "discovery",
                                "style": "link"
                              },
                              {
                                "id": "c5269422-e723-43b6-b923-8bf44fd49320",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Services",
                                "subTarget": "paas",
                                "style": "link"
                              },
                              {
                                "id": "7499a88f-a536-41d7-9b58-9ebae1b5290e",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Alert Rules",
                                "subTarget": "alertmanagement",
                                "style": "link"
                              },
                              {
                                "id": "3a19e3a9-d64d-41d8-a313-3a60db36bcc4",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Policies",
                                "subTarget": "policystatus",
                                "style": "link"
                              },
                              {
                                "id": "c2a67d72-dd46-44ea-adba-b9d70915c607",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Packs",
                                "subTarget": "rulemanagement",
                                "style": "link"
                              },
                              {
                                "id": "d8f7936d-170f-430d-af7d-ac22115a9e38",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Agents",
                                "subTarget": "agentmgmt",
                                "style": "link"
                              },
                              {
                                "id": "afec2944-3bd3-4bd3-8afa-6dc39d0b623a",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Discovery(Prototype)",
                                "subTarget": "autodiscovery",
                                "style": "link"
                              },
                              {
                                "id": "e1f636a4-1593-49ef-bf35-abf708e2be48",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Configuration",
                                "subTarget": "backend",
                                "style": "link"
                              },
                              {
                                "id": "295ed7b4-8237-409a-87d2-1efd439bea97",
                                "cellValue": "tabSelection",
                                "linkTarget": "parameter",
                                "linkLabel": "Logs",
                                "subTarget": "logs",
                                "style": "link"
                              }
                            ]
                          },
                          "customWidth": "75",
                          "name": "mainLinksTab"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "loadType": "always",
                            "items": [
                              {
                                "type": 1,
                                "content": {
                                  "json": "## General Parameters\n\n### Subscriptions\n\nSelect the Subscriptions that will be used in the Configuration\n\n### Logic App\n\nSelect the logic app to be used. Typically the shoulbe a single one but if more instances exist, select the one for the instance you want to use.\n\n### Function Apps\n\nSelect the Backend Function to be used. Typically the shoulbe a single one but if more instances exist, select the one for the instance you want to use.\n\n### Config Function Key\n\nThis field will be automatically populated once the function is selected.\n\n### Workspace\n\nSelect the Log Analytics Workspace to be used for this instance.\n\n### Azure Managed Grafana\n\nSelect the Azure Managed Grafana if you have deployed one along with the solution.",
                                  "style": "info"
                                },
                                "conditionalVisibility": {
                                  "parameterName": "showHelp",
                                  "comparison": "isEqualTo",
                                  "value": "yes"
                                },
                                "name": "text - Configuration "
                              },
                              {
                                "type": 9,
                                "content": {
                                  "version": "KqlParameterItem/1.0",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "parameters": [
                                    {
                                      "id": "7a778b2c-619d-4f82-bd1c-810f853af6fd",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "Subscriptions",
                                      "type": 6,
                                      "isRequired": true,
                                      "isGlobal": true,
                                      "multiSelect": true,
                                      "quote": "'",
                                      "delimiter": ",",
                                      "typeSettings": {
                                        "additionalResourceOptions": [
                                          "value::all"
                                        ],
                                        "includeAll": false,
                                        "showDefault": false
                                      },
                                      "timeContext": {
                                        "durationMs": 86400000
                                      },
                                      "value": [
                                        "/subscriptions/b1e924f9-d16f-4260-a3c8-ff1ee462956b"
                                      ]
                                    },
                                    {
                                      "id": "1efb8bbe-532a-491b-b3c4-55f1402ee280",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "logicAppResource",
                                      "label": "Logic App",
                                      "type": 5,
                                      "isRequired": true,
                                      "query": "resources\n| where type == \"microsoft.logic/workflows\" \n| where isnotempty(tags.MonitorStarterPacksComponents)\n| project Id=id, Name=name",
                                      "crossComponentResources": [
                                        "value::tenant"
                                      ],
                                      "typeSettings": {
                                        "resourceTypeFilter": {
                                          "microsoft.logic/workflows": true
                                        },
                                        "additionalResourceOptions": [],
                                        "showDefault": false
                                      },
                                      "timeContext": {
                                        "durationMs": 86400000
                                      },
                                      "queryType": 1,
                                      "resourceType": "microsoft.resources/tenants",
                                      "value": "/subscriptions/b1e924f9-d16f-4260-a3c8-ff1ee462956b/resourceGroups/rg-MonstarPacks/providers/Microsoft.Logic/workflows/AMP-vss-LogicApp"
                                    },
                                    {
                                      "id": "16d48fd3-189f-4604-9582-da7cf5c93d7c",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "FunctionApps",
                                      "label": "Function Apps",
                                      "type": 5,
                                      "description": "Select the function to provide the access key.",
                                      "isRequired": true,
                                      "isGlobal": true,
                                      "query": "resources\n| where type =~ 'microsoft.web/sites' and ['kind'] =~ 'functionapp'\n| where isnotempty(tags.MonitorStarterPacksComponents)\n| project id,name",
                                      "crossComponentResources": [
                                        "value::tenant"
                                      ],
                                      "typeSettings": {
                                        "additionalResourceOptions": []
                                      },
                                      "queryType": 1,
                                      "value": "/subscriptions/b1e924f9-d16f-4260-a3c8-ff1ee462956b/resourceGroups/rg-MonstarPacks/providers/Microsoft.Web/sites/AMP-vss-b1e924f9-Function"
                                    },
                                    {
                                      "id": "c9fbafc9-2806-4c24-8d34-18f7cae66299",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "configKey",
                                      "label": "Config Function Key",
                                      "type": 1,
                                      "description": "The function key is fetched automatically from the function selected on the left.",
                                      "isRequired": true,
                                      "isGlobal": true,
                                      "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"POST\",\"path\":\"{FunctionApps}/functions/config/listkeys?api-version=2022-03-01\",\"urlParams\":[],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.default\",\"columns\":[]}}]}",
                                      "typeSettings": {
                                        "isPassword": true
                                      },
                                      "queryType": 12
                                    },
                                    {
                                      "id": "4552c35d-c26c-4cbf-a4cf-b2e57ff7ee78",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "Workspace",
                                      "label": "WorkSpace",
                                      "type": 5,
                                      "isRequired": true,
                                      "isGlobal": true,
                                      "query": "resources\n| where type == \"microsoft.operationalinsights/workspaces\"\n| project id",
                                      "crossComponentResources": [
                                        "value::all"
                                      ],
                                      "typeSettings": {
                                        "additionalResourceOptions": [],
                                        "showDefault": false
                                      },
                                      "queryType": 1,
                                      "resourceType": "microsoft.resourcegraph/resources",
                                      "value": "/subscriptions/b1e924f9-d16f-4260-a3c8-ff1ee462956b/resourceGroups/rg-MonstarPacks/providers/Microsoft.OperationalInsights/workspaces/Monster-LAW"
                                    },
                                    {
                                      "id": "ea93902e-9856-4bd4-998d-ea88378907a7",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "GrafanaInstance",
                                      "label": "Azure Managed Grafana",
                                      "type": 2,
                                      "isRequired": true,
                                      "isGlobal": true,
                                      "query": "resources\n| where type =~ \"microsoft.dashboard/grafana\"\n| where isnotempty(tags.monitorStarterPacksComponents) or isnotempty(tags.MonitorStarterPacksComponents)\n| project id, label=properties.endpoint",
                                      "crossComponentResources": [
                                        "value::tenant"
                                      ],
                                      "typeSettings": {
                                        "additionalResourceOptions": [],
                                        "showDefault": false
                                      },
                                      "timeContext": {
                                        "durationMs": 86400000
                                      },
                                      "queryType": 1,
                                      "resourceType": "microsoft.resources/tenants",
                                      "value": null
                                    },
                                    {
                                      "id": "7961f447-f72b-401d-a26b-283a44e45b2e",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "DefaultAG",
                                      "label": "Default Action Group",
                                      "type": 5,
                                      "isRequired": true,
                                      "query": "resources\r\n| where type == \"microsoft.insights/actiongroups\"\r\n| where properties.enabled == 'true'\r\n| project id",
                                      "crossComponentResources": [
                                        "value::tenant"
                                      ],
                                      "typeSettings": {
                                        "additionalResourceOptions": []
                                      },
                                      "timeContext": {
                                        "durationMs": 86400000
                                      },
                                      "queryType": 1,
                                      "resourceType": "microsoft.resources/tenants",
                                      "value": "/subscriptions/b1e924f9-d16f-4260-a3c8-ff1ee462956b/resourceGroups/NetworkWatcherRG/providers/microsoft.insights/actiongroups/Jose"
                                    }
                                  ],
                                  "style": "above",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants"
                                },
                                "customWidth": "100",
                                "conditionalVisibility": {
                                  "parameterName": "tabSelection",
                                  "comparison": "isEqualTo",
                                  "value": "backend"
                                },
                                "name": "generalParams"
                              },
                              {
                                "type": 9,
                                "content": {
                                  "version": "KqlParameterItem/1.0",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "parameters": [
                                    {
                                      "id": "03340268-1ac8-4d74-a76e-bc37a4bdd45c",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "appInsightsName",
                                      "type": 1,
                                      "isRequired": true,
                                      "query": "resources\n| where type == \"microsoft.insights/components\"\n| where name == \"{FunctionApps:name}\"\n| project id",
                                      "crossComponentResources": [
                                        "value::tenant"
                                      ],
                                      "queryType": 1,
                                      "resourceType": "microsoft.resources/tenants"
                                    }
                                  ],
                                  "style": "above",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants"
                                },
                                "conditionalVisibility": {
                                  "parameterName": "showHidden",
                                  "comparison": "isEqualTo",
                                  "value": "yes"
                                },
                                "name": "parameters - 5"
                              },
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "tabs",
                                  "links": [
                                    {
                                      "id": "f5b4b4b6-c5d7-4941-b807-8a61df48a0f4",
                                      "cellValue": "configTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Resource List",
                                      "subTarget": "resources",
                                      "style": "link"
                                    },
                                    {
                                      "id": "2b8648a3-8221-4c46-bf6c-0962dc862628",
                                      "cellValue": "configTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Namespace Table",
                                      "subTarget": "namespaces",
                                      "style": "link"
                                    }
                                  ]
                                },
                                "name": "links - 4"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "resources\n| where isnotempty(tags.MonitorStarterPacks) or isnotempty(tags.MonitorStarterPacksComponents)\n|union ( \npolicyresources | where isnotempty(properties.metadata.MonitorStarterPacks))\n| summarize count() by type\n| sort by count_ desc ",
                                  "size": 0,
                                  "title": "Monitoring Packs resources and Components",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "gridSettings": {
                                    "filter": true
                                  }
                                },
                                "conditionalVisibility": {
                                  "parameterName": "configTab",
                                  "comparison": "isEqualTo",
                                  "value": "resources"
                                },
                                "name": "Installed Components",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getAllServiceTags\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"\",\"value\":\"\"}],\"transformers\":null}",
                                  "size": 0,
                                  "queryType": 10
                                },
                                "conditionalVisibility": {
                                  "parameterName": "configTab",
                                  "comparison": "isEqualTo",
                                  "value": "namespaces"
                                },
                                "name": "queryServiceTags"
                              }
                            ],
                            "exportParameters": true
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "backend"
                          },
                          "name": "ConfigStatusGroup"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getAllServiceTags\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"\",\"value\":\"\"}],\"transformers\":null}",
                            "size": 0,
                            "queryType": 10
                          },
                          "conditionalVisibility": {
                            "parameterName": "showHidden",
                            "comparison": "isEqualTo",
                            "value": "yes"
                          },
                          "name": "queryServiceTags - Global"
                        },
                        {
                          "type": 1,
                          "content": {
                            "json": "# Getting Started\n\nWelcome to the Azure Monitoring Packs. This workbook was designed to help you configuring the solution. Here you can:\n- Enable/Disable monitoring packs for one or more VMs or services. You may also disable all the monitoring for a specific server or service. This will remove the tags and the rule associations. For services, right now, the alerts wont be deleted by themselves.\n- Enable/Disable Alerts in bulk. You can also assign a different Action group to one or more alerts or delete the rules**\n- Check policy status and start remediation if required. By clicking in a policy, you can also assign that policy to another scope.\n- Check Monitor pack associations.\n- Review discovered applications (VMs only)\n- Manage agent configuration (install/remove)\n\n## Link to your managed [Grafana]({GrafanaInstance:label}) instance, if you enabled it. Make sure to property set permissions before attemping to access it.\n\n## <span style=\"color: #FF0000\">If this is the first time using this solution, please configure the parameters in the ***Configuration*** tab and save the workbook for proper functionality.</span>\n\n\n## Please check the Monitoring Packs repository for updates. [Azure MONitor STARter Packs](http://github.com/Azure/AzureMonitorStarterPacks)\n## Also check the Azure Monitor Baseline Alerts ([AMBA](http://aka.ms/amba)) website for the details on the alerts.\n\n\n\n\n\n"
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "gettingstarted"
                          },
                          "name": "textGetStarted"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "items": [
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "tabs",
                                  "links": [
                                    {
                                      "id": "04e679ee-16ae-46f6-a85b-d47751c0bcca",
                                      "cellValue": "dashTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Active Alerts",
                                      "subTarget": "alerts",
                                      "preText": "",
                                      "style": "link"
                                    },
                                    {
                                      "id": "a4b4c83e-fce7-48e2-95ce-acf12c050eaa",
                                      "cellValue": "dashTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "IaaS Summary",
                                      "subTarget": "iaas",
                                      "style": "link"
                                    },
                                    {
                                      "id": "4e01b5fe-51d5-4ba4-9d3c-6f5b5ef2d93c",
                                      "cellValue": "dashTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Services Summary",
                                      "subTarget": "paas",
                                      "style": "link"
                                    }
                                  ]
                                },
                                "name": "links - 3 - Copy"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 1,
                                      "content": {
                                        "json": "## IaaS Information\n\nThe summary below shows details related to the IaaS Monitoring packs.",
                                        "style": "info"
                                      },
                                      "conditionalVisibility": {
                                        "parameterName": "showHelp",
                                        "comparison": "isEqualTo",
                                        "value": "yes"
                                      },
                                      "name": "text - Summary - IaaS"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources | where type =~ 'microsoft.hybridcompute/machines' or type =~ 'microsoft.compute/virtualmachines'\n| extend MonitorStatus=iff(isnotempty(tostring(tags.MonitorStarterPacks)),'Monitored','Not Monitored')\n| summarize count() by MonitorStatus",
                                        "size": 1,
                                        "title": "Monitoring Status (Tags)",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "piechart",
                                        "chartSettings": {
                                          "seriesLabelSettings": [
                                            {
                                              "seriesName": "Monitored",
                                              "color": "green"
                                            },
                                            {
                                              "seriesName": "Not Monitored",
                                              "color": "orange"
                                            }
                                          ]
                                        }
                                      },
                                      "customWidth": "33",
                                      "name": "Monitoring Status Tags",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "Resources\n| where type == 'microsoft.compute/virtualmachines'\n| extend\n    JoinID = toupper(id)\n| join kind=leftouter(\n    Resources\n    | where ( type == 'microsoft.compute/virtualmachines/extensions') and name in ('AzureMonitorLinuxAgent', 'AzureMonitorWindowsAgent')\n    | extend\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        ExtensionName = name\n) on $left.JoinID == $right.VMId\n| union (Resources\n| where type == 'microsoft.hybridcompute/machines'\n| extend\n    JoinID = toupper(id)\n| join kind=leftouter(\n    Resources\n    | where type == 'microsoft.hybridcompute/machines/extensions' and name in ('AzureMonitorLinuxAgent', 'AzureMonitorWindowsAgent')\n    | extend\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        ExtensionName = name\n) on $left.JoinID == $right.VMId)\n| summarize count() by AgentInstalled=iff(isempty(ExtensionName),\"No\",\"Yes\")",
                                        "size": 1,
                                        "title": "Agent Install Status",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "piechart",
                                        "chartSettings": {
                                          "seriesLabelSettings": [
                                            {
                                              "seriesName": "Yes",
                                              "label": "AMA Installed",
                                              "color": "green"
                                            },
                                            {
                                              "seriesName": "No",
                                              "label": "No AMA",
                                              "color": "red"
                                            }
                                          ]
                                        }
                                      },
                                      "customWidth": "33",
                                      "name": "agentInstallStatus",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "policyresources | where type == \"microsoft.policyinsights/policystates\" | extend policyName=tostring(properties.policyDefinitionName), complianceState=properties.complianceState\n| join (policyresources | where type == \"microsoft.authorization/policydefinitions\" and isnotempty(properties.metadata.MonitorStarterPacks) | project policyId=id, policyName=name, pack=tostring(properties.metadata.MonitorStarterPacks)) on policyName\n| project policyId, policyName, complianceState=tostring(complianceState), pack,type='Policy'\n| union( policyresources\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\n| extend complianceState = tostring(properties.complianceState)\n| extend\n\tresourceId = tostring(properties.resourceId),\n\tpolicyAssignmentId = tostring(properties.policyAssignmentId),\n\tpolicyAssignmentScope = tostring(properties.policyAssignmentScope),\n\tpolicyAssignmentName = tostring(properties.policyAssignmentName),\n\tpolicyDefinitionId = tostring(properties.policyDefinitionId),\n    policySetDefinitionId=tostring(properties.policySetDefinitionId),\n\tpolicyDefinitionReferenceId = tostring(properties.policyDefinitionReferenceId),\n\tstateWeight = iff(complianceState == 'NonCompliant', int(300), iff(complianceState == 'Compliant', int(200), iff(complianceState == 'Conflict', int(100), iff(complianceState == 'Exempt', int(50), int(0)))))\n| summarize max(stateWeight) by resourceId, policyAssignmentId, policyAssignmentScope, policyAssignmentName,policySetDefinitionId\n| summarize counts = count() by policyAssignmentId, policyAssignmentScope, max_stateWeight, policyAssignmentName,policySetDefinitionId\n| summarize overallStateWeight = max(max_stateWeight),\nnonCompliantCount = sumif(counts, max_stateWeight == 300),\ncompliantCount = sumif(counts, max_stateWeight == 200),\nconflictCount = sumif(counts, max_stateWeight == 100),\nexemptCount = sumif(counts, max_stateWeight == 50) by policyAssignmentId, policyAssignmentScope, policyAssignmentName,policySetDefinitionId\n| extend totalResources = todouble(nonCompliantCount + compliantCount + conflictCount + exemptCount)\n| extend compliancePercentage = iff(totalResources == 0, todouble(100), 100 * todouble(compliantCount + exemptCount) / totalResources)\n| project policyAssignmentName, scope = policyAssignmentScope,policySetDefinitionId,\ncomplianceState = iff(overallStateWeight == 300, 'nonCompliant', iff(overallStateWeight == 200, 'Compliant', iff(overallStateWeight == 100, 'conflict', iff(overallStateWeight == 50, 'exempt', 'notstarted')))),\ncompliancePercentage,\ncompliantCount,\nnonCompliantCount,\nconflictCount,\nexemptCount\n| where isnotempty(policySetDefinitionId)\n| join (policyresources\n| where type =~ 'microsoft.authorization/policysetdefinitions' and isnotempty(properties.metadata.MonitorStarterPacks)\n| extend policySetDefinitionId=tostring(id)) on policySetDefinitionId\n| project policyId=policySetDefinitionId, policyName=name,complianceState,pack='N/A', type='Set')\n| summarize count() by complianceState,policyName",
                                        "size": 1,
                                        "title": "Assignment Policies Status",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "piechart",
                                        "chartSettings": {
                                          "seriesLabelSettings": [
                                            {
                                              "seriesName": "Compliant",
                                              "label": "Compliant",
                                              "color": "green"
                                            },
                                            {
                                              "seriesName": "nonCompliant",
                                              "label": "Not Compliant",
                                              "color": "redDark"
                                            }
                                          ]
                                        }
                                      },
                                      "customWidth": "33",
                                      "name": "policyComplianceStatus",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| extend resourceId=split(id,'/providers/Microsoft.Insights/')[0]\n| where isnotnull(properties.dataCollectionRuleId)\n| project rulename=tostring(split(properties.dataCollectionRuleId,\"/\")[8]),resourceName=tostring(split(resourceId,\"/\")[8]),resourceId//ruleId=properties.dataCollectionRuleId\n| join (resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isnotempty(MPs) //or properties.dataSources.performanceCounters[0].name == 'VMInsightsPerfCounters'\n| summarize by Pack=MPs,rulename=tostring(name)) on rulename\n| project-away rulename,rulename1,resourceId\n| summarize Associated=count() by Pack\n| sort by Pack asc",
                                        "size": 1,
                                        "title": "Servers/Pack (Association)",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "piechart",
                                        "tileSettings": {
                                          "showBorder": false,
                                          "titleContent": {
                                            "columnMatch": "Pack",
                                            "formatter": 1
                                          },
                                          "leftContent": {
                                            "columnMatch": "Associated",
                                            "formatter": 12,
                                            "formatOptions": {
                                              "palette": "auto"
                                            },
                                            "numberFormat": {
                                              "unit": 17,
                                              "options": {
                                                "maximumSignificantDigits": 3,
                                                "maximumFractionDigits": 2
                                              }
                                            }
                                          }
                                        },
                                        "mapSettings": {
                                          "locInfo": "LatLong",
                                          "sizeSettings": "Associated",
                                          "sizeAggregation": "Sum",
                                          "legendMetric": "Associated",
                                          "legendAggregation": "Sum",
                                          "itemColorSettings": {
                                            "type": "heatmap",
                                            "colorAggregation": "Sum",
                                            "nodeColorField": "Associated",
                                            "heatmapPalette": "greenRed"
                                          }
                                        }
                                      },
                                      "customWidth": "33",
                                      "name": "AssociatedResourceStatsperTag - Copy - Copy",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| extend resourceId=split(id,'/providers/Microsoft.Insights/')[0]\n| where isnotnull(properties.dataCollectionRuleId)\n| project rulename=tostring(split(properties.dataCollectionRuleId,\"/\")[8]),resourceName=tostring(split(resourceId,\"/\")[8]),resourceId//ruleId=properties.dataCollectionRuleId\n| join (resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isnotempty(MPs) //or properties.dataSources.performanceCounters[0].name == 'VMInsightsPerfCounters'\n| summarize by Pack=MPs,rulename=tostring(name)) on rulename\n| project-away rulename,rulename1,resourceId\n| summarize Tagged=count() by Pack\n| sort by Pack asc\n\n\n",
                                        "size": 1,
                                        "title": "Tagged Resources per Tag",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "tiles",
                                        "tileSettings": {
                                          "showBorder": false,
                                          "titleContent": {
                                            "columnMatch": "Pack",
                                            "formatter": 1
                                          },
                                          "leftContent": {
                                            "columnMatch": "Tagged",
                                            "formatter": 12,
                                            "formatOptions": {
                                              "palette": "auto"
                                            },
                                            "numberFormat": {
                                              "unit": 17,
                                              "options": {
                                                "maximumSignificantDigits": 3,
                                                "maximumFractionDigits": 2
                                              }
                                            }
                                          }
                                        }
                                      },
                                      "customWidth": "33",
                                      "name": "taggedResourceStatsperTag",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| extend resourceId=split(id,'/providers/Microsoft.Insights/')[0]\n| where isnotnull(properties.dataCollectionRuleId)\n| project rulename=tostring(split(properties.dataCollectionRuleId,\"/\")[8]),resourceName=tostring(split(resourceId,\"/\")[8]),resourceId//ruleId=properties.dataCollectionRuleId\n| join (resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isnotempty(MPs) //or properties.dataSources.performanceCounters[0].name == 'VMInsightsPerfCounters'\n| summarize by Pack=MPs,rulename=tostring(name)) on rulename\n| project-away rulename,rulename1,resourceId\n| summarize Associated=count() by Pack\n| sort by Pack asc",
                                        "size": 1,
                                        "title": "Associated Servers per Pack",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "tiles",
                                        "tileSettings": {
                                          "showBorder": false,
                                          "titleContent": {
                                            "columnMatch": "Pack",
                                            "formatter": 1
                                          },
                                          "leftContent": {
                                            "columnMatch": "Associated",
                                            "formatter": 12,
                                            "formatOptions": {
                                              "palette": "auto"
                                            },
                                            "numberFormat": {
                                              "unit": 17,
                                              "options": {
                                                "maximumSignificantDigits": 3,
                                                "maximumFractionDigits": 2
                                              }
                                            }
                                          }
                                        }
                                      },
                                      "customWidth": "33",
                                      "name": "AssociatedResourceStatsperTag - Copy",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    }
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "dashTab",
                                  "comparison": "isEqualTo",
                                  "value": "iaas"
                                },
                                "name": "groupDashboardIaaS"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 1,
                                      "content": {
                                        "json": "## Active Alerts List\n\nThis tab shows all Monitoring Packs related alerts that are currently active.",
                                        "style": "info"
                                      },
                                      "conditionalVisibility": {
                                        "parameterName": "showHelp",
                                        "comparison": "isEqualTo",
                                        "value": "yes"
                                      },
                                      "name": "text - Summary - Active Alerts"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "alertsmanagementresources\n| where ['type'] == 'microsoft.alertsmanagement/alerts'\n| project ['Alert Id']=id,resourceId=properties.context.context.resourceId, alertRule=tolower(tostring(properties.essentials.alertRule)), status=properties.context.status,severity=properties.context.context.severity\n| where isnotempty(alertRule)\n| join (resources\n| where type == \"microsoft.insights/scheduledqueryrules\" or type ==\"microsoft.insights/metricalerts\" or type == 'microsoft.insights/activitylogalerts'\n| where isnotempty(tags.MonitorStarterPacks)\n| extend alertRule=tolower(tostring(['id']))) on alertRule\n| project id, ['Alert Name']=name,['Details']=['Alert Id'], Status=status, Resource=resourceId, Sev=severity\n| where Status=='Activated'\n",
                                        "size": 0,
                                        "title": "Active Alerts",
                                        "exportedParameters": [
                                          {
                                            "fieldName": "Details",
                                            "parameterName": "selectedAlertId",
                                            "parameterType": 5
                                          }
                                        ],
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "Details",
                                              "formatter": 7,
                                              "formatOptions": {
                                                "linkTarget": "OpenBlade",
                                                "linkLabel": "Details",
                                                "linkIsContextBlade": true,
                                                "bladeOpenContext": {
                                                  "bladeName": "AlertDetails.ReactView",
                                                  "extensionName": "Microsoft_Azure_Monitoring_Alerts",
                                                  "bladeJsonParameters": "{\n    \"alertId\": \"{selectedAlertId}\",\n    \"invokedFrom\": \"CopyLinkFeature\"\n}"
                                                }
                                              }
                                            },
                                            {
                                              "columnMatch": "Status",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": "==",
                                                    "thresholdValue": "Activated",
                                                    "representation": "up",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "success",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "columnMatch": "Resource",
                                              "formatter": 13,
                                              "formatOptions": {
                                                "linkTarget": "Resource",
                                                "linkIsContextBlade": true,
                                                "showIcon": true
                                              }
                                            },
                                            {
                                              "columnMatch": "Sev",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": "==",
                                                    "thresholdValue": "1",
                                                    "representation": "Sev1",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "==",
                                                    "thresholdValue": "2",
                                                    "representation": "Sev2",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "==",
                                                    "thresholdValue": "3",
                                                    "representation": "Sev3",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "==",
                                                    "thresholdValue": "4",
                                                    "representation": "Sev4",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "==",
                                                    "thresholdValue": "0",
                                                    "representation": "Sev0",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "unknown",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "columnMatch": "Alert Id",
                                              "formatter": 7,
                                              "formatOptions": {
                                                "linkTarget": "Resource",
                                                "linkLabel": "Details",
                                                "linkIsContextBlade": true
                                              }
                                            },
                                            {
                                              "columnMatch": "Target",
                                              "formatter": 13,
                                              "formatOptions": {
                                                "linkTarget": null,
                                                "showIcon": true
                                              }
                                            }
                                          ]
                                        }
                                      },
                                      "customWidth": "66",
                                      "name": "activeAlertsquery"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "alertsmanagementresources\n| where ['type'] == 'microsoft.alertsmanagement/alerts'\n| project ['Alert Id']=id,resourceId=properties.context.context.resourceId, alertRule=tolower(tostring(properties.essentials.alertRule)), status=properties.context.status\n| where isnotempty(alertRule)\n| join (resources\n| where type == \"microsoft.insights/scheduledqueryrules\" or type ==\"microsoft.insights/metricalerts\" or type == 'microsoft.insights/activitylogalerts'\n| where isnotempty(tags.MonitorStarterPacks)\n| extend alertRule=tolower(tostring(['id']))) on alertRule\n| summarize count() by AlertType=type\n\n",
                                        "size": 0,
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "piechart"
                                      },
                                      "customWidth": "33",
                                      "name": "activeAlertsQueryPie"
                                    }
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "dashTab",
                                  "comparison": "isEqualTo",
                                  "value": "alerts"
                                },
                                "name": "groupDashAlerts"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getAllServiceTags&Type=PaaS\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"\",\"value\":\"\"}],\"transformers\":null}",
                                  "size": 0,
                                  "queryType": 10
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "dashTab",
                                    "comparison": "isEqualTo",
                                    "value": "paas"
                                  },
                                  {
                                    "parameterName": "showHidden",
                                    "comparison": "isEqualTo",
                                    "value": "yes"
                                  }
                                ],
                                "name": "queryServiceTags"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getAllServiceTags&Type=Platform\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"\",\"value\":\"\"}],\"transformers\":null}",
                                  "size": 0,
                                  "queryType": 10
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "dashTab",
                                    "comparison": "isEqualTo",
                                    "value": "paas"
                                  },
                                  {
                                    "parameterName": "showHidden",
                                    "comparison": "isEqualTo",
                                    "value": "yes"
                                  }
                                ],
                                "name": "queryServiceTags - Platform"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "resources\n| where tolower(type) in (\"microsoft.insights/metricalerts\")\n| where isnotempty(tags.MonitorStarterPacks)\n| project nameSpace=tolower(strcat(tostring(split(properties.scopes[0],\"/\")[-3]),\"/\",tostring(split(properties.scopes[0],\"/\")[-2]))),Target=split(properties.scopes[0],\"/\")[-1]\n| union (resources\n| where tolower(type) in (\"microsoft.insights/activitylogalerts\")\n| where isnotempty(tags.MonitorStarterPacks)\n| project nameSpace=tolower(strcat(tostring(split(properties.scopes[0],\"/\")[-3]),\"/\",tostring(split(properties.scopes[0],\"/\")[-2]))),Target=split(properties.scopes[0],\"/\")[-1])\n| distinct tostring(Target),nameSpace\n| summarize Total=count() by nameSpace",
                                  "size": 0,
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ]
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "showHidden",
                                    "comparison": "isEqualTo",
                                    "value": "yes"
                                  },
                                  {
                                    "parameterName": "dashTab",
                                    "comparison": "isEqualTo",
                                    "value": "paas"
                                  }
                                ],
                                "name": "query - resourcestomerge - nonIaaS"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"3d65009c-120d-4954-aa36-dd1e33b4b1d8\",\"mergeType\":\"innerunique\",\"leftTable\":\"queryServiceTags\",\"rightTable\":\"query - resourcestomerge - nonIaaS\",\"leftColumn\":\"nameSpace\",\"rightColumn\":\"nameSpace\"}],\"projectRename\":[{\"originalName\":\"[queryServiceTags].tag\",\"mergedName\":\"tag\",\"fromId\":\"3d65009c-120d-4954-aa36-dd1e33b4b1d8\"},{\"originalName\":\"[queryServiceTags].type\",\"mergedName\":\"type\",\"fromId\":\"3d65009c-120d-4954-aa36-dd1e33b4b1d8\"},{\"originalName\":\"[query - resourcestomerge - nonIaaS].Total\",\"mergedName\":\"Total\",\"fromId\":\"3d65009c-120d-4954-aa36-dd1e33b4b1d8\"},{\"originalName\":\"[query - 18].type\"},{\"originalName\":\"[query - pass - resourcestomerge].type\"},{\"originalName\":\"[queryServiceTags].tag\"},{\"originalName\":\"[query - resourcestomerge - nonIaaS].nameSpace\"},{\"originalName\":\"[queryServiceTags].nameSpace\"}]}",
                                  "size": 0,
                                  "title": "Monitored Services",
                                  "queryType": 7,
                                  "visualization": "piechart"
                                },
                                "conditionalVisibility": {
                                  "parameterName": "dashTab",
                                  "comparison": "isEqualTo",
                                  "value": "paas"
                                },
                                "showPin": false,
                                "name": "query - PaaS Graph Status"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "status"
                          },
                          "name": "dashboardgroup"
                        },
                        {
                          "type": 1,
                          "content": {
                            "json": "## Server Monitoring Setup\n\nSelect servers on the right to assign a pack. Once the backend is done with the assigning, the server will show on the left side grid.\n\nOn the left side grid, the monitoring can be updated to add more packs, as well as to remove a specific pack or remove any monitoring altogether from the server.",
                            "style": "info"
                          },
                          "conditionalVisibilities": [
                            {
                              "parameterName": "tabSelection",
                              "comparison": "isEqualTo",
                              "value": "discovery"
                            },
                            {
                              "parameterName": "showHelp",
                              "comparison": "isEqualTo",
                              "value": "yes"
                            }
                          ],
                          "name": "serversMonitoringHelptext"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "title": "Servers",
                            "items": [
                              {
                                "type": 1,
                                "content": {
                                  "json": "When Monitoring is first enabled, the Azure Monitoring Agent will also be installed to the selected servers.",
                                  "style": "info"
                                },
                                "name": "text - 3"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| extend resourceId=split(id,'/providers/Microsoft.Insights/')[0]\n| where isnotnull(properties.dataCollectionRuleId)\n| project rulename=tostring(split(properties.dataCollectionRuleId,\"/\")[8]),resourceName=tostring(split(resourceId,\"/\")[8]),resourceId=tolower(tostring(resourceId))//ruleId=properties.dataCollectionRuleId\n| join kind= inner  (\nresources\n| where type == \"microsoft.insights/datacollectionrules\"\n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isnotempty(MPs) //or properties.dataSources.performanceCounters[0].name == 'VMInsightsPerfCounters'\n| summarize by Pack=MPs,rulename=tostring(name)) on rulename\n| summarize by resourceId, Pack\n| summarize Packs=tostring(make_list(Pack)) by resourceId\n| project Packs2=tostring(Packs), resourceId",
                                  "size": 0,
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "Packs",
                                        "formatter": 1
                                      }
                                    ]
                                  }
                                },
                                "conditionalVisibility": {
                                  "parameterName": "showHidden",
                                  "comparison": "isEqualTo",
                                  "value": "yes"
                                },
                                "showPin": false,
                                "name": "query - associatedVMs"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "resources | where type =~ 'microsoft.hybridcompute/machines' \n| where isnotempty(tolower(tags.MonitorStarterPacks))\n| project Resource=id,['Resource Group']=resourceGroup,Packs=tags.MonitorStarterPacks, OS=properties.osType, subscriptionId, Location=location\n| union (resources | where type =~ 'microsoft.compute/virtualmachines' \n| where isnotempty(tolower(tags.MonitorStarterPacks)) and (tolower(tags.Vendor) != 'databricks')\n| project Resource=id,['Resource Group']=resourceGroup,Packs=tags.MonitorStarterPacks, OS=properties.storageProfile.osDisk.osType, subscriptionId, Location=location)\n| join kind= leftouter   (resourcecontainers\n| where type =~ 'microsoft.resources/subscriptions'\n| project Subscription=name,subscriptionId) on subscriptionId\n| project-away subscriptionId, subscriptionId1",
                                  "size": 0,
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "Packs",
                                        "formatter": 1
                                      },
                                      {
                                        "columnMatch": "OS",
                                        "formatter": 1
                                      }
                                    ]
                                  }
                                },
                                "conditionalVisibility": {
                                  "parameterName": "showHidden",
                                  "comparison": "isEqualTo",
                                  "value": "yes"
                                },
                                "showPin": false,
                                "name": "query - taggedVMs"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - taggedVMs\",\"rightTable\":\"query - associatedVMs\",\"leftColumn\":\"Resource\",\"rightColumn\":\"resourceId\"}],\"projectRename\":[{\"originalName\":\"[query - associatedVMs].Packs2\",\"mergedName\":\"Associations\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - associatedVMs].MPs\",\"mergedName\":\"MPs\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - taggedVMs].Resource\",\"mergedName\":\"Resource\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Resource Group\",\"mergedName\":\"Resource Group\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Packs\",\"mergedName\":\"Packs\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].OS\",\"mergedName\":\"OS\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Location\",\"mergedName\":\"Location\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Subscription\",\"mergedName\":\"Subscription\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - associatedVMs].resourceId\",\"mergedName\":\"resourceId\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"}]}",
                                        "size": 0,
                                        "title": "Monitored Machines",
                                        "exportMultipleValues": true,
                                        "exportedParameters": [
                                          {
                                            "fieldName": "",
                                            "parameterName": "taggedVMs",
                                            "parameterType": 1,
                                            "quote": ""
                                          }
                                        ],
                                        "showExportToExcel": true,
                                        "queryType": 7,
                                        "visualization": "table",
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "Associations",
                                              "formatter": 0,
                                              "tooltipFormat": {
                                                "tooltip": "If empty, no DCR associations have been created by the policies yet."
                                              }
                                            },
                                            {
                                              "columnMatch": "Associated Packs",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": "is Empty",
                                                    "representation": "2",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "success",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              }
                                            }
                                          ],
                                          "filter": true
                                        }
                                      },
                                      "showPin": false,
                                      "name": "query-mergeVMs",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 9,
                                      "content": {
                                        "version": "KqlParameterItem/1.0",
                                        "crossComponentResources": [
                                          "{Workspace}"
                                        ],
                                        "parameters": [
                                          {
                                            "id": "54f2c7fb-7251-43b6-aa4d-fd94647cac4a",
                                            "version": "KqlParameterItem/1.0",
                                            "name": "PackTagsLeft",
                                            "label": "Add/Remove",
                                            "type": 2,
                                            "isGlobal": true,
                                            "multiSelect": true,
                                            "quote": "",
                                            "delimiter": ",",
                                            "query": "resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| where isnotempty(tags.MonitorStarterPacks) and tags.MonitoringPackType=='IaaS'\n| project MPs=tostring(tags.MonitorStarterPacks)\n| summarize by MPs",
                                            "crossComponentResources": [
                                              "{Workspace}"
                                            ],
                                            "typeSettings": {
                                              "additionalResourceOptions": [],
                                              "showDefault": false
                                            },
                                            "timeContext": {
                                              "durationMs": 86400000
                                            },
                                            "queryType": 1,
                                            "resourceType": "microsoft.resourcegraph/resources"
                                          }
                                        ],
                                        "style": "pills",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resourcegraph/resources"
                                      },
                                      "customWidth": "25",
                                      "conditionalVisibility": {
                                        "parameterName": "taggedVMs",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "param-IaaS-tagged"
                                    },
                                    {
                                      "type": 11,
                                      "content": {
                                        "version": "LinkItem/1.0",
                                        "style": "paragraph",
                                        "links": [
                                          {
                                            "id": "36b65f94-1c3d-4e7a-b771-677a2081d288",
                                            "cellValue": "",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Remove Monitoring for {PackTagsLeft} Pack(s)",
                                            "preText": "",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [
                                                {
                                                  "key": "action",
                                                  "value": "removeTag"
                                                }
                                              ],
                                              "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"RemoveTag\",\n    \"Resources\": [{taggedVMs}],\n    \"Pack\": \"{PackTagsLeft}\",\n    \"PackType\": \"IaaS\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Remove Monitoring",
                                              "description": "# Please confirm the change.\n\nRemove Monitoring for {PackTagsLeft} Pack(s) \n\nServers:\n\n{taggedVMs}",
                                              "runLabel": "Confirm"
                                            }
                                          },
                                          {
                                            "id": "550df977-06a8-4c40-9cd3-aba6286ebcdf",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Add Monitoring for {PackTagsLeft} Pack(s)",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddTag\",\n    \"Resources\": [{taggedVMs}],\n    \"Pack\": \"{PackTagsLeft}\",\n    \"PackType\": \"IaaS\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Add Monitoring",
                                              "description": "# Please confirm the change.\n\nAdd Monitoring for {PackTagsLeft} Pack(s)",
                                              "actionName": "AddMonitoringPack",
                                              "runLabel": "Confirm"
                                            }
                                          },
                                          {
                                            "id": "3b1af630-47ab-43e9-a5b2-d2f2e21880d0",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Remove All Monitoring for VM",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"RemoveTag\",\n    \"Resources\": [{taggedVMs}],\n    \"Pack\": \"All\",\n    \"PackType\": \"IaaS\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Remove All Monitoring",
                                              "description": "# Please confirm the change.\n\nRemove All Monitoring for {PackTagsLeft} Pack(s)",
                                              "actionName": "RemoveAllMonitoring",
                                              "runLabel": "Confirm"
                                            }
                                          }
                                        ]
                                      },
                                      "customWidth": "75",
                                      "conditionalVisibility": {
                                        "parameterName": "taggedVMs",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "links - 1"
                                    }
                                  ],
                                  "exportParameters": true
                                },
                                "customWidth": "50",
                                "conditionalVisibility": {
                                  "parameterName": "tabSelection",
                                  "comparison": "isEqualTo",
                                  "value": "discovery"
                                },
                                "name": "TaggedGroup"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources | where type =~ 'microsoft.hybridcompute/machines' | where isempty(tolower(tags.MonitorStarterPacks))\n| project Resource=id,['Resource Group']=resourceGroup, OS=properties.osType, subscriptionId, Location=location\n| union (resources | where type =~ 'microsoft.compute/virtualmachines' \n| where isempty(tolower(tags.MonitorStarterPacks)) \n| project Resource=id,['Resource Group']=resourceGroup, OS=properties.storageProfile.osDisk.osType, subscriptionId, Location=location)\n| union (resources | where type =~ 'microsoft.compute/virtualmachinescalesets' and properties.orchestrationMode == 'Uniform'\n| where isempty(tolower(tags.MonitorStarterPacks)) \n| project Resource=id,['Resource Group']=resourceGroup, OS=properties.virtualMachineProfile.storageProfile.osDisk.osType, subscriptionId, Location=location)\n| join kind= leftouter  (\n    resourcecontainers| where type =~ 'microsoft.resources/subscriptions'\n    | project Subscription=name,subscriptionId\n    ) \non subscriptionId| project-away subscriptionId, subscriptionId1",
                                        "size": 0,
                                        "title": "Non-monitored Machines",
                                        "exportMultipleValues": true,
                                        "exportedParameters": [
                                          {
                                            "parameterName": "vmstotag",
                                            "parameterType": 1,
                                            "quote": ""
                                          }
                                        ],
                                        "showExportToExcel": true,
                                        "exportToExcelOptions": "all",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resourcegraph/resources",
                                        "crossComponentResources": [
                                          "{Subscriptions}"
                                        ],
                                        "visualization": "table",
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "OS",
                                              "formatter": 1
                                            }
                                          ],
                                          "filter": true,
                                          "sortBy": [
                                            {
                                              "itemKey": "$gen_link_Resource_0",
                                              "sortOrder": 1
                                            }
                                          ]
                                        },
                                        "sortBy": [
                                          {
                                            "itemKey": "$gen_link_Resource_0",
                                            "sortOrder": 1
                                          }
                                        ]
                                      },
                                      "name": "Non Monitores Servers",
                                      "styleSettings": {
                                        "margin": "400",
                                        "padding": "400",
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 9,
                                      "content": {
                                        "version": "KqlParameterItem/1.0",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "parameters": [
                                          {
                                            "id": "8a177eab-edac-41cc-84f9-a5b7de931bea",
                                            "version": "KqlParameterItem/1.0",
                                            "name": "PackTags",
                                            "label": "Select Pack to Enable",
                                            "type": 2,
                                            "isGlobal": true,
                                            "multiSelect": true,
                                            "quote": "",
                                            "delimiter": ",",
                                            "query": "resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| where isnotempty(tags.MonitorStarterPacks) and tags.MonitoringPackType=='IaaS'\n| project MPs=tostring(tags.MonitorStarterPacks)\n| summarize by MPs",
                                            "crossComponentResources": [
                                              "value::tenant"
                                            ],
                                            "typeSettings": {
                                              "additionalResourceOptions": [],
                                              "showDefault": false
                                            },
                                            "timeContext": {
                                              "durationMs": 86400000
                                            },
                                            "queryType": 1,
                                            "resourceType": "microsoft.resources/tenants",
                                            "value": [
                                              "InsightsDep",
                                              "Nginx"
                                            ]
                                          }
                                        ],
                                        "style": "pills",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants"
                                      },
                                      "customWidth": "50",
                                      "conditionalVisibility": {
                                        "parameterName": "vmstotag",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "param-IaaS-vmstotag"
                                    },
                                    {
                                      "type": 11,
                                      "content": {
                                        "version": "LinkItem/1.0",
                                        "style": "paragraph",
                                        "links": [
                                          {
                                            "id": "91fb0fed-0e4f-41ce-9024-98a3cc4432a7",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Enable Monitoring for {PackTags} Pack",
                                            "preText": "",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [
                                                {
                                                  "key": "action",
                                                  "value": "addTag"
                                                }
                                              ],
                                              "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddTag\",\n    \"Resources\": [{vmstotag}],\n    \"Pack\": \"{PackTags}\",\n    \"PackType\": \"IaaS\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Enable Monitoring Packs",
                                              "description": "# This will enable the pack for the following servers:\n{vmstotag}\n\nby adding the {PackTags} Pack(s) to the resource(s).",
                                              "actionName": "EnableMonitoring",
                                              "runLabel": "Confirm"
                                            }
                                          }
                                        ]
                                      },
                                      "customWidth": "50",
                                      "conditionalVisibility": {
                                        "parameterName": "vmstotag",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "links - 1 - Copy"
                                    }
                                  ],
                                  "exportParameters": true
                                },
                                "customWidth": "50",
                                "conditionalVisibility": {
                                  "parameterName": "tabSelection",
                                  "comparison": "isEqualTo",
                                  "value": "discovery"
                                },
                                "name": "NonTaggedGroup"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "discovery"
                          },
                          "name": "Servers",
                          "styleSettings": {
                            "showBorder": true
                          }
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "title": "Azure Services",
                            "items": [
                              {
                                "type": 1,
                                "content": {
                                  "json": "## Services Monitoring Setup\n\nSelect service on the right to assign a pack. Once the backend is done with the assigning, the service will show on the left side grid.\n\nOn the left side grid, the monitoring can be updated to remove a specific pack from the service.",
                                  "style": "info"
                                },
                                "conditionalVisibility": {
                                  "parameterName": "showHelp",
                                  "comparison": "isEqualTo",
                                  "value": "yes"
                                },
                                "name": "text - Monitoring - PaaS"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 9,
                                      "content": {
                                        "version": "KqlParameterItem/1.0",
                                        "parameters": [
                                          {
                                            "id": "69e06557-55cc-490c-86d2-892d7817b729",
                                            "version": "KqlParameterItem/1.0",
                                            "name": "SelectPaasType",
                                            "label": "Select Service Type(s)",
                                            "type": 7,
                                            "multiSelect": true,
                                            "quote": "'",
                                            "delimiter": ",",
                                            "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getSupportedServices\",\"contentType\":\"text/plain\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*\",\"columns\":[]}}]}",
                                            "typeSettings": {
                                              "additionalResourceOptions": [
                                                "value::all"
                                              ],
                                              "showDefault": false
                                            },
                                            "timeContext": {
                                              "durationMs": 86400000
                                            },
                                            "queryType": 10,
                                            "value": [
                                              "value::all"
                                            ]
                                          }
                                        ],
                                        "style": "above",
                                        "queryType": 10
                                      },
                                      "name": "parameters - service type tagged"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getMonitoredPaaS\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"resourceFilter\",\"value\":\"{SelectPaasType}\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*\",\"columns\":[{\"path\":\"$.Resource\",\"columnid\":\"Resource\"},{\"path\":\"$.type\",\"columnid\":\"Type\"},{\"path\":\"$.tag\",\"columnid\":\"tag\"},{\"path\":\"$.AlertRules\",\"columnid\":\"AlertRules\"},{\"path\":\"$.resourceGroup\",\"columnid\":\"resourceGroup\"},{\"path\":\"$.kind\",\"columnid\":\"kind\"}]}}]}",
                                        "size": 0,
                                        "title": "Monitored Services",
                                        "exportMultipleValues": true,
                                        "exportedParameters": [
                                          {
                                            "parameterName": "taggedPaaS",
                                            "parameterType": 1,
                                            "quote": ""
                                          },
                                          {
                                            "fieldName": "tag",
                                            "parameterName": "PaaSLeftTagsOnly",
                                            "parameterType": 1,
                                            "quote": ""
                                          }
                                        ],
                                        "showExportToExcel": true,
                                        "exportToExcelOptions": "all",
                                        "queryType": 10,
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "AlertRules",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": ">",
                                                    "thresholdValue": "0",
                                                    "representation": "success",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "is Empty",
                                                    "representation": "2",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "warning",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              },
                                              "tooltipFormat": {
                                                "tooltip": "Total number of alerts created by the policies. It can take a while for the alert rules to be created. If still a warning after a day, please check logs."
                                              }
                                            }
                                          ],
                                          "filter": true
                                        }
                                      },
                                      "name": "query - Monitored Services",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 11,
                                      "content": {
                                        "version": "LinkItem/1.0",
                                        "style": "paragraph",
                                        "links": [
                                          {
                                            "id": "36b65f94-1c3d-4e7a-b771-677a2081d288",
                                            "cellValue": "",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Remove Monitoring for {taggedPaaS:$.tag} Pack(s)",
                                            "preText": "",
                                            "postText": "",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [
                                                {
                                                  "key": "action",
                                                  "value": "removeTag"
                                                }
                                              ],
                                              "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"RemoveTag\",\n    \"Resources\": [{taggedPaaS}],\n    \"Pack\": \"{PaaSLeftTagsOnly}\",\n    \"PackType\": \"PaaS\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Remove Monitoring",
                                              "description": "# Please confirm the change.\n\nRemove Monitoring for Pack(s).\n\nResources:\n\n{taggedPaaS:$.Resource}\n\nTags:\n\n{taggedPaaS:$.tag}",
                                              "runLabel": "Confirm"
                                            }
                                          }
                                        ]
                                      },
                                      "customWidth": "75",
                                      "conditionalVisibility": {
                                        "parameterName": "taggedPaaS",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "actionsPaaSLeft"
                                    }
                                  ],
                                  "exportParameters": true
                                },
                                "customWidth": "50",
                                "name": "TaggedGroupPaaS"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 9,
                                      "content": {
                                        "version": "KqlParameterItem/1.0",
                                        "parameters": [
                                          {
                                            "id": "f6a88467-77d9-4e0e-912a-3d7b94aab938",
                                            "version": "KqlParameterItem/1.0",
                                            "name": "SelectPaaStypeToTag",
                                            "label": "Select Service Type",
                                            "type": 7,
                                            "multiSelect": true,
                                            "quote": "'",
                                            "delimiter": ",",
                                            "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getSupportedServices\",\"contentType\":\"text/plain\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*\",\"columns\":[]}}]}",
                                            "typeSettings": {
                                              "additionalResourceOptions": [
                                                "value::all"
                                              ],
                                              "showDefault": false
                                            },
                                            "timeContext": {
                                              "durationMs": 86400000
                                            },
                                            "queryType": 10,
                                            "value": [
                                              "value::all"
                                            ]
                                          }
                                        ],
                                        "style": "above",
                                        "queryType": 10
                                      },
                                      "name": "parameters - service type not tagged"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getNonMonitoredPaaS\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"resourceFilter\",\"value\":\"{SelectPaaStypeToTag}\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*\",\"columns\":[{\"path\":\"$.Resource\",\"columnid\":\"Resource\"},{\"path\":\"$.type\",\"columnid\":\"type\"},{\"path\":\"$.location\",\"columnid\":\"location\"},{\"path\":\"$.resourceGroup\",\"columnid\":\"resourceGroup\"},{\"path\":\"$.kind\",\"columnid\":\"kind\"}]}}]}",
                                        "size": 0,
                                        "title": "Non-Monitored Services",
                                        "exportMultipleValues": true,
                                        "exportedParameters": [
                                          {
                                            "parameterName": "paastotag",
                                            "parameterType": 1,
                                            "quote": ""
                                          },
                                          {
                                            "fieldName": "type",
                                            "parameterName": "passtotagtype",
                                            "parameterType": 1,
                                            "quote": ""
                                          }
                                        ],
                                        "showExportToExcel": true,
                                        "exportToExcelOptions": "all",
                                        "queryType": 10,
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "Total",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": ">=",
                                                    "thresholdValue": "1",
                                                    "representation": "success",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "<",
                                                    "thresholdValue": "1",
                                                    "representation": "2",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "unknown",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              },
                                              "tooltipFormat": {
                                                "tooltip": "Total number of Alerts assigned to this resource."
                                              }
                                            }
                                          ],
                                          "filter": true,
                                          "sortBy": [
                                            {
                                              "itemKey": "type",
                                              "sortOrder": 1
                                            }
                                          ]
                                        },
                                        "sortBy": [
                                          {
                                            "itemKey": "type",
                                            "sortOrder": 1
                                          }
                                        ]
                                      },
                                      "name": "query - nonMonitored Paas - Copy",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 9,
                                      "content": {
                                        "version": "KqlParameterItem/1.0",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "parameters": [
                                          {
                                            "id": "27d8cc17-6eb9-4158-aff2-f5a2bbddff58",
                                            "version": "KqlParameterItem/1.0",
                                            "name": "AvdLAWPaaS",
                                            "label": "Select AVD Log Analytics Workspace",
                                            "type": 5,
                                            "isGlobal": true,
                                            "query": "resources\n| where type =~ \"Microsoft.OperationalInsights/workspaces\"\n",
                                            "crossComponentResources": [
                                              "value::tenant"
                                            ],
                                            "typeSettings": {
                                              "additionalResourceOptions": [],
                                              "showDefault": false
                                            },
                                            "timeContext": {
                                              "durationMs": 86400000
                                            },
                                            "queryType": 1,
                                            "resourceType": "microsoft.resources/tenants"
                                          }
                                        ],
                                        "style": "pills",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants"
                                      },
                                      "customWidth": "50",
                                      "conditionalVisibilities": [
                                        {
                                          "parameterName": "paastotag",
                                          "comparison": "isNotEqualTo"
                                        },
                                        {
                                          "parameterName": "PackTagsPaaS",
                                          "comparison": "isEqualTo",
                                          "value": "Avd"
                                        }
                                      ],
                                      "name": "param-IaaS-AvdLaw"
                                    },
                                    {
                                      "type": 11,
                                      "content": {
                                        "version": "LinkItem/1.0",
                                        "style": "paragraph",
                                        "links": [
                                          {
                                            "id": "91fb0fed-0e4f-41ce-9024-98a3cc4432a7",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Enable Monitoring",
                                            "preText": "",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [
                                                {
                                                  "key": "action",
                                                  "value": "addTag"
                                                }
                                              ],
                                              "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddTag\",\n    \"Resources\": [{paastotag}],\n    \"Pack\": \"{PackTagsPaaS}\",\n    \"PackType\": \"PaaS\",\n    \"Type\": \"{passtotagtype}\",\n    \"DefaultAG\": \"{DefaultAG}\",\n    \"AVDLAW\" : \"{AvdLAWPaaS}\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Enable Monitoring Packs",
                                              "description": "# This will enable the pack for the following services:\n***{paastotag:$.Resource}***\n\nby adding the specific Pack(s) to the resource(s).\n\n_AVD Alternate Log Analytics Workspace (if any):_\n\n{AvdLAWPaaS:name}\n",
                                              "actionName": "EnableMonitoring",
                                              "runLabel": "Confirm"
                                            }
                                          }
                                        ]
                                      },
                                      "customWidth": "50",
                                      "conditionalVisibility": {
                                        "parameterName": "paastotag",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "platformenableparameters"
                                    }
                                  ],
                                  "exportParameters": true
                                },
                                "customWidth": "50",
                                "name": "NonTaggedGroup"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "paas"
                          },
                          "name": "PaaSMgmt",
                          "styleSettings": {
                            "showBorder": true
                          }
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "items": [
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "tabs",
                                  "links": [
                                    {
                                      "id": "355de2ec-11fb-4db8-9813-2e0bf7cdb3d0",
                                      "cellValue": "alertTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Packs' Alerts",
                                      "subTarget": "packs",
                                      "style": "link"
                                    },
                                    {
                                      "id": "d1f8bc9e-5a21-47f3-a2b3-e7fc213e04ee",
                                      "cellValue": "alertTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Other Alerts",
                                      "subTarget": "others",
                                      "style": "link"
                                    }
                                  ]
                                },
                                "name": "links - 18"
                              },
                              {
                                "type": 1,
                                "content": {
                                  "json": "## Alerts Configuration\n\n### Select a pack on the left to visualize the alerts rules related to those packs. Select the Other Alerts tab to visualiza any other alert rule that is not related to the packs.",
                                  "style": "info"
                                },
                                "conditionalVisibility": {
                                  "parameterName": "showHelp",
                                  "comparison": "isEqualTo",
                                  "value": "yes"
                                },
                                "name": "text - Alert - Packs Alerts"
                              },
                              {
                                "type": 9,
                                "content": {
                                  "version": "KqlParameterItem/1.0",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "parameters": [
                                    {
                                      "id": "e99b4870-f7a6-4b8e-95b7-6aaeece1f438",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "AlertPack",
                                      "type": 2,
                                      "query": "resources\n| where tolower(type) in (\"microsoft.insights/scheduledqueryrules\", \"microsoft.insights/metricalerts\",\"microsoft.insights/activitylogalerts\")\n| where isnotempty(tags.MonitorStarterPacks)\n| project MPs=tostring(tags.MonitorStarterPacks)\n| summarize by MPs\n",
                                      "crossComponentResources": [
                                        "value::tenant"
                                      ],
                                      "typeSettings": {
                                        "additionalResourceOptions": [],
                                        "showDefault": false
                                      },
                                      "timeContext": {
                                        "durationMs": 86400000
                                      },
                                      "queryType": 1,
                                      "resourceType": "microsoft.resources/tenants",
                                      "value": null
                                    }
                                  ],
                                  "style": "pills",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants"
                                },
                                "conditionalVisibility": {
                                  "parameterName": "alertTab",
                                  "comparison": "isEqualTo",
                                  "value": "packs"
                                },
                                "name": "param-alerts-toAction"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "resources\n| where tolower(type) in (\"microsoft.insights/scheduledqueryrules\")\n| where isnotempty(tags.MonitorStarterPacks)\n| project id,MP=tags.MonitorStarterPacks, Enabled=properties.enabled, Description=properties.description, ['Action Group']=split(properties.actions.actionGroups[0],\"/\")[8], location, Target=split(properties.scopes[0],\"/\")[-1]\n| union (\nresources\n| where tolower(type) in (\"microsoft.insights/metricalerts\")\n| where isnotempty(tags.MonitorStarterPacks)\n| project id,MP=tags.MonitorStarterPacks, Enabled=properties.enabled, Description=properties.description, ['Action Group']=split(properties.actions[0].actionGroupId,\"/\")[8], location, Target=split(properties.scopes[0],\"/\")[-1])\n| union (resources\n| where tolower(type) in (\"microsoft.insights/activitylogalerts\")\n| where isnotempty(tags.MonitorStarterPacks)\n| project id,MP=tags.MonitorStarterPacks, Enabled=properties.enabled, Description=properties.description, ['Action Group']=split(properties.actions.actionGroups[0].actionGroupId,\"/\")[8], location, Target=split(properties.scopes[0],\"/\")[-1])\n| where MP=='{AlertPack}'",
                                  "size": 0,
                                  "exportMultipleValues": true,
                                  "exportedParameters": [
                                    {
                                      "fieldName": "",
                                      "parameterName": "alertsselected",
                                      "parameterType": 1,
                                      "quote": ""
                                    }
                                  ],
                                  "showExportToExcel": true,
                                  "exportToExcelOptions": "all",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "visualization": "table",
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "location",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "name",
                                        "formatter": 7
                                      }
                                    ],
                                    "filter": true
                                  }
                                },
                                "customWidth": "70",
                                "conditionalVisibility": {
                                  "parameterName": "alertTab",
                                  "comparison": "isEqualTo",
                                  "value": "packs"
                                },
                                "name": "AlertConfigQuery",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 1,
                                      "content": {
                                        "json": "# Enable or Disable alerts. \n\n## By selecting a list of alerts on the left, the buttons will disable or enable the alert rules in Azure Monitor.\n\n# Update Action Group\n## Select a list of alerts on the left and a new Action Group to assign to the alert.\n\n# Delete Alert rules\n## Select a list of alert rules to be deleted.",
                                        "style": "info"
                                      },
                                      "conditionalVisibility": {
                                        "parameterName": "showHelp",
                                        "comparison": "isEqualTo",
                                        "value": "yes"
                                      },
                                      "name": "AlertMgmtHelpText"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources\n| where type == \"microsoft.insights/actiongroups\"\n| where properties.enabled == 'true'\n| project id, emailReceivers=strcat(properties.emailReceivers[0].name,\"(\",properties.emailReceivers[0].emailAddress,\")\")",
                                        "size": 1,
                                        "exportFieldName": "",
                                        "exportParameterName": "selectedAG",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "id",
                                              "formatter": 13,
                                              "formatOptions": {
                                                "linkTarget": "OpenBlade",
                                                "linkIsContextBlade": true,
                                                "showIcon": true
                                              }
                                            }
                                          ],
                                          "filter": true
                                        }
                                      },
                                      "conditionalVisibility": {
                                        "parameterName": "alertsselected",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "ActionGroupsQuery",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 11,
                                      "content": {
                                        "version": "LinkItem/1.0",
                                        "style": "paragraph",
                                        "links": [
                                          {
                                            "id": "f5cb3ede-91d1-4414-bfa1-a1689f45d0c8",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Enable Alerts",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Enable\", \n    \"alerts\":  [{alertsselected}]\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Enable Alerts",
                                              "description": "# This action will Enable the selected Alerts\n\n{alertsselected}",
                                              "runLabel": "Confirm"
                                            }
                                          },
                                          {
                                            "id": "d9469141-a104-4696-b9cd-f0fc7e3f963e",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Disable Alerts",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Disable\", \n    \"alerts\":  [{alertsselected}]\n  }\n}\n",
                                              "httpMethod": "POST",
                                              "title": "Disable Alerts",
                                              "description": "# This action will disable the selected Alerts\n\n{alertsselected}",
                                              "runLabel": "Confirm"
                                            }
                                          },
                                          {
                                            "id": "7942ba17-4942-4f4a-b2ea-e19ad806b49d",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Update Action Group",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Update\", \n    \"alerts\":  [{alertsselected}],\n    \"aGroup\": {selectedAG}\n  }\n}\n",
                                              "httpMethod": "POST",
                                              "title": "Update Action Group",
                                              "description": "Updating alerts:\n\n\n{alertsselected}\n\nwith Action Group:\n\n{selectedAG}\n",
                                              "actionName": "updateAG",
                                              "runLabel": "Update"
                                            }
                                          },
                                          {
                                            "id": "f802b903-8a8a-458d-9c55-a428d96ba63d",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Delete Alert Rule",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Delete\", \n    \"alerts\":  [{alertsselected}]\n  }\n}\n",
                                              "httpMethod": "POST",
                                              "title": "Delete",
                                              "description": "# Deleting Alerts\n\nThe following alert rules will be deleted:\n\n{alertsselected}",
                                              "actionName": "Delete",
                                              "runLabel": "Delete"
                                            }
                                          }
                                        ]
                                      },
                                      "name": "links - 8"
                                    }
                                  ]
                                },
                                "customWidth": "30",
                                "conditionalVisibility": {
                                  "parameterName": "alertTab",
                                  "comparison": "isEqualTo",
                                  "value": "packs"
                                },
                                "name": "AlertsSubGroup1"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "title": "Alert Management - Other Alerts",
                                  "items": [
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources\n| where tolower(type) in (\"microsoft.insights/scheduledqueryrules\")\n| where isempty(tags.MonitorStarterPacks)\n| project id,Enabled=properties.enabled, Description=properties.description, ['Action Group']=split(properties.actions.actionGroups[0],\"/\")[8], location, Target=split(properties.scopes[0],\"/\")[-1]\n| union (\nresources\n| where tolower(type) in (\"microsoft.insights/metricalerts\")\n| where isempty(tags.MonitorStarterPacks)\n| project id, Enabled=properties.enabled, Description=properties.description, ['Action Group']=split(properties.actions[0].actionGroupId,\"/\")[8], location, Target=split(properties.scopes[0],\"/\")[-1])\n| union (resources\n| where tolower(type) in (\"microsoft.insights/activitylogalerts\")\n| where isempty(tags.MonitorStarterPacks)\n| project id,Enabled=properties.enabled, Description=properties.description, ['Action Group']=split(properties.actions.actionGroups[0].actionGroupId,\"/\")[8], location, Target=split(properties.scopes[0],\"/\")[-1])",
                                        "size": 0,
                                        "exportMultipleValues": true,
                                        "exportedParameters": [
                                          {
                                            "fieldName": "",
                                            "parameterName": "alertsselectednopack",
                                            "parameterType": 1,
                                            "quote": ""
                                          }
                                        ],
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "visualization": "table",
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "location",
                                              "formatter": 5
                                            },
                                            {
                                              "columnMatch": "name",
                                              "formatter": 7
                                            }
                                          ],
                                          "filter": true,
                                          "sortBy": [
                                            {
                                              "itemKey": "$gen_link_Enabled_1",
                                              "sortOrder": 1
                                            }
                                          ]
                                        },
                                        "sortBy": [
                                          {
                                            "itemKey": "$gen_link_Enabled_1",
                                            "sortOrder": 1
                                          }
                                        ]
                                      },
                                      "customWidth": "70",
                                      "name": "queryOtherAlerts",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 12,
                                      "content": {
                                        "version": "NotebookGroup/1.0",
                                        "groupType": "editable",
                                        "items": [
                                          {
                                            "type": 1,
                                            "content": {
                                              "json": "# Enable or Disable alerts. \n\n## By selecting a list of alerts on the left, the buttons will disable or enable the alert rules in Azure Monitor.\n\n# Update Action Group\n## Select a list of alerts on the left and a new Action Group to assign to the alert.",
                                              "style": "info"
                                            },
                                            "conditionalVisibility": {
                                              "parameterName": "showHelp",
                                              "comparison": "isEqualTo",
                                              "value": "yes"
                                            },
                                            "name": "text - 3"
                                          },
                                          {
                                            "type": 3,
                                            "content": {
                                              "version": "KqlItem/1.0",
                                              "query": "resources\n| where type == \"microsoft.insights/actiongroups\"\n| where properties.enabled == 'true'\n| project id, emailReceivers=strcat(properties.emailReceivers[0].name,\"(\",properties.emailReceivers[0].emailAddress,\")\")",
                                              "size": 1,
                                              "exportFieldName": "",
                                              "exportParameterName": "selectedAG",
                                              "queryType": 1,
                                              "resourceType": "microsoft.resourcegraph/resources",
                                              "gridSettings": {
                                                "filter": true
                                              }
                                            },
                                            "name": "agQuery2",
                                            "styleSettings": {
                                              "showBorder": true
                                            }
                                          },
                                          {
                                            "type": 11,
                                            "content": {
                                              "version": "LinkItem/1.0",
                                              "style": "paragraph",
                                              "links": [
                                                {
                                                  "id": "f5cb3ede-91d1-4414-bfa1-a1689f45d0c8",
                                                  "linkTarget": "ArmAction",
                                                  "linkLabel": "Enable Alerts",
                                                  "style": "primary",
                                                  "linkIsContextBlade": true,
                                                  "armActionContext": {
                                                    "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                                    "headers": [],
                                                    "params": [],
                                                    "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Enable\", \n    \"alerts\":  [{alertsselectednopack}]\n  }\n}",
                                                    "httpMethod": "POST",
                                                    "title": "Enable Alerts",
                                                    "description": "# This action will Enable the selected Alerts\n\n{alertsselected}",
                                                    "runLabel": "Confirm"
                                                  }
                                                },
                                                {
                                                  "id": "d9469141-a104-4696-b9cd-f0fc7e3f963e",
                                                  "linkTarget": "ArmAction",
                                                  "linkLabel": "Disable Alerts",
                                                  "style": "primary",
                                                  "linkIsContextBlade": true,
                                                  "armActionContext": {
                                                    "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                                    "headers": [],
                                                    "params": [],
                                                    "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Disable\", \n    \"alerts\":  [{alertsselectednopack}]\n  }\n}\n",
                                                    "httpMethod": "POST",
                                                    "title": "Disable Alerts",
                                                    "description": "# This action will disable the selected Alerts\n\n{alertsselected}",
                                                    "runLabel": "Confirm"
                                                  }
                                                },
                                                {
                                                  "id": "7942ba17-4942-4f4a-b2ea-e19ad806b49d",
                                                  "linkTarget": "ArmAction",
                                                  "linkLabel": "Update Action Group",
                                                  "style": "primary",
                                                  "linkIsContextBlade": true,
                                                  "armActionContext": {
                                                    "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                                    "headers": [],
                                                    "params": [],
                                                    "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Update\", \n    \"alerts\":  [{alertsselectednopack}],\n    \"aGroup\": {selectedAG}\n  }\n}\n",
                                                    "httpMethod": "POST",
                                                    "title": "Update Action Group",
                                                    "description": "Updating alerts:\n\n\n{alertsselected}\n\nwith Action Group:\n\n{selectedAG}\n",
                                                    "actionName": "updateAG",
                                                    "runLabel": "Update"
                                                  }
                                                },
                                                {
                                                  "id": "eb46862a-b443-489e-a2bf-abc05c541b53",
                                                  "linkTarget": "ArmAction",
                                                  "linkLabel": "Delete Alert Rule",
                                                  "style": "primary",
                                                  "linkIsContextBlade": true,
                                                  "armActionContext": {
                                                    "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                                    "headers": [],
                                                    "params": [],
                                                    "body": "{ \n  \"function\": \"alertmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"Delete\", \n    \"alerts\":  [{alertsselectednopack}]\n  }\n}\n",
                                                    "httpMethod": "POST",
                                                    "title": "Delete",
                                                    "description": "# Deleting the following Alert rules:\n\n\n{alertsselectednopack}]\n",
                                                    "actionName": "Delete",
                                                    "runLabel": "Delete"
                                                  }
                                                }
                                              ]
                                            },
                                            "name": "links - 8"
                                          }
                                        ]
                                      },
                                      "customWidth": "30",
                                      "conditionalVisibility": {
                                        "parameterName": "alertsselectednopack",
                                        "comparison": "isNotEqualTo"
                                      },
                                      "name": "AlertsSubGroup1"
                                    }
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "alertTab",
                                  "comparison": "isEqualTo",
                                  "value": "others"
                                },
                                "name": "AlertMGMT - Others"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "alertmanagement"
                          },
                          "name": "AlertMGMT"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "items": [
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "tabs",
                                  "links": [
                                    {
                                      "id": "13be6531-5163-4697-b6bd-cb7381b15d65",
                                      "cellValue": "packsTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "IaaS Packs Associtation",
                                      "subTarget": "associations",
                                      "preText": "Iaas",
                                      "style": "link"
                                    },
                                    {
                                      "id": "82684c12-244f-4488-9223-da3e48a6206f",
                                      "cellValue": "packsTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "DCR Details",
                                      "subTarget": "dcrdetails",
                                      "style": "link"
                                    },
                                    {
                                      "id": "0f666555-5e2a-4eb9-bd6c-cef1365a6ce9",
                                      "cellValue": "packsTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "VMInsights Status",
                                      "subTarget": "vmistatus",
                                      "style": "link"
                                    }
                                  ]
                                },
                                "name": "links - 2"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "title": "VMInsights Status",
                                  "items": [
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources\n| where ['type'] =~ 'microsoft.insights/datacollectionrules'\n| mv-expand datasources=properties.dataSources.performanceCounters\n| where isnotnull(datasources)\n| mv-expand  cs=datasources.counterSpecifiers //=~ '\\\\VmInsights\\\\DetailedMetrics'\n| where cs =~'\\\\VmInsights\\\\DetailedMetrics'\n| join kind=inner  (insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| where isnotnull(properties.dataCollectionRuleId)\n| extend sourceResourceId=tostring(split(id,'/providers/Microsoft.Insights/')[0])\n| extend serverName=tostring(sourceResourceId), dataCollectionRuleId=tostring(properties.dataCollectionRuleId)) on $left.id == $right.dataCollectionRuleId\n| project serverName=sourceResourceId, name\n| summarize VMInsightsAssociations=count(name) by ['Server Name']=serverName \n",
                                        "size": 1,
                                        "title": "Servers and DCR associations",
                                        "exportFieldName": "Server Name",
                                        "exportParameterName": "vmiSelectedServer",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "VMInsightsAssociations",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": ">",
                                                    "thresholdValue": "1",
                                                    "representation": "2",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "success",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              },
                                              "tooltipFormat": {
                                                "tooltip": "If more than one VMInsights association is found, there may be data duplication to one or more Log Analytics workspaces."
                                              }
                                            }
                                          ],
                                          "filter": true,
                                          "sortBy": [
                                            {
                                              "itemKey": "$gen_thresholds_VMInsightsAssociations_1",
                                              "sortOrder": 2
                                            }
                                          ]
                                        },
                                        "sortBy": [
                                          {
                                            "itemKey": "$gen_thresholds_VMInsightsAssociations_1",
                                            "sortOrder": 2
                                          }
                                        ]
                                      },
                                      "customWidth": "50",
                                      "name": "query - 3",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources\n| where ['type'] =~ 'microsoft.insights/datacollectionrules'\n| mv-expand datasources=properties.dataSources.performanceCounters\n| where isnotnull(datasources)\n| mv-expand  cs=datasources.counterSpecifiers //=~ '\\\\VmInsights\\\\DetailedMetrics'\n| where cs =~'\\\\VmInsights\\\\DetailedMetrics'\n| join kind=leftouter   (insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| where isnotnull(properties.dataCollectionRuleId)\n| extend sourceResourceId=tostring(split(id,'/providers/Microsoft.Insights/')[0])\n| extend serverName=tostring(split(sourceResourceId,'/')[8]), dataCollectionRuleId=tostring(properties.dataCollectionRuleId)) on $left.id == $right.dataCollectionRuleId\n| where sourceResourceId=~'{vmiSelectedServer}'\n| summarize by DCRId=dataCollectionRuleId\n",
                                        "size": 1,
                                        "title": "Details for {vmiSelectedServer}",
                                        "exportFieldName": "DCR",
                                        "exportParameterName": "vmiSelectedDCR",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "VMInsightsAssociations",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": ">",
                                                    "thresholdValue": "1",
                                                    "representation": "2",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "success",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              },
                                              "tooltipFormat": {
                                                "tooltip": "If more than one VMInsights association is found, there may be data duplication to one or more Log Analytics workspaces."
                                              }
                                            }
                                          ],
                                          "filter": true
                                        },
                                        "sortBy": []
                                      },
                                      "customWidth": "50",
                                      "name": "query - VM Insights per DCR",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources\n| where ['type'] =~ 'microsoft.insights/datacollectionrules'\n| mv-expand datasources=properties.dataSources.performanceCounters\n| where isnotnull(datasources)\n| mv-expand  cs=datasources.counterSpecifiers //=~ '\\\\VmInsights\\\\DetailedMetrics'\n| where cs =~'\\\\VmInsights\\\\DetailedMetrics'\n| join kind=inner   (insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| where isnotnull(properties.dataCollectionRuleId)\n| extend sourceResourceId=tostring(split(id,'/providers/Microsoft.Insights/')[0])\n| extend serverName=tostring(split(sourceResourceId,'/')[8]), dataCollectionRuleId=tostring(properties.dataCollectionRuleId)) on $left.id == $right.dataCollectionRuleId\n| project serverName, dataCollectionRuleId\n| summarize Servers=count(serverName) by DCRId=dataCollectionRuleId\n",
                                        "size": 1,
                                        "title": "VMInsights DCRs and Servers",
                                        "exportFieldName": "DCRId",
                                        "exportParameterName": "VMIdataCollectionRuleId",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "dataCollectionRuleId",
                                              "formatter": 13,
                                              "formatOptions": {
                                                "linkTarget": "Resource",
                                                "linkIsContextBlade": true,
                                                "showIcon": true
                                              }
                                            }
                                          ],
                                          "filter": true
                                        }
                                      },
                                      "customWidth": "50",
                                      "name": "query - VMInsight rules details",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources\n| where ['type'] =~ 'microsoft.insights/datacollectionrules'\n| mv-expand datasources=properties.dataSources.performanceCounters\n| where isnotnull(datasources)\n| mv-expand  cs=datasources.counterSpecifiers //=~ '\\\\VmInsights\\\\DetailedMetrics'\n| where cs =~'\\\\VmInsights\\\\DetailedMetrics'\n| join kind=leftouter   (insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| where isnotnull(properties.dataCollectionRuleId)\n| extend sourceResourceId=tostring(split(id,'/providers/Microsoft.Insights/')[0])\n| extend serverName=tostring(split(sourceResourceId,'/')[8]), dataCollectionRuleId=tostring(properties.dataCollectionRuleId)) on $left.id == $right.dataCollectionRuleId\n| where dataCollectionRuleId=='{VMIdataCollectionRuleId}'\n| project ['Server Name']=sourceResourceId\n\n",
                                        "size": 1,
                                        "title": "Associated Servers",
                                        "exportFieldName": "DCR",
                                        "exportParameterName": "vmiSelectedDCR",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "VMInsightsAssociations",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": ">",
                                                    "thresholdValue": "1",
                                                    "representation": "2",
                                                    "text": "{0}{1}"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "success",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              },
                                              "tooltipFormat": {
                                                "tooltip": "If more than one VMInsights association is found, there may be data duplication to one or more Log Analytics workspaces."
                                              }
                                            }
                                          ],
                                          "filter": true
                                        },
                                        "sortBy": []
                                      },
                                      "customWidth": "50",
                                      "name": "query - VM Insights per DCR - Copy",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    }
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "packsTab",
                                  "comparison": "isEqualTo",
                                  "value": "vmistatus"
                                },
                                "name": "group - VMInsights status"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "title": "IaaS Packs Association",
                                  "items": [
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isnotempty(MPs) //or properties.dataSources.performanceCounters[0].name == 'VMInsightsPerfCounters'\n| summarize by Pack=MPs,rulename=tostring(name)\n| join (insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| extend resourceId=split(id,'/providers/Microsoft.Insights/')[0]\n| where isnotnull(properties.dataCollectionRuleId)\n| project rulename=tostring(split(properties.dataCollectionRuleId,\"/\")[8]),resourceName=tostring(split(resourceId,\"/\")[8]),resourceId//ruleId=properties.dataCollectionRuleId\n) on rulename\n| project-away rulename1,resourceId\n| summarize Associated=count() by Pack, rulename\n| order by Pack asc",
                                        "size": 0,
                                        "title": "Select Pack to see associated Machines",
                                        "exportFieldName": "rulename",
                                        "exportParameterName": "selectedRule",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "Group",
                                              "formatter": 1
                                            }
                                          ],
                                          "filter": true
                                        },
                                        "sortBy": []
                                      },
                                      "customWidth": "50",
                                      "name": "query - 6 - Copy",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| extend resourceId=split(id,'/providers/Microsoft.Insights/')[0]\n| where isnotnull(properties.dataCollectionRuleId)\n| project rulename=split(properties.dataCollectionRuleId,\"/\")[8],resourceName=split(resourceId,\"/\")[8],resourceId//ruleId=properties.dataCollectionRuleId\n| where '{selectedRule}'==rulename",
                                        "size": 0,
                                        "title": "Associated Machines",
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "Group",
                                              "formatter": 1
                                            }
                                          ],
                                          "filter": true
                                        }
                                      },
                                      "customWidth": "50",
                                      "name": "query - 6 - Copy - Copy",
                                      "styleSettings": {
                                        "showBorder": true
                                      }
                                    }
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "packsTab",
                                  "comparison": "isEqualTo",
                                  "value": "associations"
                                },
                                "name": "rulemanagement",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| where isnotempty(tags.MonitorStarterPacks)\n| extend ds=properties.dataSources\n| project id,Type=kind, location,syslog=ds.syslog[0].streams[0], windowsEventLogs=ds.windowsEventLogs[0].streams[0], logsettings=ds.logFiles, performanceCounters=ds.performanceCounters[0].streams[0],provisioningState=properties.provisioningState, \ndataCollectionEndpointId=properties.dataCollectionEndpointId,transformKql=properties.dataFlows[0].transformKql,workspaceResourceId=properties.destinations.logAnalytics[0].workspaceResourceId\n",
                                  "size": 0,
                                  "title": "List of Currently Configured Data Collection Rules",
                                  "showRefreshButton": true,
                                  "exportedParameters": [
                                    {
                                      "parameterName": "selectedRule"
                                    },
                                    {
                                      "fieldName": "destinationName",
                                      "parameterName": "destinationName",
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "",
                                      "parameterName": "resourceGroupName",
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "workspaceResourceId",
                                      "parameterName": "workspace",
                                      "parameterType": 5
                                    },
                                    {
                                      "fieldName": "properties",
                                      "parameterName": "properties",
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "name",
                                      "parameterName": "name",
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "location",
                                      "parameterName": "location",
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "Rule Type",
                                      "parameterName": "kind",
                                      "parameterType": 1
                                    },
                                    {
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "id",
                                      "parameterName": "id",
                                      "parameterType": 1
                                    }
                                  ],
                                  "showExportToExcel": true,
                                  "exportToExcelOptions": "all",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resourcegraph/resources",
                                  "crossComponentResources": [
                                    "{Subscriptions}"
                                  ],
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "id",
                                        "formatter": 13,
                                        "formatOptions": {
                                          "linkColumn": "id",
                                          "linkTarget": "Resource",
                                          "linkIsContextBlade": true,
                                          "showIcon": true
                                        }
                                      },
                                      {
                                        "columnMatch": "Type",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "Windows",
                                              "representation": "Initial_Access",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "Linux",
                                              "representation": "Console",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "Capture",
                                              "text": "Custom"
                                            }
                                          ]
                                        }
                                      },
                                      {
                                        "columnMatch": "location",
                                        "formatter": 17,
                                        "formatOptions": {
                                          "customColumnWidthSetting": "94px"
                                        }
                                      },
                                      {
                                        "columnMatch": "syslog",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "CellDetails",
                                          "subTarget": "2",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "cancelled",
                                              "text": "Not Configured"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "Configured"
                                            }
                                          ],
                                          "bladeOpenContext": {
                                            "bladeName": "DataCollectionRulesDataSourceManagementViewModel",
                                            "extensionName": "Microsoft_Azure_Monitoring",
                                            "bladeParameters": [
                                              {
                                                "name": "id",
                                                "source": "column",
                                                "value": "id"
                                              }
                                            ]
                                          },
                                          "customColumnWidthSetting": "20ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "windowsEventLogs",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "CellDetails",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "cancelled",
                                              "text": "Not Configured"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "Configured"
                                            }
                                          ],
                                          "customColumnWidthSetting": "20ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "logsettings",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "cancelled",
                                              "text": "Not Configured"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "Configured"
                                            }
                                          ],
                                          "customColumnWidthSetting": "20ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "performanceCounters",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkColumn": "performanceCounters",
                                          "linkTarget": "CellDetails",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "cancelled",
                                              "text": "Not Configured!"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "Configured"
                                            }
                                          ],
                                          "customColumnWidthSetting": "20ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "provisioningState",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "contains",
                                              "thresholdValue": "succeeded",
                                              "representation": "success",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "{0}{1}"
                                            }
                                          ],
                                          "customColumnWidthSetting": "17ch"
                                        },
                                        "numberFormat": {
                                          "unit": 0,
                                          "options": {
                                            "style": "decimal"
                                          }
                                        }
                                      },
                                      {
                                        "columnMatch": "dataCollectionEndpointId",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "Resource",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "cancelled",
                                              "text": "Not Configured"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "Configured"
                                            }
                                          ],
                                          "customColumnWidthSetting": "21.7143ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "transformKql",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkColumn": "queries",
                                          "linkTarget": "CellDetails",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "stopped",
                                              "text": "Not Configured"
                                            },
                                            {
                                              "operator": "contains",
                                              "thresholdValue": "|",
                                              "representation": "success",
                                              "text": "Ingestion KQL"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "stopped",
                                              "text": "Custom KQL"
                                            }
                                          ],
                                          "bladeOpenContext": {
                                            "bladeName": "CreateMicrosoftTableTransformBlade",
                                            "extensionName": "Microsoft_OperationsManagementSuite_Workspace",
                                            "bladeJsonParameters": "{\r\n\t\"workspaceResourceId\" : \"{workspace}\",\r\n\t\"providers\" : \"microsoft.operationalinsights\",\r\n\t\"table\" : { \r\n\t\t\"name\" : \"{selectedTableName}\",\r\n\t\t\"description\":\"Security events collected from windows machines by Azure Security Center or Azure Sentinel.\",\r\n\t\t\"hasData\":true,\r\n\t\t\"tableType\":\"Microsoft\",\r\n\t\t\"tableAPIState\":\"Any\",\r\n\t\t\"solutions\":[\"Security and Audit\",\"Microsoft Sentinel\"],\r\n\t\t\"categories\":[\"Security\"],\r\n\t\t\"retentionInDaysAsDefault\":false,\r\n\t\t\"totalRetentionInDaysAsDefault\":false,\r\n\t\t\"isEditTransformationEnabled\":true,\r\n\t\t\"isCreateTransformationEnabled\":true\r\n\t},\r\n\t\"isMicrosoftTable\" : true,\r\n\t\"isMigrationRequired\" : false\r\n}"
                                          },
                                          "customColumnWidthSetting": "22ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "workspaceResourceId",
                                        "formatter": 13,
                                        "formatOptions": {
                                          "linkTarget": "Resource",
                                          "showIcon": true,
                                          "customColumnWidthSetting": "16.8571ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "properties",
                                        "formatter": 7,
                                        "formatOptions": {
                                          "linkTarget": "CellDetails",
                                          "linkLabel": "",
                                          "linkIsContextBlade": true,
                                          "customColumnWidthSetting": "5ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "kind",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "Capture",
                                              "text": "{0}{1} Custom"
                                            },
                                            {
                                              "operator": "contains",
                                              "thresholdValue": "Linux",
                                              "representation": "Console",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "contains",
                                              "thresholdValue": "Windows",
                                              "representation": "Initial_Access",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "contains",
                                              "thresholdValue": "WorkspaceTransforms",
                                              "representation": "Persistence",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "{0}{1}"
                                            }
                                          ],
                                          "customColumnWidthSetting": "17ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "name",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "securityEvents",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkColumn": "windowsEventLogs",
                                          "linkTarget": "CellDetails",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "cancelled",
                                              "text": "Not Configured"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "Configured"
                                            }
                                          ],
                                          "customColumnWidthSetting": "20ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "destinations",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "queries",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "dataSources",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "dataFlows",
                                        "formatter": 5,
                                        "formatOptions": {
                                          "aggregation": "Sum"
                                        }
                                      },
                                      {
                                        "columnMatch": "description",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "destinationName",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "lastModifiedBy",
                                        "formatter": 5
                                      },
                                      {
                                        "columnMatch": "customEvents",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "CellDetails",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "cancelled",
                                              "text": "Not Configured"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "Configured"
                                            }
                                          ],
                                          "customColumnWidthSetting": "20ch"
                                        }
                                      },
                                      {
                                        "columnMatch": "StepTab",
                                        "formatter": 5
                                      }
                                    ],
                                    "rowLimit": 1000,
                                    "filter": true
                                  },
                                  "sortBy": []
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "tabSelection",
                                    "comparison": "isEqualTo",
                                    "value": "rulemanagement"
                                  },
                                  {
                                    "parameterName": "packsTab",
                                    "comparison": "isEqualTo",
                                    "value": "dcrdetails"
                                  }
                                ],
                                "name": "Select Existing DCR - Copy",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "rulemanagement"
                          },
                          "name": "packMgmtGroup"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "title": "Policy Assignment Status",
                            "items": [
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "tabs",
                                  "links": [
                                    {
                                      "id": "ec38b692-92dd-405d-9e0c-7fdce860cbd9",
                                      "cellValue": "policyTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Compliance",
                                      "subTarget": "compliance",
                                      "style": "link"
                                    },
                                    {
                                      "id": "fde6131a-93c5-4a3d-a8ee-1509d3546026",
                                      "cellValue": "policyTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Assignment",
                                      "subTarget": "assignment",
                                      "style": "link"
                                    }
                                  ]
                                },
                                "name": "links - 8"
                              },
                              {
                                "type": 1,
                                "content": {
                                  "json": "## Policy Management - Compliance\n\nThis dialog allows to verify the status of the pack policies as well as Remediate the policies.\n\nA background process remediates policies that are not compliant every 6 hours as well.",
                                  "style": "info"
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "showHelp",
                                    "comparison": "isEqualTo",
                                    "value": "yes"
                                  },
                                  {
                                    "parameterName": "policyTab",
                                    "comparison": "isEqualTo",
                                    "value": "compliance"
                                  }
                                ],
                                "name": "text - Policy - Compliance"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "policyresources | where type == \"microsoft.policyinsights/policystates\" | extend policyName=tostring(properties.policyDefinitionName), complianceState=properties.complianceState\n| join (policyresources | where type == \"microsoft.authorization/policydefinitions\" and isnotempty(properties.metadata.MonitorStarterPacks) | project policyId=id, policyName=name, pack=tostring(properties.metadata.MonitorStarterPacks)) on policyName\n| project policyId, policyName, complianceState=tostring(complianceState), pack,type='Policy'\n| union( policyresources\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\n| extend complianceState = tostring(properties.complianceState)\n| extend\n\tresourceId = tostring(properties.resourceId),\n\tpolicyAssignmentId = tostring(properties.policyAssignmentId),\n\tpolicyAssignmentScope = tostring(properties.policyAssignmentScope),\n\tpolicyAssignmentName = tostring(properties.policyAssignmentName),\n\tpolicyDefinitionId = tostring(properties.policyDefinitionId),\n    policySetDefinitionId=tostring(properties.policySetDefinitionId),\n\tpolicyDefinitionReferenceId = tostring(properties.policyDefinitionReferenceId),\n\tstateWeight = iff(complianceState == 'NonCompliant', int(300), iff(complianceState == 'Compliant', int(200), iff(complianceState == 'Conflict', int(100), iff(complianceState == 'Exempt', int(50), int(0)))))\n| summarize max(stateWeight) by resourceId, policyAssignmentId, policyAssignmentScope, policyAssignmentName,policySetDefinitionId\n| summarize counts = count() by policyAssignmentId, policyAssignmentScope, max_stateWeight, policyAssignmentName,policySetDefinitionId\n| summarize overallStateWeight = max(max_stateWeight),\nnonCompliantCount = sumif(counts, max_stateWeight == 300),\ncompliantCount = sumif(counts, max_stateWeight == 200),\nconflictCount = sumif(counts, max_stateWeight == 100),\nexemptCount = sumif(counts, max_stateWeight == 50) by policyAssignmentId, policyAssignmentScope, policyAssignmentName,policySetDefinitionId\n| extend totalResources = todouble(nonCompliantCount + compliantCount + conflictCount + exemptCount)\n| extend compliancePercentage = iff(totalResources == 0, todouble(100), 100 * todouble(compliantCount + exemptCount) / totalResources)\n| project policyAssignmentName, scope = policyAssignmentScope,policySetDefinitionId,\ncomplianceState = iff(overallStateWeight == 300, 'nonCompliant', iff(overallStateWeight == 200, 'Compliant', iff(overallStateWeight == 100, 'conflict', iff(overallStateWeight == 50, 'exempt', 'notstarted')))),\ncompliancePercentage,\ncompliantCount,\nnonCompliantCount,\nconflictCount,\nexemptCount\n| where isnotempty(policySetDefinitionId)\n| join (policyresources\n| where type =~ 'microsoft.authorization/policysetdefinitions' and isnotempty(properties.metadata.MonitorStarterPacks)\n| extend policySetDefinitionId=tostring(id)) on policySetDefinitionId\n| project policyId=policySetDefinitionId, policyName=name,complianceState,pack='N/A', type='Set')",
                                  "size": 0,
                                  "title": "Assignment Status (Compliance)",
                                  "exportMultipleValues": true,
                                  "exportedParameters": [
                                    {
                                      "parameterName": "policyToRemediate",
                                      "parameterType": 1,
                                      "quote": ""
                                    }
                                  ],
                                  "showExportToExcel": true,
                                  "exportToExcelOptions": "all",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "visualization": "table",
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "complianceState",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "ArmAction",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "Compliant",
                                              "representation": "success",
                                              "text": "Compliant"
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "Non-compliant",
                                              "representation": "2",
                                              "text": "Non-Compliant"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "warning",
                                              "text": "{0}{1}"
                                            }
                                          ],
                                          "armActionContext": {
                                            "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                            "headers": [],
                                            "params": [],
                                            "body": "{ \n  \"function\": \"policymgmt\",\n  \"functionBody\" : {\n    \"SolutionTag\":\"MonitorStarterPacks\",\n    \"Action\": \"Remediate\",\n    \"Policies\": [{policyToRemediate}]\n  }\n}",
                                            "httpMethod": "POST",
                                            "title": "Remediate a policy",
                                            "description": "# Remediate\n\nPolicies:\n\n[{policyToRemediate:$.policyId}]\n",
                                            "actionName": "Remediatepolicies",
                                            "runLabel": "Remediate"
                                          }
                                        },
                                        "tooltipFormat": {
                                          "tooltip": "Click To Remediate"
                                        }
                                      }
                                    ],
                                    "filter": true,
                                    "sortBy": [
                                      {
                                        "itemKey": "type",
                                        "sortOrder": 1
                                      }
                                    ]
                                  },
                                  "sortBy": [
                                    {
                                      "itemKey": "type",
                                      "sortOrder": 1
                                    }
                                  ]
                                },
                                "customWidth": "75",
                                "conditionalVisibility": {
                                  "parameterName": "policyTab",
                                  "comparison": "isEqualTo",
                                  "value": "compliance"
                                },
                                "name": "policylist",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 11,
                                      "content": {
                                        "version": "LinkItem/1.0",
                                        "style": "list",
                                        "links": [
                                          {
                                            "id": "b3bb5a4d-0f95-4e9a-8634-9cb027f860aa",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Remediate",
                                            "preText": "",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"policymgmt\",\n  \"functionBody\" : {\n    \"SolutionTag\":\"MonitorStarterPacks\",\n    \"Action\": \"Remediate\",\n    \"Policies\": [{policyToRemediate}]\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Remediate policies",
                                              "description": "# Please confirm remediation\n\nThis button will trigger a remediation action against the selected policies.\n\n{policyToRemediate}",
                                              "actionName": "Remediate",
                                              "runLabel": "Confirm"
                                            }
                                          },
                                          {
                                            "id": "8dfc5afa-108a-4713-8a0c-651c3a32c5f1",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Check Compliance",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"policymgmt\",\n  \"functionBody\" : {\n    \"SolutionTag\":\"MonitorStarterPacks\",\n    \"Action\": \"Scan\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Check Policy Compliance",
                                              "description": "# Please confirm the scan.",
                                              "runLabel": "Confirm"
                                            }
                                          }
                                        ]
                                      },
                                      "name": "links - 3"
                                    },
                                    {
                                      "type": 1,
                                      "content": {
                                        "json": "## Policy Compliance Check\nThis task will trigger a tenant wide check for policy compliance.\n\n## Policy Remediation\n\nThis Task will trigger remediation for the policies in the list that are considered not compliant at this time.",
                                        "style": "info"
                                      },
                                      "conditionalVisibilities": [
                                        {
                                          "parameterName": "tabSelection",
                                          "comparison": "isEqualTo",
                                          "value": "policystatus"
                                        },
                                        {
                                          "parameterName": "showHelp",
                                          "comparison": "isEqualTo",
                                          "value": "yes"
                                        }
                                      ],
                                      "name": "text - 7"
                                    }
                                  ]
                                },
                                "customWidth": "25",
                                "conditionalVisibility": {
                                  "parameterName": "policyTab",
                                  "comparison": "isEqualTo",
                                  "value": "compliance"
                                },
                                "name": "ComplianceButtons"
                              },
                              {
                                "type": 1,
                                "content": {
                                  "json": "## Installed Policies and Initiatives with Assignments\n\nThis grid can be used to visualize the policies and currenct assignments as well as assing/unassign policies to/from different scopes.\n\nOnce one or more policies are selected, the diaglog of scopes (subscriptions and management groups) is displayed along with the respective buttons.\n",
                                  "style": "info"
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "showHelp",
                                    "comparison": "isEqualTo",
                                    "value": "yes"
                                  },
                                  {
                                    "parameterName": "policyTab",
                                    "comparison": "isEqualTo",
                                    "value": "assignment"
                                  }
                                ],
                                "name": "text - 7"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "policyresources\n| where type == \"microsoft.authorization/policydefinitions\"\n| where  isnotempty(properties.metadata.MonitorStarterPacks)\n| project Name=name, Type='Policy',['id'],Pack=tostring(properties.metadata.MonitorStarterPacks)\n| join kind = leftouter (policyresources\n| where type == \"microsoft.authorization/policyassignments\"\n| project AssignmentName=name,scope=properties.scope,PolicyId=tostring(properties.policyDefinitionId), PolicyName=split(properties.PolicyId,\"/\")[8]\n| join kind=leftouter  (policyresources\n| where type == \"microsoft.authorization/policydefinitions\"\n| where  isnotempty(properties.metadata.MonitorStarterPacks)) on $left.PolicyId == $right.id\n| project tostring(AssignmentName),Name=tostring(split(PolicyId,\"/\")[8]), PolicyId,ScopeLevel=iff(scope contains 'subscriptions',\"Sub\", \"MG\"), Scope=scope) on Name\n| project-away Name1, id\n| union ( policyresources\n| where type == \"microsoft.authorization/policysetdefinitions\"\n| where  isnotempty(properties.metadata.MonitorStarterPacks)\n| project Name=name, Type='Initiative',['id'],Pack=\"_N/A\"\n| join kind = leftouter (policyresources\n| where type == \"microsoft.authorization/policyassignments\"\n| project AssignmentName=name,scope=properties.scope,PolicyId=tostring(properties.policyDefinitionId), PolicyName=split(properties.PolicyId,\"/\")[8]\n| join kind=leftouter  (policyresources\n| where type == \"microsoft.authorization/policysetdefinitions\"\n| where  isnotempty(properties.metadata.MonitorStarterPacks)) on $left.PolicyId == $right.id\n| project tostring(AssignmentName),Name=tostring(split(PolicyId,\"/\")[8]), PolicyId, ScopeLevel=iff(scope contains 'subscriptions',\"Sub\", \"MG\"),Scope=scope) on Name\n| project-away Name1, id)\n| sort by Pack asc, AssignmentName asc ",
                                  "size": 0,
                                  "title": "Installed Policies and Initiatives with Assignments",
                                  "noDataMessage": "No MonStar policies (packs) installed.",
                                  "exportMultipleValues": true,
                                  "exportedParameters": [
                                    {
                                      "fieldName": "",
                                      "parameterName": "policyseletedpolicy",
                                      "parameterType": 1
                                    }
                                  ],
                                  "showExportToExcel": true,
                                  "exportToExcelOptions": "all",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "Group",
                                        "formatter": 1
                                      }
                                    ],
                                    "filter": true
                                  }
                                },
                                "conditionalVisibility": {
                                  "parameterName": "policyTab",
                                  "comparison": "isEqualTo",
                                  "value": "assignment"
                                },
                                "name": "query - policiestoassign",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 1,
                                "content": {
                                  "json": "Select Scope below to assign a policy. There is no need to Select a scope to Unassign the policy.",
                                  "style": "info"
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "policyseletedpolicy",
                                    "comparison": "isNotEqualTo"
                                  },
                                  {
                                    "parameterName": "policyTab",
                                    "comparison": "isEqualTo",
                                    "value": "assignment"
                                  }
                                ],
                                "name": "text - 6"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "resourcecontainers\n| where type == 'microsoft.management/managementgroups' or type =~ 'microsoft.resources/subscriptions'\n| project name, id, subscriptionId, type=split(type,'/')[1]",
                                  "size": 0,
                                  "exportMultipleValues": true,
                                  "exportedParameters": [
                                    {
                                      "parameterName": "policyscopes",
                                      "parameterType": 1,
                                      "quote": "\""
                                    }
                                  ],
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "policyseletedpolicy",
                                  "comparison": "isNotEqualTo"
                                },
                                "name": "query - 15",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "paragraph",
                                  "links": [
                                    {
                                      "id": "63320366-2b93-4e52-831c-55f7c6de4043",
                                      "linkTarget": "ArmAction",
                                      "linkLabel": "Assign Policy",
                                      "style": "primary",
                                      "linkIsContextBlade": true,
                                      "armActionContext": {
                                        "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                        "headers": [],
                                        "params": [],
                                        "body": "{ \n  \"function\": \"policymgmt\",\n  \"functionBody\" : {\n    \"SolutionTag\":\"MonitorStarterPacks\",\n    \"Action\": \"Assign\",\n    \"Scopes\": [{policyscopes}],\n    \"policies\": [{policyseletedpolicy}]\n  }\n}",
                                        "httpMethod": "POST",
                                        "title": "Assign Policy",
                                        "description": "# Assign policy below to selected scope:\n\n## Policy\n\n{policyseletedpolicy}\n\n## Scope\n\n{policyscopes}",
                                        "runLabel": "Assign"
                                      }
                                    },
                                    {
                                      "id": "ed3b8c20-e2ef-4768-b0b9-bfcc254602e6",
                                      "linkTarget": "ArmAction",
                                      "linkLabel": "Unassign Policy",
                                      "style": "primary",
                                      "linkIsContextBlade": true,
                                      "armActionContext": {
                                        "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                        "headers": [],
                                        "params": [],
                                        "body": "{ \n  \"function\": \"policymgmt\",\n  \"functionBody\" : {\n    \"SolutionTag\":\"MonitorStarterPacks\",\n    \"Action\": \"Unassign\",\n    \"policies\": [{policyseletedpolicy}]\n  }\n}",
                                        "httpMethod": "POST",
                                        "title": "Unassign Policies",
                                        "description": "# Unassign policy or policies below from their scopes.\n\n## Policy\n\n{policyseletedpolicy}\n\n",
                                        "actionName": "Unassign Policies",
                                        "runLabel": "Unassign"
                                      }
                                    }
                                  ]
                                },
                                "customWidth": "25",
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "policyseletedpolicy",
                                    "comparison": "isNotEqualTo"
                                  },
                                  {
                                    "parameterName": "policyTab",
                                    "comparison": "isEqualTo",
                                    "value": "assignment"
                                  }
                                ],
                                "name": "links - 2 - Copy"
                              },
                              {
                                "type": 1,
                                "content": {
                                  "json": "## Policies To Assign: \n\n`{policyseletedpolicy}`\n\n## Scopes: \n\n{policyscopes}"
                                },
                                "conditionalVisibilities": [
                                  {
                                    "parameterName": "policyseletedpolicy",
                                    "comparison": "isNotEqualTo"
                                  },
                                  {
                                    "parameterName": "showHelp",
                                    "comparison": "isEqualTo",
                                    "value": "yes"
                                  }
                                ],
                                "name": "text - 4"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "policystatus"
                          },
                          "name": "policymgmt"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "title": "Agent Management",
                            "items": [
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "tabs",
                                  "links": [
                                    {
                                      "id": "24d1e53a-ca25-4488-92af-4746e5411951",
                                      "cellValue": "agentTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Agents",
                                      "subTarget": "agents",
                                      "preText": "",
                                      "style": "link"
                                    },
                                    {
                                      "id": "230109a1-ed5a-4f33-b577-dab3c9b97c4d",
                                      "cellValue": "agentTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "HeartBeat",
                                      "subTarget": "heartbeat",
                                      "style": "link"
                                    },
                                    {
                                      "id": "7413ed40-fb13-48b3-acee-d27259ca7617",
                                      "cellValue": "agentTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "VM Applications",
                                      "subTarget": "vmapplications",
                                      "style": "link"
                                    }
                                  ]
                                },
                                "name": "links - 3"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "Resources\n| where type == 'microsoft.compute/virtualmachines' and tolower(tags.Vendor) != 'databricks'\n| extend\n    JoinID = toupper(id),\n    OSType = tostring(properties.storageProfile.osDisk.osType)\n| join kind=leftouter(\n    Resources\n    | where ( type == 'microsoft.compute/virtualmachines/extensions') and name in ('AzureMonitorLinuxAgent', 'AzureMonitorWindowsAgent')\n    | extend\n        State= tolower(properties.provisioningState),\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        ExtensionName = name,\n        UpgradeEnabled =  tostring(properties.enableAutomaticUpgrade)\n) on $left.JoinID == $right.VMId\n| join kind=leftouter(\n    Resources\n    | where ( type == 'microsoft.compute/virtualmachines/extensions') and name in ('DependencyAgentWindows','DependencyAgentLinux')\n    | extend\n        State= tolower(properties.provisioningState),\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        DepAgent = name,\n        UpgradeEnabled =  tostring(properties.enableAutomaticUpgrade)\n) on $left.JoinID == $right.VMId\n| union (Resources\n| where type == 'microsoft.hybridcompute/machines' and tolower(tags.Vendor) != 'databricks'\n| extend\n    JoinID = toupper(id),\n    OSType = tostring(properties.osType)\n| join kind=leftouter(\n    Resources\n    | where type == 'microsoft.hybridcompute/machines/extensions' and name in ('AzureMonitorLinuxAgent', 'AzureMonitorWindowsAgent')\n    | extend\n        State= tolower(properties.provisioningState),\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        ExtensionName = name,\n        UpgradeEnabled =  tostring(properties.enableAutomaticUpgrade)\n) on $left.JoinID == $right.VMId\n| join kind=leftouter(\n    Resources\n    | where type == 'microsoft.hybridcompute/machines/extensions' and name in ('DependencyAgentWindows','DependencyAgentLinux')\n    | extend\n        State= tolower(properties.provisioningState),\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        DepAgent = name,\n        UpgradeEnabled =  tostring(properties.enableAutomaticUpgrade)\n) on $left.JoinID == $right.VMId)\n| summarize by id, OSType, ['Dependency Agent']=iff(isempty(DepAgent),'N/A',DepAgent),ExtensionName=iff(isempty(ExtensionName),'N/A',ExtensionName), ['AMA State']=State, ['AMA Upg']=UpgradeEnabled,['Subscription']=subscriptionId,['Resource Group']=resourceGroup, location\n| extend Install=iff(ExtensionName=='N/A','Install',iff(['AMA State']<> 'succeeded','Unhealthy','')), Uninstall=iff((ExtensionName<>'N/A') and (['AMA State'] == 'succeeded'),'Uninstall',iff(['AMA State'] <> 'succeeded','Warning',''))\n",
                                  "size": 0,
                                  "title": "Agent Install Status",
                                  "exportMultipleValues": true,
                                  "exportedParameters": [
                                    {
                                      "parameterType": 1
                                    },
                                    {
                                      "parameterName": "vmstoinstall",
                                      "parameterType": 5,
                                      "quote": ""
                                    }
                                  ],
                                  "showExportToExcel": true,
                                  "exportToExcelOptions": "all",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "visualization": "table",
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "Dependency Agent",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "N/A",
                                              "representation": "1",
                                              "text": "",
                                              "tooltipFormat": {
                                                "tooltip": "Not Installed"
                                              }
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "DependencyAgentWindows",
                                              "representation": "success",
                                              "text": "",
                                              "tooltipFormat": {
                                                "tooltip": "Installed"
                                              }
                                            },
                                            {
                                              "thresholdValue": "DependencyAgentLinux",
                                              "representation": "success",
                                              "text": "",
                                              "tooltipFormat": {
                                                "tooltip": "Installed"
                                              }
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "unknown",
                                              "text": "{0}{1}"
                                            }
                                          ]
                                        }
                                      },
                                      {
                                        "columnMatch": "ExtensionName",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "AzureMonitorLinuxAgent",
                                              "representation": "success",
                                              "text": "Linux Agent"
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "AzureMonitorWindowsAgent",
                                              "representation": "success",
                                              "text": "Windows Agent"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "stopped",
                                              "text": "No Agent"
                                            }
                                          ],
                                          "armActionContext": {
                                            "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                            "headers": [],
                                            "params": [],
                                            "body": "{ \n  \"function\": \"agentMgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddAgent\",\n    \"Resources\": [{vmstoinstall}]\n  }\n}",
                                            "httpMethod": "POST",
                                            "title": "Install Agent",
                                            "description": "# Installing agent(s) for the following machine(s):\n\n{vmstoinstall}\n",
                                            "actionName": "InstallAgent",
                                            "runLabel": "InstallAgent"
                                          },
                                          "customColumnWidthSetting": "20ch"
                                        },
                                        "tooltipFormat": {
                                          "tooltip": "Click To Install Agent"
                                        }
                                      },
                                      {
                                        "columnMatch": "State",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "succeeded",
                                              "representation": "success",
                                              "text": ""
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "failed",
                                              "representation": "3",
                                              "text": "failed"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "unknown",
                                              "text": ""
                                            }
                                          ]
                                        }
                                      },
                                      {
                                        "columnMatch": "AMA Upg",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "1",
                                              "text": "",
                                              "tooltipFormat": {
                                                "tooltip": "Auto Upgrade not enabled"
                                              }
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "",
                                              "tooltipFormat": {
                                                "tooltip": "Enabled"
                                              }
                                            }
                                          ]
                                        }
                                      },
                                      {
                                        "columnMatch": "Subscription",
                                        "formatter": 15,
                                        "formatOptions": {
                                          "linkTarget": null,
                                          "showIcon": true
                                        }
                                      },
                                      {
                                        "columnMatch": "Resource Group",
                                        "formatter": 14,
                                        "formatOptions": {
                                          "linkTarget": null,
                                          "showIcon": true
                                        }
                                      },
                                      {
                                        "columnMatch": "Install",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "ArmAction",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "success",
                                              "text": "Ok"
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "Unhealthy",
                                              "representation": "2",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "Add",
                                              "text": "{0}{1}"
                                            }
                                          ],
                                          "armActionContext": {
                                            "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                            "headers": [],
                                            "params": [],
                                            "body": "{ \n  \"function\": \"agentMgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddAgent\",\n    \"Resources\": [{vmstoinstall}]\n  }\n}\n",
                                            "httpMethod": "POST",
                                            "title": "Install Agent",
                                            "description": "# Installing agent(s) for the following machine(s):\n\n\n{vmstoinstall}\n",
                                            "actionName": "Install Agent",
                                            "runLabel": "Install Agent"
                                          }
                                        }
                                      },
                                      {
                                        "columnMatch": "Uninstall",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "ArmAction",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "is Empty",
                                              "representation": "3",
                                              "text": "Not Installed"
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "Warning",
                                              "representation": "1",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "warning",
                                              "text": "{0}{1}"
                                            }
                                          ],
                                          "armActionContext": {
                                            "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                            "headers": [],
                                            "params": [],
                                            "body": "{ \n  \"function\": \"agentMgmt\",\n  \"functionBody\" : {\n    \"Action\":\"RemoveAgent\",\n    \"Resources\": [{vmstoinstall}]\n  }\n}\n",
                                            "httpMethod": "POST",
                                            "title": "Remove Agent",
                                            "description": "# Removing agent(s) for the following machine(s):\n\n## <span style=\"color:red\">Warning! </span> Removing the agent from the machine(s) may result in data not being collected.\n\n\n{vmstoinstall}\n",
                                            "actionName": "RemoveAgent",
                                            "runLabel": "RemoveAgent"
                                          }
                                        }
                                      },
                                      {
                                        "columnMatch": "subscriptionId",
                                        "formatter": 15,
                                        "formatOptions": {
                                          "linkTarget": null,
                                          "showIcon": true
                                        }
                                      },
                                      {
                                        "columnMatch": "DepAgent",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "N/A",
                                              "representation": "1",
                                              "text": "{0}{1}",
                                              "tooltipFormat": {
                                                "tooltip": "Not Installed"
                                              }
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "{0}{1}",
                                              "tooltipFormat": {
                                                "tooltip": "Installed"
                                              }
                                            }
                                          ]
                                        },
                                        "tooltipFormat": {
                                          "tooltip": "Dependency Agent Status"
                                        }
                                      },
                                      {
                                        "columnMatch": "UpgradeEnabled",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "true",
                                              "representation": "success",
                                              "text": ""
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "false",
                                              "representation": "2",
                                              "text": ""
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "unknown",
                                              "text": ""
                                            }
                                          ]
                                        }
                                      }
                                    ],
                                    "filter": true
                                  },
                                  "sortBy": []
                                },
                                "conditionalVisibility": {
                                  "parameterName": "agentTab",
                                  "comparison": "isEqualTo",
                                  "value": "agents"
                                },
                                "showPin": false,
                                "name": "query - agent install status",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "Resources\n| where type == 'microsoft.compute/virtualmachines'\n| extend\n    JoinID = toupper(id),\n    OSName = tostring(properties.osProfile.computerName),\n    OSType = tostring(properties.storageProfile.osDisk.osType)\n| join kind=leftouter(\n    Resources\n    | where ( type == 'microsoft.compute/virtualmachines/extensions') and name in ('AzureMonitorLinuxAgent', 'AzureMonitorWindowsAgent')\n    | extend\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        ExtensionName = name\n) on $left.JoinID == $right.VMId\n| union (Resources\n| where type == 'microsoft.hybridcompute/machines'\n| extend\n    JoinID = toupper(id),\n    OSName = tostring(properties.osProfile.computerName),\n    OSType = tostring(properties.osType)\n| join kind=leftouter(\n    Resources\n    | where type == 'microsoft.hybridcompute/machines/extensions' and name in ('AzureMonitorLinuxAgent', 'AzureMonitorWindowsAgent')\n    | extend\n        VMId = toupper(substring(id, 0, indexof(id, '/extensions'))),\n        ExtensionName = name\n) on $left.JoinID == $right.VMId)\n| extend ExtensionName = iff(isnotempty(ExtensionName),ExtensionName, \"NotInstalled\")\n| summarize count() by ExtensionName\n| sort by ExtensionName asc",
                                  "size": 1,
                                  "title": "Agent Install Status",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "visualization": "tiles",
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "ExtensionName",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "linkTarget": "CellDetails",
                                          "linkIsContextBlade": true,
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "AzureMonitorLinuxAgent",
                                              "representation": "success",
                                              "text": "Linux Agent"
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "AzureMonitorWindowsAgent",
                                              "representation": "success",
                                              "text": "Windows Agent"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "stopped",
                                              "text": "No Agent"
                                            }
                                          ],
                                          "customColumnWidthSetting": "20ch"
                                        }
                                      }
                                    ],
                                    "filter": true
                                  },
                                  "tileSettings": {
                                    "titleContent": {
                                      "columnMatch": "ExtensionName",
                                      "formatter": 1
                                    },
                                    "leftContent": {
                                      "columnMatch": "count_",
                                      "formatter": 12,
                                      "formatOptions": {
                                        "palette": "auto"
                                      },
                                      "numberFormat": {
                                        "unit": 17,
                                        "options": {
                                          "maximumSignificantDigits": 3,
                                          "maximumFractionDigits": 2
                                        }
                                      }
                                    },
                                    "showBorder": false
                                  },
                                  "chartSettings": {
                                    "seriesLabelSettings": [
                                      {
                                        "seriesName": "",
                                        "label": "No Agent",
                                        "color": "red"
                                      }
                                    ]
                                  }
                                },
                                "customWidth": "25",
                                "conditionalVisibility": {
                                  "parameterName": "agentTab",
                                  "comparison": "isEqualTo",
                                  "value": "agents"
                                },
                                "name": "query - agent install status - graph",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "Heartbeat | where Category == \"Azure Monitor Agent\"\n| summarize arg_max(TimeGenerated, *) by Computer\n| project  Computer,LastHeartbeat=TimeGenerated, ['SecondsAgo']=datetime_diff('second',now(),TimeGenerated)\n| sort by SecondsAgo asc",
                                  "size": 4,
                                  "title": "Last Heartbeat (24 hours)",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  },
                                  "showExportToExcel": true,
                                  "exportToExcelOptions": "all",
                                  "queryType": 0,
                                  "resourceType": "microsoft.operationalinsights/workspaces",
                                  "crossComponentResources": [
                                    "{Workspace}"
                                  ],
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "SecondsAgo",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "<=",
                                              "thresholdValue": "600",
                                              "representation": "success",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": ">",
                                              "thresholdValue": "600",
                                              "representation": "2",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": null,
                                              "text": "{0}{1}"
                                            }
                                          ]
                                        }
                                      }
                                    ],
                                    "filter": true
                                  }
                                },
                                "customWidth": "50",
                                "conditionalVisibility": {
                                  "parameterName": "agentTab",
                                  "comparison": "isEqualTo",
                                  "value": "heartbeat"
                                },
                                "name": "query - active alerts",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "resources\n| where type =~ \"microsoft.compute/virtualmachines\"\n| mvexpand with_itemindex=i apps=properties.applicationProfile.galleryApplications\n| where apps != ''\n| project Computer=name, ['Application Name']=tostring(split(apps.packageReferenceId,\"/\")[10]), Gallery=tostring(split(apps.packageReferenceId,\"/\")[8])\n| summarize by Gallery,['Application Name'], Computer\n| sort by Gallery asc",
                                  "size": 0,
                                  "title": "Client Status (VM Applications)",
                                  "showExportToExcel": true,
                                  "exportToExcelOptions": "all",
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "gridSettings": {
                                    "filter": true,
                                    "sortBy": [
                                      {
                                        "itemKey": "Computer",
                                        "sortOrder": 1
                                      }
                                    ]
                                  },
                                  "sortBy": [
                                    {
                                      "itemKey": "Computer",
                                      "sortOrder": 1
                                    }
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "agentTab",
                                  "comparison": "isEqualTo",
                                  "value": "vmapplications"
                                },
                                "name": "query - vmapplications",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "agentmgmt"
                          },
                          "name": "AgentMGMTGroup"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "title": "Auto Discovery Prototype - Use with caution.",
                            "loadType": "always",
                            "items": [
                              {
                                "type": 11,
                                "content": {
                                  "version": "LinkItem/1.0",
                                  "style": "tabs",
                                  "links": [
                                    {
                                      "id": "6346adc4-5e50-4b56-ab9d-0d8b17b8a86f",
                                      "cellValue": "discTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Discovery Results",
                                      "subTarget": "discResults",
                                      "preText": "",
                                      "style": "link"
                                    },
                                    {
                                      "id": "a914f6ed-4d20-4895-bed4-48a32f3a5c21",
                                      "cellValue": "discTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Discovery Config",
                                      "subTarget": "discConfig",
                                      "style": "link"
                                    },
                                    {
                                      "id": "2c17bf03-2295-4b97-850f-3208602c9e50",
                                      "cellValue": "discTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Discovery Policies",
                                      "subTarget": "discPolicies",
                                      "style": "link"
                                    },
                                    {
                                      "id": "3a11d108-b694-4989-9302-48010831377a",
                                      "cellValue": "discTab",
                                      "linkTarget": "parameter",
                                      "linkLabel": "Discovery Data",
                                      "subTarget": "discData",
                                      "style": "link"
                                    }
                                  ]
                                },
                                "name": "links - 10"
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "title": "VM Discovery",
                                  "items": [
                                    {
                                      "type": 1,
                                      "content": {
                                        "json": "When Discovery is first enabled, the Azure Monitoring Agent will also be installed to the selected servers along with a VM Application agent to collect discovery data. Data will be sent to the Log Analytics agent.",
                                        "style": "info"
                                      },
                                      "name": "text - 3"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "insightsresources\n| where type == \"microsoft.insights/datacollectionruleassociations\"\n| extend resourceId=split(id,'/providers/Microsoft.Insights/')[0]\n| where isnotnull(properties.dataCollectionRuleId)\n| project rulename=tostring(split(properties.dataCollectionRuleId,\"/\")[8]),resourceName=tostring(split(resourceId,\"/\")[8]),resourceId=tostring(resourceId)//ruleId=properties.dataCollectionRuleId\n| join kind= inner  (\nresources\n| where type == \"microsoft.insights/datacollectionrules\"\n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isnotempty(MPs) and (MPs =~ 'WinDisc' or MPs =~ 'LxDisc')//or properties.dataSources.performanceCounters[0].name == 'VMInsightsPerfCounters'\n| summarize by Pack=MPs,rulename=tostring(name)) on rulename\n| summarize by resourceId, Pack\n| summarize Packs=make_list(Pack) by resourceId",
                                        "size": 0,
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "Packs",
                                              "formatter": 1
                                            }
                                          ]
                                        }
                                      },
                                      "conditionalVisibility": {
                                        "parameterName": "test",
                                        "comparison": "isEqualTo",
                                        "value": "1"
                                      },
                                      "showPin": false,
                                      "name": "query - associatedVMs"
                                    },
                                    {
                                      "type": 3,
                                      "content": {
                                        "version": "KqlItem/1.0",
                                        "query": "resources | where type =~ 'microsoft.compute/virtualmachines' \n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isnotempty(MPs) and (MPs contains 'WinDisc' or MPs contains 'LxDisc')\n| project Resource=id,['Resource Group']=resourceGroup,Packs=tags.MonitorStarterPacks, OS=properties.storageProfile.osDisk.osType, subscriptionId, Location=location\n",
                                        "size": 0,
                                        "queryType": 1,
                                        "resourceType": "microsoft.resources/tenants",
                                        "crossComponentResources": [
                                          "value::tenant"
                                        ],
                                        "gridSettings": {
                                          "formatters": [
                                            {
                                              "columnMatch": "Packs",
                                              "formatter": 18,
                                              "formatOptions": {
                                                "thresholdsOptions": "icons",
                                                "thresholdsGrid": [
                                                  {
                                                    "operator": "contains",
                                                    "thresholdValue": "WinDisc",
                                                    "text": "WinDisc"
                                                  },
                                                  {
                                                    "thresholdValue": "LxDisc",
                                                    "text": "LxDisk"
                                                  },
                                                  {
                                                    "operator": "Default",
                                                    "thresholdValue": null,
                                                    "representation": "unknown",
                                                    "text": "{0}{1}"
                                                  }
                                                ]
                                              }
                                            },
                                            {
                                              "columnMatch": "subscriptionId",
                                              "formatter": 15,
                                              "formatOptions": {
                                                "linkTarget": null,
                                                "showIcon": true
                                              }
                                            }
                                          ]
                                        }
                                      },
                                      "conditionalVisibility": {
                                        "parameterName": "showHidden",
                                        "comparison": "isEqualTo",
                                        "value": "yes"
                                      },
                                      "showPin": false,
                                      "name": "query - taggedVMs"
                                    },
                                    {
                                      "type": 12,
                                      "content": {
                                        "version": "NotebookGroup/1.0",
                                        "groupType": "editable",
                                        "items": [
                                          {
                                            "type": 3,
                                            "content": {
                                              "version": "KqlItem/1.0",
                                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\",\"mergeType\":\"outer\",\"leftTable\":\"query - taggedVMs\",\"rightTable\":\"query - associatedVMs\",\"leftColumn\":\"Resource\",\"rightColumn\":\"resourceId\"}],\"projectRename\":[{\"originalName\":\"[query - taggedVMs].Resource\",\"mergedName\":\"Resource\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Resource Group\",\"mergedName\":\"Resource Group\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Packs\",\"mergedName\":\"Packs\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].OS\",\"mergedName\":\"OS\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Location\",\"mergedName\":\"Location\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].Subscription\",\"mergedName\":\"Subscription\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - associatedVMs].Packs\",\"mergedName\":\"Associated\",\"fromId\":\"964f21b6-ee11-43c6-a6e2-4119d566812c\"},{\"originalName\":\"[query - taggedVMs].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - associatedVMs].resourceId\"}]}",
                                              "size": 0,
                                              "title": "Discoverable Machines",
                                              "exportMultipleValues": true,
                                              "exportedParameters": [
                                                {
                                                  "fieldName": "",
                                                  "parameterName": "taggedVMsDiscovery",
                                                  "parameterType": 1,
                                                  "quote": ""
                                                }
                                              ],
                                              "showExportToExcel": true,
                                              "queryType": 7,
                                              "visualization": "table",
                                              "gridSettings": {
                                                "formatters": [
                                                  {
                                                    "columnMatch": "Packs",
                                                    "formatter": 18,
                                                    "formatOptions": {
                                                      "thresholdsOptions": "icons",
                                                      "thresholdsGrid": [
                                                        {
                                                          "operator": "contains",
                                                          "thresholdValue": "WinDisc",
                                                          "text": "WinDisc"
                                                        },
                                                        {
                                                          "operator": "contains",
                                                          "thresholdValue": "LxDisc",
                                                          "text": "LxDisc"
                                                        },
                                                        {
                                                          "operator": "Default",
                                                          "thresholdValue": null,
                                                          "representation": "unknown",
                                                          "text": "{0}{1}"
                                                        }
                                                      ]
                                                    }
                                                  },
                                                  {
                                                    "columnMatch": "OS",
                                                    "formatter": 1
                                                  },
                                                  {
                                                    "columnMatch": "Associated",
                                                    "formatter": 1
                                                  },
                                                  {
                                                    "columnMatch": "subscriptionId",
                                                    "formatter": 15,
                                                    "formatOptions": {
                                                      "linkTarget": null,
                                                      "showIcon": true
                                                    }
                                                  },
                                                  {
                                                    "columnMatch": "Associated Packs",
                                                    "formatter": 1
                                                  }
                                                ],
                                                "filter": true
                                              }
                                            },
                                            "showPin": false,
                                            "name": "query-mergeVMsDiscovery",
                                            "styleSettings": {
                                              "showBorder": true
                                            }
                                          },
                                          {
                                            "type": 9,
                                            "content": {
                                              "version": "KqlParameterItem/1.0",
                                              "crossComponentResources": [
                                                "{Workspace}"
                                              ],
                                              "parameters": [
                                                {
                                                  "id": "54f2c7fb-7251-43b6-aa4d-fd94647cac4a",
                                                  "version": "KqlParameterItem/1.0",
                                                  "name": "PackTagsLeftDiscovery",
                                                  "label": "Remove",
                                                  "type": 2,
                                                  "isGlobal": true,
                                                  "multiSelect": true,
                                                  "quote": "",
                                                  "delimiter": ",",
                                                  "query": "resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| where isnotempty(tags.MonitorStarterPacks) and tags.MonitoringPackType=~'discovery'\n| project MPs=tostring(tags.MonitorStarterPacks)\n| summarize by MPs",
                                                  "crossComponentResources": [
                                                    "{Workspace}"
                                                  ],
                                                  "typeSettings": {
                                                    "additionalResourceOptions": [],
                                                    "showDefault": false
                                                  },
                                                  "timeContext": {
                                                    "durationMs": 86400000
                                                  },
                                                  "queryType": 1,
                                                  "resourceType": "microsoft.resourcegraph/resources",
                                                  "value": [
                                                    "LxDisc"
                                                  ]
                                                }
                                              ],
                                              "style": "pills",
                                              "queryType": 1,
                                              "resourceType": "microsoft.resourcegraph/resources"
                                            },
                                            "customWidth": "25",
                                            "conditionalVisibility": {
                                              "parameterName": "taggedVMsDiscovery",
                                              "comparison": "isNotEqualTo"
                                            },
                                            "name": "param-IaaS-tagged"
                                          },
                                          {
                                            "type": 11,
                                            "content": {
                                              "version": "LinkItem/1.0",
                                              "style": "paragraph",
                                              "links": [
                                                {
                                                  "id": "36b65f94-1c3d-4e7a-b771-677a2081d288",
                                                  "cellValue": "",
                                                  "linkTarget": "ArmAction",
                                                  "linkLabel": "Remove Discovery {PackTagsLeftDiscovery} Pack(s)",
                                                  "preText": "",
                                                  "style": "primary",
                                                  "linkIsContextBlade": true,
                                                  "armActionContext": {
                                                    "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                                    "headers": [],
                                                    "params": [
                                                      {
                                                        "key": "action",
                                                        "value": "removeTag"
                                                      }
                                                    ],
                                                    "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"RemoveTag\",\n    \"Resources\": [{taggedVMsDiscovery}],\n    \"Pack\": \"{PackTagsLeftDiscovery}\",\n    \"PackType\":\"Discovery\"\n  }\n}",
                                                    "httpMethod": "POST",
                                                    "title": "Remove Monitoring",
                                                    "description": "# Please confirm the change.\n\nRemove Monitoring for {PackTagsLeftDiscovery} Pack(s) \n\nServers:\n\n{taggedVMsDiscovery}",
                                                    "runLabel": "Confirm"
                                                  }
                                                }
                                              ]
                                            },
                                            "customWidth": "75",
                                            "conditionalVisibility": {
                                              "parameterName": "taggedVMsDiscovery",
                                              "comparison": "isNotEqualTo"
                                            },
                                            "name": "links - 1"
                                          }
                                        ],
                                        "exportParameters": true
                                      },
                                      "customWidth": "50",
                                      "name": "TaggedGroupDiscovery"
                                    },
                                    {
                                      "type": 12,
                                      "content": {
                                        "version": "NotebookGroup/1.0",
                                        "groupType": "editable",
                                        "items": [
                                          {
                                            "type": 3,
                                            "content": {
                                              "version": "KqlItem/1.0",
                                              "query": "resources | where type =~ 'microsoft.compute/virtualmachines' \n| extend MPs=tostring(['tags'].MonitorStarterPacks)\n| where isempty(MPs) or (MPs notcontains 'WinDisc' and MPs notcontains 'LxDisc')//and subscriptionId in split('{Subscriptions:subscriptionId}',',')\n| project Resource=id,['Resource Group']=resourceGroup, OS=properties.storageProfile.osDisk.osType, subscriptionId, Location=location\n| join kind= leftouter   (resourcecontainers\n| where type =~ 'microsoft.resources/subscriptions'\n| project Subscription=name,subscriptionId) on subscriptionId\n| project-away subscriptionId, subscriptionId1",
                                              "size": 0,
                                              "title": "Non-discoverable Machines",
                                              "exportMultipleValues": true,
                                              "exportedParameters": [
                                                {
                                                  "parameterName": "vmstotagDiscovery",
                                                  "parameterType": 1,
                                                  "quote": ""
                                                }
                                              ],
                                              "queryType": 1,
                                              "resourceType": "microsoft.resourcegraph/resources",
                                              "crossComponentResources": [
                                                "{Subscriptions}"
                                              ],
                                              "visualization": "table",
                                              "gridSettings": {
                                                "filter": true,
                                                "sortBy": [
                                                  {
                                                    "itemKey": "$gen_link_Resource_0",
                                                    "sortOrder": 1
                                                  }
                                                ]
                                              },
                                              "sortBy": [
                                                {
                                                  "itemKey": "$gen_link_Resource_0",
                                                  "sortOrder": 1
                                                }
                                              ]
                                            },
                                            "name": "Non Discoverable Servers",
                                            "styleSettings": {
                                              "margin": "400",
                                              "padding": "400",
                                              "showBorder": true
                                            }
                                          },
                                          {
                                            "type": 9,
                                            "content": {
                                              "version": "KqlParameterItem/1.0",
                                              "crossComponentResources": [
                                                "value::tenant"
                                              ],
                                              "parameters": [
                                                {
                                                  "id": "8a177eab-edac-41cc-84f9-a5b7de931bea",
                                                  "version": "KqlParameterItem/1.0",
                                                  "name": "PackTagsDiscovery",
                                                  "label": "Select to Enable",
                                                  "type": 2,
                                                  "isGlobal": true,
                                                  "multiSelect": true,
                                                  "quote": "",
                                                  "delimiter": ",",
                                                  "query": "resources\n| where type == \"microsoft.insights/datacollectionrules\"\n| where isnotempty(tags.MonitorStarterPacks) and tags.MonitoringPackType=~'Discovery'\n| project MPs=tostring(tags.MonitorStarterPacks)\n| summarize by MPs",
                                                  "crossComponentResources": [
                                                    "value::tenant"
                                                  ],
                                                  "typeSettings": {
                                                    "additionalResourceOptions": [],
                                                    "showDefault": false
                                                  },
                                                  "timeContext": {
                                                    "durationMs": 86400000
                                                  },
                                                  "queryType": 1,
                                                  "resourceType": "microsoft.resources/tenants",
                                                  "value": [
                                                    "WinDisc"
                                                  ]
                                                }
                                              ],
                                              "style": "pills",
                                              "queryType": 1,
                                              "resourceType": "microsoft.resources/tenants"
                                            },
                                            "customWidth": "50",
                                            "conditionalVisibility": {
                                              "parameterName": "vmstotagDiscovery",
                                              "comparison": "isNotEqualTo"
                                            },
                                            "name": "param-IaaS-vmstotag"
                                          },
                                          {
                                            "type": 11,
                                            "content": {
                                              "version": "LinkItem/1.0",
                                              "style": "paragraph",
                                              "links": [
                                                {
                                                  "id": "91fb0fed-0e4f-41ce-9024-98a3cc4432a7",
                                                  "linkTarget": "ArmAction",
                                                  "linkLabel": "Enable Monitoring for {PackTagsDiscovery} Pack",
                                                  "preText": "",
                                                  "style": "primary",
                                                  "linkIsContextBlade": true,
                                                  "armActionContext": {
                                                    "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                                    "headers": [],
                                                    "params": [
                                                      {
                                                        "key": "action",
                                                        "value": "addTag"
                                                      }
                                                    ],
                                                    "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddTag\",\n    \"Resources\": [{vmstotagDiscovery}],\n    \"Pack\": \"{PackTagsDiscovery}\",\n    \"PackType\": \"Discovery\"\n  }\n}",
                                                    "httpMethod": "POST",
                                                    "title": "Enable Monitoring Packs",
                                                    "description": "# This will enable the pack for the following servers:\n{vmstotagDiscovery}\n\nby adding the {PackTagsDiscovery} Pack(s) to the resource(s).",
                                                    "actionName": "EnableMonitoring",
                                                    "runLabel": "Confirm"
                                                  }
                                                }
                                              ]
                                            },
                                            "customWidth": "50",
                                            "conditionalVisibility": {
                                              "parameterName": "vmstotagDiscovery",
                                              "comparison": "isNotEqualTo"
                                            },
                                            "name": "links - 1 - Copy"
                                          }
                                        ],
                                        "exportParameters": true
                                      },
                                      "customWidth": "50",
                                      "name": "NonTaggedGroupDiscovery"
                                    }
                                  ]
                                },
                                "conditionalVisibility": {
                                  "parameterName": "discTab",
                                  "comparison": "isEqualTo",
                                  "value": "discConfig"
                                },
                                "name": "Servers - Discovery",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "policyresources | where type == \"microsoft.policyinsights/policystates\" | extend policyName=tostring(properties.policyDefinitionName),complianceState=properties.complianceState\n| join \n    (policyresources | where type == \"microsoft.authorization/policydefinitions\" and properties.metadata.MonitoringPackType == 'Discovery'  \n        | project policyId=id, policyName=name) \n        on policyName\n| project Name=policyName, State=tostring(complianceState), type='Policy',policyId\n| union( policyresources\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\n| extend complianceState = tostring(properties.complianceState)\n| extend\n\tresourceId = tostring(properties.resourceId),\n\tpolicyAssignmentId = tostring(properties.policyAssignmentId),\n\tpolicyAssignmentScope = tostring(properties.policyAssignmentScope),\n\tpolicyAssignmentName = tostring(properties.policyAssignmentName),\n\tpolicyDefinitionId = tostring(properties.policyDefinitionId),\n    policySetDefinitionId=tostring(properties.policySetDefinitionId),\n\tpolicyDefinitionReferenceId = tostring(properties.policyDefinitionReferenceId),\n\tstateWeight = iff(complianceState == 'NonCompliant', int(300), iff(complianceState == 'Compliant', int(200), iff(complianceState == 'Conflict', int(100), iff(complianceState == 'Exempt', int(50), int(0)))))\n| summarize max(stateWeight) by resourceId, policyAssignmentId, policyAssignmentScope, policyAssignmentName,policySetDefinitionId\n| summarize counts = count() by policyAssignmentId, policyAssignmentScope, max_stateWeight, policyAssignmentName,policySetDefinitionId\n| summarize overallStateWeight = max(max_stateWeight),\nnonCompliantCount = sumif(counts, max_stateWeight == 300),\ncompliantCount = sumif(counts, max_stateWeight == 200),\nconflictCount = sumif(counts, max_stateWeight == 100),\nexemptCount = sumif(counts, max_stateWeight == 50) by policyAssignmentId, policyAssignmentScope, policyAssignmentName,policySetDefinitionId\n| extend totalResources = todouble(nonCompliantCount + compliantCount + conflictCount + exemptCount)\n| extend compliancePercentage = iff(totalResources == 0, todouble(100), 100 * todouble(compliantCount + exemptCount) / totalResources)\n| project policyAssignmentName, scope = policyAssignmentScope,policySetDefinitionId,\ncomplianceState = iff(overallStateWeight == 300, 'nonCompliant', iff(overallStateWeight == 200, 'Compliant', iff(overallStateWeight == 100, 'conflict', iff(overallStateWeight == 50, 'exempt', 'notstarted')))),\ncompliancePercentage,\ncompliantCount,\nnonCompliantCount,\nconflictCount,\nexemptCount\n| where isnotempty(policySetDefinitionId)\n| join (policyresources\n| where type =~ 'microsoft.authorization/policysetdefinitions' and properties.metadata.MonitoringPackType=='Discovery'\n| extend policySetDefinitionId=tostring(id)) on policySetDefinitionId\n| project Name=name,State=complianceState, type='Set',policyId=policySetDefinitionId)",
                                  "size": 0,
                                  "title": "Assignment Status (Compliance) - Discovery",
                                  "exportedParameters": [
                                    {
                                      "parameterName": "policiesToRemediate",
                                      "parameterType": 5
                                    }
                                  ],
                                  "queryType": 1,
                                  "resourceType": "microsoft.resources/tenants",
                                  "crossComponentResources": [
                                    "value::tenant"
                                  ],
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "State",
                                        "formatter": 18,
                                        "formatOptions": {
                                          "thresholdsOptions": "icons",
                                          "thresholdsGrid": [
                                            {
                                              "operator": "==",
                                              "thresholdValue": "NonCompliant",
                                              "representation": "2",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "==",
                                              "thresholdValue": "nonCompliant",
                                              "representation": "2",
                                              "text": "{0}{1}"
                                            },
                                            {
                                              "operator": "Default",
                                              "thresholdValue": null,
                                              "representation": "success",
                                              "text": "{0}{1}"
                                            }
                                          ]
                                        }
                                      }
                                    ],
                                    "filter": true
                                  }
                                },
                                "customWidth": "75",
                                "conditionalVisibility": {
                                  "parameterName": "discTab",
                                  "comparison": "isEqualTo",
                                  "value": "discPolicies"
                                },
                                "name": "Query DiscoveryPolicies",
                                "styleSettings": {
                                  "showBorder": true
                                }
                              },
                              {
                                "type": 12,
                                "content": {
                                  "version": "NotebookGroup/1.0",
                                  "groupType": "editable",
                                  "items": [
                                    {
                                      "type": 11,
                                      "content": {
                                        "version": "LinkItem/1.0",
                                        "style": "list",
                                        "links": [
                                          {
                                            "id": "b3bb5a4d-0f95-4e9a-8634-9cb027f860aa",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Remediate (all policies)",
                                            "preText": "",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"policymgmt\",\n  \"functionBody\" : {\n    \"SolutionTag\":\"MonitorStarterPacks\",\n    \"Action\": \"Remediate\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Rmediate policies",
                                              "description": "# Please confirm remediation\n\nThis button will trigger a global policy remeadiation. \n\nThe backend script will go through the policies and initiatives, finding the ones that are not compliant, and will trigger remediation. \n\nIt is not restricted to the ones in this screen.",
                                              "actionName": "Remediate",
                                              "runLabel": "Confirm"
                                            }
                                          },
                                          {
                                            "id": "8dfc5afa-108a-4713-8a0c-651c3a32c5f1",
                                            "linkTarget": "ArmAction",
                                            "linkLabel": "Check Compliance",
                                            "style": "primary",
                                            "linkIsContextBlade": true,
                                            "armActionContext": {
                                              "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                              "headers": [],
                                              "params": [],
                                              "body": "{ \n  \"function\": \"policymgmt\",\n  \"functionBody\" : {\n    \"SolutionTag\":\"MonitorStarterPacks\",\n    \"Action\": \"Scan\"\n  }\n}",
                                              "httpMethod": "POST",
                                              "title": "Check Policy Compliance",
                                              "description": "# Please confirm the scan.",
                                              "runLabel": "Confirm"
                                            }
                                          }
                                        ]
                                      },
                                      "name": "links - 3"
                                    },
                                    {
                                      "type": 1,
                                      "content": {
                                        "json": "## Policy Compliance Check\nThis task will trigger a tenant wide check for policy compliance.\n\n## Policy Remediation\n\nThis Task will trigger remediation for the policies in the list that are considered not compliant at this time.",
                                        "style": "info"
                                      },
                                      "conditionalVisibilities": [
                                        {
                                          "parameterName": "tabSelection",
                                          "comparison": "isEqualTo",
                                          "value": "policystatus"
                                        },
                                        {
                                          "parameterName": "showHelp",
                                          "comparison": "isEqualTo",
                                          "value": "yes"
                                        }
                                      ],
                                      "name": "text - 7"
                                    }
                                  ]
                                },
                                "customWidth": "25",
                                "conditionalVisibility": {
                                  "parameterName": "discTab",
                                  "comparison": "isEqualTo",
                                  "value": "discPolicies"
                                },
                                "name": "ComplianceButtons - Copy"
                              },
                              {
                                "type": 9,
                                "content": {
                                  "version": "KqlParameterItem/1.0",
                                  "parameters": [
                                    {
                                      "id": "079a4550-40c9-44cd-a223-40097e453659",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "Computer",
                                      "type": 2,
                                      "query": "\nDiscovery_CL\n| parse RawData with timestamp \",\" rest1\n| extend Computer=split(_ResourceId,'/')[8],timestamp=todatetime(timestamp)\n| summarize by tostring(Computer)\n\n",
                                      "typeSettings": {
                                        "additionalResourceOptions": [],
                                        "showDefault": false
                                      },
                                      "timeContext": {
                                        "durationMs": 86400000
                                      },
                                      "queryType": 0,
                                      "resourceType": "microsoft.operationalinsights/workspaces",
                                      "value": null,
                                      "label": "Select Server"
                                    },
                                    {
                                      "id": "d1f20750-4a22-4433-9c5d-a4d9a4f62f9d",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "discoveryPeriod",
                                      "label": "Period",
                                      "type": 4,
                                      "typeSettings": {
                                        "selectableValues": [
                                          {
                                            "durationMs": 300000
                                          },
                                          {
                                            "durationMs": 900000
                                          },
                                          {
                                            "durationMs": 1800000
                                          },
                                          {
                                            "durationMs": 3600000
                                          },
                                          {
                                            "durationMs": 14400000
                                          },
                                          {
                                            "durationMs": 43200000
                                          },
                                          {
                                            "durationMs": 86400000
                                          },
                                          {
                                            "durationMs": 172800000
                                          },
                                          {
                                            "durationMs": 259200000
                                          },
                                          {
                                            "durationMs": 604800000
                                          },
                                          {
                                            "durationMs": 1209600000
                                          },
                                          {
                                            "durationMs": 2419200000
                                          }
                                        ]
                                      },
                                      "value": {
                                        "durationMs": 14400000
                                      }
                                    }
                                  ],
                                  "style": "above",
                                  "queryType": 0,
                                  "resourceType": "microsoft.operationalinsights/workspaces"
                                },
                                "conditionalVisibility": {
                                  "parameterName": "discTab",
                                  "comparison": "isEqualTo",
                                  "value": "discData"
                                },
                                "name": "param-discovery-period"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "let maxts=Discovery_CL | summarize timestamp=max(tostring(split(RawData,\",\")[0]));\nDiscovery_CL\n| extend Computer=tostring(split(_ResourceId,'/')[8])//,timestamp=todatetime(timestamp)\n| extend fields=split(RawData,\",\")\n| extend timestamp=todatetime(fields[0])\n| extend type=tostring(fields[1])\n| extend platform=tostring(fields[2])\n| extend OSVersion=tostring(fields[3])\n| extend name=tostring(fields[4])\n| extend othertype=tostring(fields[5])\n| extend vendor=tostring(fields[6])\n| where timestamp == toscalar(maxts)\n| project timestamp,Computer,type,name,platform,OSVersion,othertype,vendor",
                                  "size": 0,
                                  "title": "All Discovery Data",
                                  "timeContextFromParameter": "discoveryPeriod",
                                  "showExportToExcel": true,
                                  "queryType": 0,
                                  "resourceType": "microsoft.operationalinsights/workspaces",
                                  "crossComponentResources": [
                                    "{Workspace}"
                                  ],
                                  "gridSettings": {
                                    "rowLimit": 1000,
                                    "filter": true
                                  }
                                },
                                "conditionalVisibility": {
                                  "parameterName": "discTab",
                                  "comparison": "isEqualTo",
                                  "value": "discData"
                                },
                                "name": "query - discovery - all"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getdiscoveryresults\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"WSId\",\"value\":\"{Workspace}\"}],\"transformers\":null}",
                                  "size": 0,
                                  "exportedParameters": [
                                    {
                                      "fieldName": "",
                                      "parameterName": "vmsDiscoveryTag",
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "tag",
                                      "parameterName": "vmsDiscoveryTagValue",
                                      "parameterType": 1
                                    }
                                  ],
                                  "queryType": 10,
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "tag",
                                        "formatter": 7,
                                        "formatOptions": {
                                          "linkTarget": "ArmAction",
                                          "linkIsContextBlade": true,
                                          "armActionContext": {
                                            "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                            "headers": [],
                                            "params": [],
                                            "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddTag\",\n    \"Resources\": [{vmsDiscoveryTag}],\n    \"Pack\": \"{vmsDiscoveryTagValue}\"\n  }\n}",
                                            "httpMethod": "POST",
                                            "title": "TagDiscovery",
                                            "description": "# Adding Tag(s) To VMs\n\n\"Resources\": [{vmsDiscoveryTag:$.Computer}]\n\n\n\"Pack\": \"{vmsDiscoveryTagValue}\"",
                                            "actionName": "TagDiscovery",
                                            "runLabel": "TagDiscovery"
                                          }
                                        },
                                        "tooltipFormat": {
                                          "tooltip": "Click to Enable monitoring"
                                        }
                                      }
                                    ]
                                  }
                                },
                                "name": "query - 0"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "autodiscovery"
                          },
                          "name": "AutoDiscoveryGroup"
                        },
                        {
                          "type": 12,
                          "content": {
                            "version": "NotebookGroup/1.0",
                            "groupType": "editable",
                            "items": [
                              {
                                "type": 9,
                                "content": {
                                  "version": "KqlParameterItem/1.0",
                                  "crossComponentResources": [
                                    "{appInsightsName}"
                                  ],
                                  "parameters": [
                                    {
                                      "id": "dffde712-0ef1-4c46-922a-47a42643130c",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "appInsightsTimeframe",
                                      "label": "Time Range",
                                      "type": 4,
                                      "typeSettings": {
                                        "selectableValues": [
                                          {
                                            "durationMs": 300000
                                          },
                                          {
                                            "durationMs": 900000
                                          },
                                          {
                                            "durationMs": 1800000
                                          },
                                          {
                                            "durationMs": 3600000
                                          },
                                          {
                                            "durationMs": 14400000
                                          },
                                          {
                                            "durationMs": 43200000
                                          },
                                          {
                                            "durationMs": 86400000
                                          },
                                          {
                                            "durationMs": 172800000
                                          },
                                          {
                                            "durationMs": 259200000
                                          },
                                          {
                                            "durationMs": 604800000
                                          },
                                          {
                                            "durationMs": 1209600000
                                          },
                                          {
                                            "durationMs": 2419200000
                                          },
                                          {
                                            "durationMs": 2592000000
                                          }
                                        ]
                                      },
                                      "timeContext": {
                                        "durationMs": 2592000000
                                      },
                                      "value": {
                                        "durationMs": 2419200000
                                      }
                                    },
                                    {
                                      "id": "70107de5-d9cd-46ea-9027-43d83053dac3",
                                      "version": "KqlParameterItem/1.0",
                                      "name": "FunctionApp",
                                      "label": "Function App",
                                      "type": 2,
                                      "query": "requests\n| project\n    timestamp,\n    id,\n    operation_Name,\n    success,\n    resultCode,\n    duration,\n    operation_Id,\n    cloud_RoleName,\n    invocationId=customDimensions['InvocationId']\n| order by timestamp desc\n| take 20\n| summarize by Functions=operation_Name\n",
                                      "crossComponentResources": [
                                        "{appInsightsName}"
                                      ],
                                      "typeSettings": {
                                        "additionalResourceOptions": [],
                                        "showDefault": false
                                      },
                                      "timeContext": {
                                        "durationMs": 2592000000
                                      },
                                      "queryType": 0,
                                      "resourceType": "microsoft.insights/components",
                                      "value": "config"
                                    }
                                  ],
                                  "style": "pills",
                                  "queryType": 0,
                                  "resourceType": "microsoft.insights/components"
                                },
                                "name": "parameters - 18"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "requests\n| project\n    timestamp,\n    id,\n    operation_Name,\n    success,\n    resultCode,\n    duration,\n    operation_Id,\n    cloud_RoleName,\n    invocationId=customDimensions['InvocationId']\n| where operation_Name =~ '{FunctionApp}'\n| order by timestamp desc\n| take 20",
                                  "size": 0,
                                  "title": "Invocations",
                                  "timeContextFromParameter": "appInsightsTimeframe",
                                  "exportedParameters": [
                                    {
                                      "fieldName": "invocationId",
                                      "parameterName": "invocationid",
                                      "parameterType": 1
                                    },
                                    {
                                      "fieldName": "operation_Id",
                                      "parameterName": "operationid",
                                      "parameterType": 1
                                    }
                                  ],
                                  "queryType": 0,
                                  "resourceType": "microsoft.insights/components",
                                  "crossComponentResources": [
                                    "{appInsightsName}"
                                  ],
                                  "gridSettings": {
                                    "formatters": [
                                      {
                                        "columnMatch": "id",
                                        "formatter": 5
                                      }
                                    ]
                                  }
                                },
                                "customWidth": "30",
                                "name": "queryInvocations"
                              },
                              {
                                "type": 3,
                                "content": {
                                  "version": "KqlItem/1.0",
                                  "query": "union traces\n| union exceptions\n| where operation_Id == '{operationid}'\n| where customDimensions['InvocationId'] == '{invocationid}'\n| order by timestamp asc\n| project\n    timestamp,\n    message = iff(message != '', message, iff(innermostMessage != '', innermostMessage, customDimensions.[strcat('prop__{','OriginalFormat}')])),\n    logLevel = customDimensions.['LogLevel']",
                                  "size": 0,
                                  "title": "Invocation Details",
                                  "noDataMessage": "No Invocation Selected",
                                  "timeContextFromParameter": "appInsightsTimeframe",
                                  "exportFieldName": "invocationId",
                                  "exportParameterName": "invocationid",
                                  "queryType": 0,
                                  "resourceType": "microsoft.insights/components",
                                  "crossComponentResources": [
                                    "{appInsightsName}"
                                  ]
                                },
                                "customWidth": "70",
                                "name": "queryInvocationDetails"
                              }
                            ]
                          },
                          "conditionalVisibility": {
                            "parameterName": "tabSelection",
                            "comparison": "isEqualTo",
                            "value": "logs"
                          },
                          "name": "groupLogs"
                        },
                        {
                          "type": 3,
                          "content": {
                            "version": "KqlItem/1.0",
                            "query": "{\"version\":\"CustomEndpoint/1.0\",\"data\":null,\"headers\":[{\"key\":\"x-functions-key\",\"value\":\"{configKey}\"}],\"method\":\"GET\",\"url\":\"https://{FunctionApps:name}.azurewebsites.net/api/config?Action=getdiscoveryresults\",\"contentType\":\"text/plain\",\"urlParams\":[{\"key\":\"WSId\",\"value\":\"{Workspace}\"}],\"transformers\":null}",
                            "size": 0,
                            "exportedParameters": [
                              {
                                "parameterName": "vmsDiscoveryTag",
                                "parameterType": 1
                              },
                              {
                                "fieldName": "tag",
                                "parameterName": "vmsDiscoveryTagValue",
                                "parameterType": 1
                              }
                            ],
                            "queryType": 10,
                            "gridSettings": {
                              "formatters": [
                                {
                                  "columnMatch": "tag",
                                  "formatter": 1,
                                  "formatOptions": {
                                    "linkTarget": "ArmAction",
                                    "linkIsContextBlade": true,
                                    "armActionContext": {
                                      "path": "{logicAppResource}/triggers/manual/run?api-version=2016-06-01",
                                      "headers": [],
                                      "params": [],
                                      "body": "{ \n  \"function\": \"tagmgmt\",\n  \"functionBody\" : {\n    \"Action\":\"AddTag\",\n    \"Resources\": [{vmsDiscoveryTag}],\n    \"Pack\": \"{vmsDiscoveryTagValue}\"\n  }\n}",
                                      "httpMethod": "POST",
                                      "title": "Enable Monitoring",
                                      "description": "# Adding Tag(s) To VMs\n\n\"Resources\": {vmsDiscoveryTag:$.Computer}\n\n\"Pack\": \"{vmsDiscoveryTagValue}\"",
                                      "runLabel": "Enable"
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "conditionalVisibility": {
                            "parameterName": "discTab",
                            "comparison": "isEqualTo",
                            "value": "discResults"
                          },
                          "name": "query - discovery Results"
                        }
                      ],
                      "fallbackResourceIds": [
                        "Azure Monitor"
                      ],
                      "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
                    },
                    "wbConfig": "[string(variables('$fxv#0'))]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Insights/workbooks",
                      "apiVersion": "2022-04-01",
                      "name": "[guid('Azure Monitor Starter Packs V2')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('Tags')]",
                      "kind": "shared",
                      "properties": {
                        "displayName": "Azure Monitor Starter Packs Extended",
                        "serializedData": "[variables('wbConfig')]",
                        "category": "workbook",
                        "sourceId": "[parameters('lawresourceid')]"
                      }
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('AMP-{0}-DCE-{1}', parameters('instanceName'), parameters('location'))]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "Tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "dceName": {
                    "value": "[format('AMP-{0}-DCE-{1}', parameters('instanceName'), parameters('location'))]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "3784354634483652394"
                    }
                  },
                  "parameters": {
                    "dceName": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "Tags": {
                      "type": "object"
                    }
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Insights/dataCollectionEndpoints",
                      "apiVersion": "2021-09-01-preview",
                      "name": "[parameters('dceName')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('Tags')]",
                      "properties": {
                        "networkAcls": {
                          "publicNetworkAccess": "Enabled"
                        }
                      }
                    }
                  ],
                  "outputs": {
                    "dceId": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Insights/dataCollectionEndpoints', parameters('dceName'))]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('AMP-{0}-UMI-Packs-{1}', parameters('instanceName'), parameters('location'))]",
              "location": "[deployment().location]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "Tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "roleDefinitionIds": {
                    "value": "[variables('packPolicyRoleDefinitionIds')]"
                  },
                  "userIdentityName": {
                    "value": "[format('AMP-{0}-UMI-Packs', parameters('instanceName'))]"
                  },
                  "mgname": {
                    "value": "[parameters('mgname')]"
                  },
                  "resourceGroupName": {
                    "value": "[parameters('resourceGroupName')]"
                  },
                  "subscriptionId": {
                    "value": "[parameters('subscriptionId')]"
                  },
                  "addRGRoleAssignments": {
                    "value": true
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "1419658493773483259"
                    }
                  },
                  "parameters": {
                    "location": {
                      "type": "string"
                    },
                    "Tags": {
                      "type": "object"
                    },
                    "roleDefinitionIds": {
                      "type": "array"
                    },
                    "userIdentityName": {
                      "type": "string"
                    },
                    "mgname": {
                      "type": "string"
                    },
                    "subscriptionId": {
                      "type": "string"
                    },
                    "resourceGroupName": {
                      "type": "string"
                    },
                    "addRGRoleAssignments": {
                      "type": "bool",
                      "defaultValue": false
                    },
                    "solutionTag": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "RGroleDefinitionIds": [
                      "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "22926164-76b3-42b3-bc55-97df8dab3e41"
                    ]
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-{1}', parameters('userIdentityName'), parameters('location'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "Tags": {
                            "value": "[parameters('Tags')]"
                          },
                          "userIdentityName": {
                            "value": "[parameters('userIdentityName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "1567859393178125257"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "Tags": {
                              "type": "object"
                            },
                            "userIdentityName": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.ManagedIdentity/userAssignedIdentities",
                              "apiVersion": "2023-01-31",
                              "name": "[parameters('userIdentityName')]",
                              "location": "[parameters('location')]",
                              "tags": "[parameters('Tags')]"
                            }
                          ],
                          "outputs": {
                            "userManagedIdentityPrincipalId": {
                              "type": "string",
                              "value": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userIdentityName')), '2023-01-31').principalId]"
                            },
                            "userManagedIdentityClientId": {
                              "type": "string",
                              "value": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userIdentityName')), '2023-01-31').clientId]"
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userIdentityName'))]"
                            }
                          }
                        }
                      }
                    },
                    {
                      "copy": {
                        "name": "userIdentityRoleAssignments",
                        "count": "[length(parameters('roleDefinitionIds'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-{1}-{2}', parameters('userIdentityName'), copyIndex(), parameters('location'))]",
                      "scope": "[format('Microsoft.Management/managementGroups/{0}', parameters('mgname'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "resourcename": {
                            "value": "[parameters('userIdentityName')]"
                          },
                          "principalId": {
                            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityPrincipalId.value]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "roleDefinitionId": {
                            "value": "[parameters('roleDefinitionIds')[copyIndex()]]"
                          },
                          "roleShortName": {
                            "value": "[parameters('roleDefinitionIds')[copyIndex()]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "13770438938236428861"
                            }
                          },
                          "parameters": {
                            "resourcename": {
                              "type": "string"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "principalId": {
                              "type": "string"
                            },
                            "roleDefinitionId": {
                              "type": "string"
                            },
                            "roleShortName": {
                              "type": "string"
                            },
                            "utcValue": {
                              "type": "string",
                              "defaultValue": "[utcNow()]"
                            }
                          },
                          "variables": {
                            "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(managementGroup().name, parameters('principalId'), parameters('roleDefinitionId'))]",
                              "properties": {
                                "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                                "principalId": "[parameters('principalId')]",
                                "principalType": "ServicePrincipal",
                                "roleDefinitionId": "[variables('roleIdtoUse')]"
                              }
                            }
                          ],
                          "outputs": {
                            "roleassignmentname": {
                              "type": "string",
                              "value": "[guid(managementGroup().name, parameters('principalId'), parameters('roleDefinitionId'))]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location')))]"
                      ]
                    },
                    {
                      "copy": {
                        "name": "userIdentityRoleAssignmentRG",
                        "count": "[length(variables('RGroleDefinitionIds'))]"
                      },
                      "condition": "[parameters('addRGRoleAssignments')]",
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-{1}-RG', parameters('userIdentityName'), copyIndex())]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "resourcename": {
                            "value": "[parameters('userIdentityName')]"
                          },
                          "principalId": {
                            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityPrincipalId.value]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "roleDefinitionId": {
                            "value": "[variables('RGroleDefinitionIds')[copyIndex()]]"
                          },
                          "roleShortName": {
                            "value": "[variables('RGroleDefinitionIds')[copyIndex()]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "18441567381332934980"
                            }
                          },
                          "parameters": {
                            "resourcename": {
                              "type": "string"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "principalId": {
                              "type": "string"
                            },
                            "roleDefinitionId": {
                              "type": "string"
                            },
                            "roleShortName": {
                              "type": "string"
                            },
                            "utcValue": {
                              "type": "string",
                              "defaultValue": "[utcNow()]"
                            }
                          },
                          "variables": {
                            "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]",
                              "properties": {
                                "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                                "principalId": "[parameters('principalId')]",
                                "principalType": "ServicePrincipal",
                                "roleDefinitionId": "[variables('roleIdtoUse')]"
                              }
                            }
                          ],
                          "outputs": {
                            "roleassignmentname": {
                              "type": "string",
                              "value": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location')))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "userManagedIdentityPrincipalId": {
                      "type": "string",
                      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityPrincipalId.value]"
                    },
                    "userManagedIdentityClientId": {
                      "type": "string",
                      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityClientId.value]"
                    },
                    "userManagedIdentityResourceId": {
                      "type": "string",
                      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityResourceId.value]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('AMP-{0}-UMI-AzFun-{1}', parameters('instanceName'), parameters('location'))]",
              "location": "[deployment().location]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "Tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "roleDefinitionIds": {
                    "value": "[variables('backendFunctionRoleDefinitionIds')]"
                  },
                  "userIdentityName": {
                    "value": "[format('AMP-{0}-UMI-Function', parameters('instanceName'))]"
                  },
                  "mgname": {
                    "value": "[parameters('mgname')]"
                  },
                  "resourceGroupName": {
                    "value": "[parameters('resourceGroupName')]"
                  },
                  "subscriptionId": {
                    "value": "[parameters('subscriptionId')]"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "1419658493773483259"
                    }
                  },
                  "parameters": {
                    "location": {
                      "type": "string"
                    },
                    "Tags": {
                      "type": "object"
                    },
                    "roleDefinitionIds": {
                      "type": "array"
                    },
                    "userIdentityName": {
                      "type": "string"
                    },
                    "mgname": {
                      "type": "string"
                    },
                    "subscriptionId": {
                      "type": "string"
                    },
                    "resourceGroupName": {
                      "type": "string"
                    },
                    "addRGRoleAssignments": {
                      "type": "bool",
                      "defaultValue": false
                    },
                    "solutionTag": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "RGroleDefinitionIds": [
                      "b24988ac-6180-42a0-ab88-20f7382dd24c",
                      "22926164-76b3-42b3-bc55-97df8dab3e41"
                    ]
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-{1}', parameters('userIdentityName'), parameters('location'))]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "Tags": {
                            "value": "[parameters('Tags')]"
                          },
                          "userIdentityName": {
                            "value": "[parameters('userIdentityName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "1567859393178125257"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string"
                            },
                            "Tags": {
                              "type": "object"
                            },
                            "userIdentityName": {
                              "type": "string"
                            }
                          },
                          "resources": [
                            {
                              "type": "Microsoft.ManagedIdentity/userAssignedIdentities",
                              "apiVersion": "2023-01-31",
                              "name": "[parameters('userIdentityName')]",
                              "location": "[parameters('location')]",
                              "tags": "[parameters('Tags')]"
                            }
                          ],
                          "outputs": {
                            "userManagedIdentityPrincipalId": {
                              "type": "string",
                              "value": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userIdentityName')), '2023-01-31').principalId]"
                            },
                            "userManagedIdentityClientId": {
                              "type": "string",
                              "value": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userIdentityName')), '2023-01-31').clientId]"
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('userIdentityName'))]"
                            }
                          }
                        }
                      }
                    },
                    {
                      "copy": {
                        "name": "userIdentityRoleAssignments",
                        "count": "[length(parameters('roleDefinitionIds'))]"
                      },
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-{1}-{2}', parameters('userIdentityName'), copyIndex(), parameters('location'))]",
                      "scope": "[format('Microsoft.Management/managementGroups/{0}', parameters('mgname'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "resourcename": {
                            "value": "[parameters('userIdentityName')]"
                          },
                          "principalId": {
                            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityPrincipalId.value]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "roleDefinitionId": {
                            "value": "[parameters('roleDefinitionIds')[copyIndex()]]"
                          },
                          "roleShortName": {
                            "value": "[parameters('roleDefinitionIds')[copyIndex()]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "13770438938236428861"
                            }
                          },
                          "parameters": {
                            "resourcename": {
                              "type": "string"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "principalId": {
                              "type": "string"
                            },
                            "roleDefinitionId": {
                              "type": "string"
                            },
                            "roleShortName": {
                              "type": "string"
                            },
                            "utcValue": {
                              "type": "string",
                              "defaultValue": "[utcNow()]"
                            }
                          },
                          "variables": {
                            "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(managementGroup().name, parameters('principalId'), parameters('roleDefinitionId'))]",
                              "properties": {
                                "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                                "principalId": "[parameters('principalId')]",
                                "principalType": "ServicePrincipal",
                                "roleDefinitionId": "[variables('roleIdtoUse')]"
                              }
                            }
                          ],
                          "outputs": {
                            "roleassignmentname": {
                              "type": "string",
                              "value": "[guid(managementGroup().name, parameters('principalId'), parameters('roleDefinitionId'))]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location')))]"
                      ]
                    },
                    {
                      "copy": {
                        "name": "userIdentityRoleAssignmentRG",
                        "count": "[length(variables('RGroleDefinitionIds'))]"
                      },
                      "condition": "[parameters('addRGRoleAssignments')]",
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('{0}-{1}-RG', parameters('userIdentityName'), copyIndex())]",
                      "subscriptionId": "[parameters('subscriptionId')]",
                      "resourceGroup": "[parameters('resourceGroupName')]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "resourcename": {
                            "value": "[parameters('userIdentityName')]"
                          },
                          "principalId": {
                            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityPrincipalId.value]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "roleDefinitionId": {
                            "value": "[variables('RGroleDefinitionIds')[copyIndex()]]"
                          },
                          "roleShortName": {
                            "value": "[variables('RGroleDefinitionIds')[copyIndex()]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "18441567381332934980"
                            }
                          },
                          "parameters": {
                            "resourcename": {
                              "type": "string"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "principalId": {
                              "type": "string"
                            },
                            "roleDefinitionId": {
                              "type": "string"
                            },
                            "roleShortName": {
                              "type": "string"
                            },
                            "utcValue": {
                              "type": "string",
                              "defaultValue": "[utcNow()]"
                            }
                          },
                          "variables": {
                            "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]",
                              "properties": {
                                "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                                "principalId": "[parameters('principalId')]",
                                "principalType": "ServicePrincipal",
                                "roleDefinitionId": "[variables('roleIdtoUse')]"
                              }
                            }
                          ],
                          "outputs": {
                            "roleassignmentname": {
                              "type": "string",
                              "value": "[guid(subscription().id, parameters('principalId'), parameters('roleDefinitionId'))]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location')))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "userManagedIdentityPrincipalId": {
                      "type": "string",
                      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityPrincipalId.value]"
                    },
                    "userManagedIdentityClientId": {
                      "type": "string",
                      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityClientId.value]"
                    },
                    "userManagedIdentityResourceId": {
                      "type": "string",
                      "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('{0}-{1}', parameters('userIdentityName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityResourceId.value]"
                    }
                  }
                }
              }
            },
            {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('amp-{0}-kv-{1}', parameters('instanceName'), substring(uniqueString(parameters('subscriptionId'), parameters('resourceGroupName'), 'keyvault'), 0, 6))]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[parameters('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "kvName": {
                    "value": "[format('amp-{0}-kv-{1}', parameters('instanceName'), substring(uniqueString(parameters('subscriptionId'), parameters('resourceGroupName'), 'keyvault'), 0, 6))]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "Tags": {
                    "value": "[parameters('Tags')]"
                  },
                  "functionName": {
                    "value": "[parameters('functionname')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "16236972932648714751"
                    }
                  },
                  "parameters": {
                    "kvName": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string"
                    },
                    "Tags": {
                      "type": "object"
                    },
                    "functionName": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "vaultUri": "[format('https://{0}.vault.azure.net', parameters('kvName'))]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.KeyVault/vaults",
                      "apiVersion": "2021-06-01-preview",
                      "name": "[parameters('kvName')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('Tags')]",
                      "properties": {
                        "sku": {
                          "family": "A",
                          "name": "standard"
                        },
                        "tenantId": "[subscription().tenantId]",
                        "enabledForDeployment": false,
                        "enabledForDiskEncryption": false,
                        "enabledForTemplateDeployment": false,
                        "enableSoftDelete": true,
                        "softDeleteRetentionInDays": 90,
                        "enableRbacAuthorization": true,
                        "vaultUri": "[variables('vaultUri')]",
                        "provisioningState": "Succeeded",
                        "publicNetworkAccess": "Enabled",
                        "enablePurgeProtection": true
                      }
                    },
                    {
                      "type": "Microsoft.KeyVault/vaults/secrets",
                      "apiVersion": "2021-11-01-preview",
                      "name": "[format('{0}/{1}', parameters('kvName'), 'FunctionKey')]",
                      "tags": "[parameters('Tags')]",
                      "properties": {
                        "attributes": {
                          "enabled": true
                        },
                        "contentType": "string",
                        "value": "[listKeys(resourceId('Microsoft.Web/sites/host', parameters('functionName'), 'default'), '2022-09-01').functionKeys.monitoringKey]"
                      },
                      "dependsOn": [
                        "[resourceId('Microsoft.KeyVault/vaults', parameters('kvName'))]"
                      ]
                    }
                  ],
                  "outputs": {
                    "kvResourceId": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.KeyVault/vaults', parameters('kvName'))]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', parameters('functionname'))]"
              ]
            },
            {
              "copy": {
                "name": "userIdentityRoleAssignments",
                "count": "[length(variables('logicappRequiredRoleassignments'))]"
              },
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('logiapprbac-{0}', copyIndex())]",
              "scope": "[format('Microsoft.Management/managementGroups/{0}', parameters('mgname'))]",
              "location": "[deployment().location]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourcename": {
                    "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('amp-{0}-kv-{1}', parameters('instanceName'), substring(uniqueString(parameters('subscriptionId'), parameters('resourceGroupName'), 'keyvault'), 0, 6))), '2022-09-01').outputs.kvResourceId.value]"
                  },
                  "principalId": {
                    "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', parameters('logicappname')), '2022-09-01').outputs.logicAppPrincipalId.value]"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  },
                  "roleDefinitionId": {
                    "value": "[variables('logicappRequiredRoleassignments')[copyIndex()]]"
                  },
                  "roleShortName": {
                    "value": "[variables('logicappRequiredRoleassignments')[copyIndex()]]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "13770438938236428861"
                    }
                  },
                  "parameters": {
                    "resourcename": {
                      "type": "string"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "principalId": {
                      "type": "string"
                    },
                    "roleDefinitionId": {
                      "type": "string"
                    },
                    "roleShortName": {
                      "type": "string"
                    },
                    "utcValue": {
                      "type": "string",
                      "defaultValue": "[utcNow()]"
                    }
                  },
                  "variables": {
                    "roleIdtoUse": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', parameters('roleDefinitionId'))]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Authorization/roleAssignments",
                      "apiVersion": "2022-04-01",
                      "name": "[guid(managementGroup().name, parameters('principalId'), parameters('roleDefinitionId'))]",
                      "properties": {
                        "description": "[format('{0}-{1}-{2}-{3}', parameters('solutionTag'), parameters('roleShortName'), parameters('resourcename'), parameters('utcValue'))]",
                        "principalId": "[parameters('principalId')]",
                        "principalType": "ServicePrincipal",
                        "roleDefinitionId": "[variables('roleIdtoUse')]"
                      }
                    }
                  ],
                  "outputs": {
                    "roleassignmentname": {
                      "type": "string",
                      "value": "[guid(managementGroup().name, parameters('principalId'), parameters('roleDefinitionId'))]"
                    }
                  }
                }
              },
              "dependsOn": [
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('amp-{0}-kv-{1}', parameters('instanceName'), substring(uniqueString(parameters('subscriptionId'), parameters('resourceGroupName'), 'keyvault'), 0, 6)))]",
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', parameters('logicappname'))]"
              ]
            }
          ],
          "outputs": {
            "packsUserManagedIdentityId": {
              "type": "string",
              "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('AMP-{0}-UMI-Packs-{1}', parameters('instanceName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityPrincipalId.value]"
            },
            "packsUserManagedResourceId": {
              "type": "string",
              "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('AMP-{0}-UMI-Packs-{1}', parameters('instanceName'), parameters('location'))), '2022-09-01').outputs.userManagedIdentityResourceId.value]"
            },
            "dceId": {
              "type": "string",
              "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('AMP-{0}-DCE-{1}', parameters('instanceName'), parameters('location'))), '2022-09-01').outputs.dceId.value]"
            }
          }
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', 'logAnalytics-Deployment')]",
        "[subscriptionResourceId(parameters('subscriptionId'), 'Microsoft.Resources/deployments', format('RGMonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName')))]"
      ]
    },
    {
      "condition": "[variables('deployPacks')]",
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "DeployAllPacks",
      "location": "[deployment().location]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "location": {
            "value": "[parameters('location')]"
          },
          "dceId": {
            "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('MonitoringPacks-backend-{0}', parameters('instanceName'))), '2022-09-01').outputs.dceId.value]"
          },
          "mgname": {
            "value": "[parameters('mgname')]"
          },
          "customerTags": {
            "value": "[parameters('customerTags')]"
          },
          "subscriptionId": {
            "value": "[parameters('subscriptionId')]"
          },
          "useExistingAG": {
            "value": "[parameters('useExistingAG')]"
          },
          "userManagedIdentityResourceId": {
            "value": "[reference(extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('MonitoringPacks-backend-{0}', parameters('instanceName'))), '2022-09-01').outputs.packsUserManagedResourceId.value]"
          },
          "workspaceId": "[if(parameters('createNewLogAnalyticsWS'), createObject('value', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', 'logAnalytics-Deployment'), '2022-09-01').outputs.lawresourceid.value), createObject('value', parameters('existingLogAnalyticsWSId')))]",
          "actionGroupName": {
            "value": "[parameters('actionGroupName')]"
          },
          "resourceGroupId": "[if(parameters('createNewResourceGroup'), createObject('value', reference(subscriptionResourceId(parameters('subscriptionId'), 'Microsoft.Resources/deployments', format('RGMonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName'))), '2022-09-01').outputs.newResourceGroupId.value), createObject('value', parameters('resourceGroupId')))]",
          "emailreceiver": {
            "value": "[parameters('emailreceiver')]"
          },
          "emailreiceversemail": {
            "value": "[parameters('emailreiceversemail')]"
          },
          "grafanaResourceId": "[if(parameters('deployGrafana'), if(parameters('newGrafana'), createObject('value', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('azureManagedGrafana-{0}', parameters('instanceName'))), '2022-09-01').outputs.grafanaId.value), createObject('value', parameters('existingGrafanaResourceId'))), createObject('value', ''))]",
          "solutionTag": {
            "value": "[variables('solutionTag')]"
          },
          "solutionVersion": {
            "value": "[variables('solutionVersion')]"
          },
          "existingActionGroupResourceId": {
            "value": "[parameters('existingActionGroupId')]"
          },
          "deployIaaSPacks": {
            "value": "[or(parameters('deployIaaSPacks'), parameters('deployAllPacks'))]"
          },
          "storageAccountName": {
            "value": "[parameters('storageAccountName')]"
          },
          "imageGalleryName": {
            "value": "[variables('ImageGalleryName')]"
          },
          "instanceName": {
            "value": "[parameters('instanceName')]"
          },
          "deployGrafana": {
            "value": "[parameters('deployGrafana')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.32.4.45862",
              "templateHash": "1298710547514674957"
            }
          },
          "parameters": {
            "mgname": {
              "type": "string"
            },
            "subscriptionId": {
              "type": "string"
            },
            "resourceGroupId": {
              "type": "string"
            },
            "location": {
              "type": "string",
              "metadata": {
                "description": "location for the deployment."
              }
            },
            "useExistingAG": {
              "type": "bool",
              "metadata": {
                "description": "If set to true, a new Action group will be created"
              }
            },
            "workspaceId": {
              "type": "string",
              "metadata": {
                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
              }
            },
            "solutionTag": {
              "type": "string"
            },
            "solutionVersion": {
              "type": "string"
            },
            "dceId": {
              "type": "string",
              "metadata": {
                "description": "Full resource ID of the data collection endpoint to be used for the deployment."
              }
            },
            "userManagedIdentityResourceId": {
              "type": "string",
              "metadata": {
                "description": "Full resource ID of the user managed identity to be used for the deployment"
              }
            },
            "grafanaResourceId": {
              "type": "string",
              "defaultValue": ""
            },
            "customerTags": {
              "type": "object"
            },
            "existingActionGroupResourceId": {
              "type": "string"
            },
            "deployIaaSPacks": {
              "type": "bool"
            },
            "storageAccountName": {
              "type": "string"
            },
            "imageGalleryName": {
              "type": "string"
            },
            "instanceName": {
              "type": "string"
            },
            "deployGrafana": {
              "type": "bool"
            },
            "actionGroupName": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Name of the Action Group to be used or created."
              }
            },
            "emailreceiver": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Email receiver names to be used for the Action Group if being created."
              }
            },
            "emailreiceversemail": {
              "type": "string",
              "defaultValue": "",
              "metadata": {
                "description": "Email addresses to be used for the Action Group if being created."
              }
            }
          },
          "variables": {
            "solutionTagComponents": "MonitorStarterPacksComponents",
            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
            "tempTags": {
              "[format('{0}', variables('solutionTagComponents'))]": "BackendComponent",
              "solutionVersion": "[parameters('solutionVersion')]",
              "instanceName": "[parameters('instanceName')]"
            },
            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]"
          },
          "resources": [
            {
              "condition": "[not(parameters('useExistingAG'))]",
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('deployAG-new-{0}-{1}', parameters('actionGroupName'), parameters('location'))]",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[variables('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "emailreceiver": {
                    "value": "[parameters('emailreceiver')]"
                  },
                  "emailreiceversemail": {
                    "value": "[parameters('emailreiceversemail')]"
                  },
                  "Tags": {
                    "value": "[variables('Tags')]"
                  },
                  "location": {
                    "value": "global"
                  },
                  "groupshortname": {
                    "value": "[parameters('actionGroupName')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "12883385540442311034"
                    }
                  },
                  "parameters": {
                    "location": {
                      "type": "string"
                    },
                    "groupshortname": {
                      "type": "string"
                    },
                    "emailreceiver": {
                      "type": "string"
                    },
                    "emailreiceversemail": {
                      "type": "string"
                    },
                    "Tags": {
                      "type": "object"
                    }
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Insights/actionGroups",
                      "apiVersion": "2023-01-01",
                      "name": "[parameters('groupshortname')]",
                      "location": "[parameters('location')]",
                      "tags": "[parameters('Tags')]",
                      "properties": {
                        "groupShortName": "[parameters('groupshortname')]",
                        "enabled": true,
                        "emailReceivers": [
                          {
                            "name": "[parameters('emailreceiver')]",
                            "emailAddress": "[parameters('emailreiceversemail')]",
                            "useCommonAlertSchema": false
                          }
                        ]
                      }
                    }
                  ],
                  "outputs": {
                    "agGroupId": {
                      "type": "string",
                      "value": "[resourceId('Microsoft.Insights/actionGroups', parameters('groupshortname'))]"
                    }
                  }
                }
              }
            },
            {
              "condition": "[parameters('deployIaaSPacks')]",
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('deployIaaSPacks-{0}-{1}', parameters('instanceName'), parameters('location'))]",
              "location": "[deployment().location]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "workspaceId": {
                    "value": "[parameters('workspaceId')]"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  },
                  "solutionVersion": {
                    "value": "[parameters('solutionVersion')]"
                  },
                  "dceId": {
                    "value": "[parameters('dceId')]"
                  },
                  "userManagedIdentityResourceId": {
                    "value": "[parameters('userManagedIdentityResourceId')]"
                  },
                  "actionGroupResourceId": "[if(parameters('useExistingAG'), createObject('value', parameters('existingActionGroupResourceId')), createObject('value', reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), variables('resourceGroupName')), 'Microsoft.Resources/deployments', format('deployAG-new-{0}-{1}', parameters('actionGroupName'), parameters('location'))), '2022-09-01').outputs.agGroupId.value))]",
                  "customerTags": {
                    "value": "[parameters('customerTags')]"
                  },
                  "mgname": {
                    "value": "[parameters('mgname')]"
                  },
                  "resourceGroupId": {
                    "value": "[parameters('resourceGroupId')]"
                  },
                  "subscriptionId": {
                    "value": "[parameters('subscriptionId')]"
                  },
                  "storageAccountName": {
                    "value": "[parameters('storageAccountName')]"
                  },
                  "imageGalleryName": {
                    "value": "[parameters('imageGalleryName')]"
                  },
                  "instanceName": {
                    "value": "[parameters('instanceName')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "5463922814552443040"
                    }
                  },
                  "parameters": {
                    "mgname": {
                      "type": "string"
                    },
                    "subscriptionId": {
                      "type": "string"
                    },
                    "resourceGroupId": {
                      "type": "string"
                    },
                    "location": {
                      "type": "string",
                      "metadata": {
                        "description": "location for the deployment."
                      }
                    },
                    "workspaceId": {
                      "type": "string",
                      "metadata": {
                        "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                      }
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "solutionVersion": {
                      "type": "string"
                    },
                    "dceId": {
                      "type": "string",
                      "metadata": {
                        "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                      }
                    },
                    "userManagedIdentityResourceId": {
                      "type": "string",
                      "metadata": {
                        "description": "Full resource ID of the user managed identity to be used for the deployment"
                      }
                    },
                    "customerTags": {
                      "type": "object"
                    },
                    "actionGroupResourceId": {
                      "type": "string"
                    },
                    "storageAccountName": {
                      "type": "string"
                    },
                    "imageGalleryName": {
                      "type": "string"
                    },
                    "instanceName": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "solutionTagComponents": "MonitorStarterPacksComponents",
                    "tempTags": {
                      "[format('{0}', parameters('solutionTag'))]": "BackendComponent",
                      "solutionVersion": "[parameters('solutionVersion')]",
                      "instanceName": "[parameters('instanceName')]",
                      "MonitoringPackType": "IaaS"
                    },
                    "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                    "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('ADDSPack-{0}-{1}', parameters('instanceName'), parameters('location'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "mgname": {
                            "value": "[parameters('mgname')]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "subscriptionId": {
                            "value": "[parameters('subscriptionId')]"
                          },
                          "userManagedIdentityResourceId": {
                            "value": "[parameters('userManagedIdentityResourceId')]"
                          },
                          "imageGalleryName": {
                            "value": "[parameters('imageGalleryName')]"
                          },
                          "resourceGroupId": {
                            "value": "[parameters('resourceGroupId')]"
                          },
                          "storageAccountname": {
                            "value": "[parameters('storageAccountName')]"
                          },
                          "tableName": {
                            "value": "addsmonitoring"
                          },
                          "tags": {
                            "value": "[variables('Tags')]"
                          },
                          "actionGroupResourceId": {
                            "value": "[parameters('actionGroupResourceId')]"
                          },
                          "customerTags": {
                            "value": "[parameters('customerTags')]"
                          },
                          "workspaceId": {
                            "value": "[parameters('workspaceId')]"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          },
                          "solutionVersion": {
                            "value": "[parameters('solutionVersion')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "13721024895843585629"
                            }
                          },
                          "parameters": {
                            "packtag": {
                              "type": "string",
                              "defaultValue": "ADDS",
                              "metadata": {
                                "description": "Name of the DCR rule to be created"
                              }
                            },
                            "actionGroupResourceId": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string",
                              "metadata": {
                                "description": "location for the deployment."
                              }
                            },
                            "workspaceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                              }
                            },
                            "solutionTag": {
                              "type": "string",
                              "defaultValue": "MonitorStarterPacks"
                            },
                            "solutionVersion": {
                              "type": "string"
                            },
                            "dceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                              }
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the user managed identity to be used for the deployment"
                              }
                            },
                            "mgname": {
                              "type": "string"
                            },
                            "subscriptionId": {
                              "type": "string"
                            },
                            "resourceGroupId": {
                              "type": "string"
                            },
                            "instanceName": {
                              "type": "string"
                            },
                            "customerTags": {
                              "type": "object"
                            },
                            "storageAccountname": {
                              "type": "string"
                            },
                            "imageGalleryName": {
                              "type": "string"
                            },
                            "tableName": {
                              "type": "string"
                            },
                            "tags": {
                              "type": "object"
                            }
                          },
                          "variables": {
                            "rulename": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "tempTags": {
                              "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                              "MonitoringPackType": "IaaS",
                              "solutionVersion": "[parameters('solutionVersion')]"
                            },
                            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                            "workspaceFriendlyName": "[split(parameters('workspaceId'), '/')[8]]",
                            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
                            "kind": "Windows",
                            "ruleshortname": "[format('{0}-collection', parameters('packtag'))]",
                            "appName": "[format('{0}-collection', parameters('packtag'))]",
                            "appDescription": "[format('{0} Collection - {1}', parameters('packtag'), parameters('instanceName'))]",
                            "OS": "Windows",
                            "xPathQueries": [
                              "Directory Service!*[System[(Eventlevel=1)]]",
                              "DNS Server!*[System[(Eventlevel=1)]]",
                              "Active Directory Web Services!*[System[(Eventlevel=1)]]",
                              "DFS Replication!*[System[(Eventlevel=1)]]"
                            ],
                            "performanceCounters": [
                              "\\Memory()\\Available Bytes",
                              "\\Memory()\\Committed Bytes",
                              "\\DirectoryServices(NTDS)\\DS Search sub-operations/sec",
                              "\\Security System-Wide Statistics()\\KDC AS Requests",
                              "\\Security System-Wide Statistics()\\KDC TGS Requests",
                              "\\Security System-Wide Statistics()\\Kerberos Authentications",
                              "\\DirectoryServices(NTDS)\\LDAP Client Sessions",
                              "\\DirectoryServices(NTDS)\\LDAP Searches/sec",
                              "\\DirectoryServices(NTDS)\\LDAP UDP operations/sec",
                              "\\DirectoryServices(NTDS)\\LDAP Writes/sec",
                              "\\Process(LSASS)\\Handle Count",
                              "\\Process(LSASS)\\Private Bytes",
                              "\\Process(LSASS)\\% Processor Time",
                              "\\Security System-Wide Statistics()\\NTLM Authentications",
                              "\\Memory()\\Pages/sec",
                              "\\Processor(_Total)\\% Processor Time",
                              "\\Server()\\Server Sessions",
                              "\\System()\\System Up Time",
                              "\\TCPv4()\\Connections Established",
                              "\\TCPv6()\\Connections Established",
                              "\\DirectoryServices(NTDS)\\DRA Inbound Bytes Compressed (Between Sites, Before Compression)/sec",
                              "\\DirectoryServices(NTDS)\\DRA Inbound Bytes Compressed (Between Sites, After Compression)/sec",
                              "\\DirectoryServices(NTDS)\\DRA Inbound Bytes Not Compressed (Within Site)/sec",
                              "\\DirectoryServices(NTDS)\\DRA Inbound Bytes Total/sec",
                              "\\DirectoryServices(NTDS)\\DRA Outbound Bytes Compressed (Between Sites, After Compression)/sec",
                              "\\DirectoryServices(NTDS)\\DRA Outbound Bytes Compressed (Between Sites, Before Compression)/sec",
                              "\\DirectoryServices(NTDS)\\DRA Outbound Bytes Not Compressed (Within Site)/sec",
                              "\\DirectoryServices(NTDS)\\DRA Outbound Bytes Total/sec",
                              "\\Process(dns)\\% Processor Time",
                              "\\DNS()\\Total Query Received/sec",
                              "\\Process(dns)\\Private Bytes",
                              "\\DirectoryServices(NTDS)\\ATQ Outstanding Queued Requests",
                              "\\DirectoryServices(NTDS)\\ATQ Request Latency",
                              "\\DirectoryServices(NTDS)\\ATQ Threads Other",
                              "\\DirectoryServices(NTDS)\\ATQ Threads LDAP",
                              "\\DirectoryServices(NTDS)\\ATQ Threads Total"
                            ]
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('dcrPerformance-{0}-{1}-{2}', parameters('packtag'), parameters('instanceName'), parameters('location'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "rulename": {
                                    "value": "[variables('rulename')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "wsfriendlyname": {
                                    "value": "[variables('workspaceFriendlyName')]"
                                  },
                                  "kind": {
                                    "value": "[variables('kind')]"
                                  },
                                  "xPathQueries": {
                                    "value": "[variables('xPathQueries')]"
                                  },
                                  "counterSpecifiers": {
                                    "value": "[variables('performanceCounters')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "dceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "15691414683408659274"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "rulename": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "kind": {
                                      "type": "string",
                                      "defaultValue": "Windows"
                                    },
                                    "wsfriendlyname": {
                                      "type": "string",
                                      "defaultValue": "TBD"
                                    },
                                    "xPathQueries": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "counterSpecifiers": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "samplingFrequencyInSeconds": {
                                      "type": "int",
                                      "defaultValue": 300
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "dceId": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('rulename')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "[parameters('kind')]",
                                      "properties": {
                                        "dataCollectionEndpointId": "[parameters('dceId')]",
                                        "description": "[format('Data Collection Rule for {0}}} - {1}}}', parameters('kind'), parameters('rulename'))]",
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('workspaceId')]",
                                              "name": "[parameters('wsfriendlyname')]"
                                            }
                                          ]
                                        },
                                        "dataSources": {
                                          "windowsEventLogs": "[if(empty(parameters('xPathQueries')), null(), createArray(createObject('streams', createArray('Microsoft-Event'), 'xPathQueries', parameters('xPathQueries'), 'name', 'EventLogsDataSource')))]",
                                          "performanceCounters": [
                                            {
                                              "streams": [
                                                "Microsoft-Perf"
                                              ],
                                              "samplingFrequencyInSeconds": "[parameters('samplingFrequencyInSeconds')]",
                                              "counterSpecifiers": "[parameters('counterSpecifiers')]",
                                              "name": "PerfCountersDataSource"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-Event",
                                              "Microsoft-Perf"
                                            ],
                                            "destinations": [
                                              "[parameters('wsfriendlyname')]"
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "dcrId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('rulename'))]"
                                    }
                                  }
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('client-{0}-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('location'))]",
                              "location": "[deployment().location]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "dceId": {
                                    "value": "[parameters('dceId')]"
                                  },
                                  "instanceName": {
                                    "value": "[parameters('instanceName')]"
                                  },
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "imageGalleryName": {
                                    "value": "[parameters('imageGalleryName')]"
                                  },
                                  "mgname": {
                                    "value": "[parameters('mgname')]"
                                  },
                                  "resourceGroupId": {
                                    "value": "[parameters('resourceGroupId')]"
                                  },
                                  "storageAccountname": {
                                    "value": "[parameters('storageAccountname')]"
                                  },
                                  "subscriptionId": {
                                    "value": "[parameters('subscriptionId')]"
                                  },
                                  "tableName": {
                                    "value": "[parameters('tableName')]"
                                  },
                                  "tags": {
                                    "value": "[parameters('tags')]"
                                  },
                                  "userManagedIdentityResourceId": {
                                    "value": "[parameters('userManagedIdentityResourceId')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "packtag": {
                                    "value": "[parameters('packtag')]"
                                  },
                                  "solutionTag": {
                                    "value": "[parameters('solutionTag')]"
                                  },
                                  "appDescription": {
                                    "value": "[variables('appDescription')]"
                                  },
                                  "appName": {
                                    "value": "[variables('appName')]"
                                  },
                                  "OS": {
                                    "value": "[variables('OS')]"
                                  },
                                  "ruleshortname": {
                                    "value": "[variables('ruleshortname')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "1338942321988296595"
                                    }
                                  },
                                  "parameters": {
                                    "packtag": {
                                      "type": "string",
                                      "defaultValue": "ADDS",
                                      "metadata": {
                                        "description": "Name of the DCR rule to be created"
                                      }
                                    },
                                    "location": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "location for the deployment."
                                      }
                                    },
                                    "workspaceId": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                                      }
                                    },
                                    "solutionTag": {
                                      "type": "string"
                                    },
                                    "dceId": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                                      }
                                    },
                                    "userManagedIdentityResourceId": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Full resource ID of the user managed identity to be used for the deployment"
                                      }
                                    },
                                    "mgname": {
                                      "type": "string"
                                    },
                                    "subscriptionId": {
                                      "type": "string"
                                    },
                                    "resourceGroupId": {
                                      "type": "string"
                                    },
                                    "storageAccountname": {
                                      "type": "string"
                                    },
                                    "imageGalleryName": {
                                      "type": "string"
                                    },
                                    "tableName": {
                                      "type": "string"
                                    },
                                    "tags": {
                                      "type": "object"
                                    },
                                    "instanceName": {
                                      "type": "string"
                                    },
                                    "ruleshortname": {
                                      "type": "string"
                                    },
                                    "appName": {
                                      "type": "string"
                                    },
                                    "appDescription": {
                                      "type": "string"
                                    },
                                    "OS": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
                                    "tableNameToUse": "[format('{0}_CL', parameters('tableName'))]",
                                    "lawFriendlyName": "[split(parameters('workspaceId'), '/')[8]]"
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "addscollectionapp",
                                      "subscriptionId": "[parameters('subscriptionId')]",
                                      "resourceGroup": "[variables('resourceGroupName')]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "aigname": {
                                            "value": "[parameters('imageGalleryName')]"
                                          },
                                          "appDescription": {
                                            "value": "[parameters('appDescription')]"
                                          },
                                          "appName": {
                                            "value": "[parameters('appName')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "osType": {
                                            "value": "[parameters('OS')]"
                                          },
                                          "tags": {
                                            "value": "[parameters('tags')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "17117017597267615596"
                                            }
                                          },
                                          "parameters": {
                                            "location": {
                                              "type": "string"
                                            },
                                            "aigname": {
                                              "type": "string"
                                            },
                                            "osType": {
                                              "type": "string"
                                            },
                                            "appDescription": {
                                              "type": "string"
                                            },
                                            "appName": {
                                              "type": "string"
                                            },
                                            "tags": {
                                              "type": "object"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "type": "Microsoft.Compute/galleries/applications",
                                              "apiVersion": "2022-03-03",
                                              "name": "[format('{0}/{1}', parameters('aigname'), parameters('appName'))]",
                                              "location": "[parameters('location')]",
                                              "tags": "[parameters('tags')]",
                                              "properties": {
                                                "supportedOSType": "[parameters('osType')]",
                                                "description": "[parameters('appDescription')]"
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    },
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "upload-addscollectionapp",
                                      "subscriptionId": "[parameters('subscriptionId')]",
                                      "resourceGroup": "[variables('resourceGroupName')]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "containerName": {
                                            "value": "applications"
                                          },
                                          "filename": {
                                            "value": "addscollection.zip"
                                          },
                                          "storageAccountName": {
                                            "value": "[parameters('storageAccountname')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "tags": {
                                            "value": "[parameters('tags')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "4498386373395502236"
                                            }
                                          },
                                          "parameters": {
                                            "location": {
                                              "type": "string"
                                            },
                                            "storageAccountName": {
                                              "type": "string"
                                            },
                                            "sasExpiry": {
                                              "type": "string",
                                              "defaultValue": "[dateTimeAdd(utcNow(), 'PT2H')]"
                                            },
                                            "filename": {
                                              "type": "string"
                                            },
                                            "containerName": {
                                              "type": "string"
                                            },
                                            "tags": {
                                              "type": "object"
                                            }
                                          },
                                          "variables": {
                                            "$fxv#0": "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",
                                            "discoveryContainerName": "applications",
                                            "tempfilename": "download.tmp",
                                            "sasConfig": {
                                              "signedResourceTypes": "sco",
                                              "signedPermission": "r",
                                              "signedServices": "b",
                                              "signedExpiry": "[parameters('sasExpiry')]",
                                              "signedProtocol": "https",
                                              "keyToSign": "key2"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "type": "Microsoft.Resources/deploymentScripts",
                                              "apiVersion": "2020-10-01",
                                              "name": "deployscript-addappdiscovery",
                                              "tags": "[parameters('tags')]",
                                              "location": "[parameters('location')]",
                                              "kind": "AzureCLI",
                                              "properties": {
                                                "azCliVersion": "2.42.0",
                                                "timeout": "PT5M",
                                                "retentionInterval": "PT1H",
                                                "environmentVariables": [
                                                  {
                                                    "name": "AZURE_STORAGE_ACCOUNT",
                                                    "value": "[parameters('storageAccountName')]"
                                                  },
                                                  {
                                                    "name": "AZURE_STORAGE_KEY",
                                                    "secureValue": "[listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').keys[0].value]"
                                                  },
                                                  {
                                                    "name": "CONTENT",
                                                    "value": "[variables('$fxv#0')]"
                                                  }
                                                ],
                                                "scriptContent": "[format('echo \"$CONTENT\" > {0} && cat {1} | base64 -d > {2} && az storage blob upload -f {3} -c {4} -n {5} --overwrite true', variables('tempfilename'), variables('tempfilename'), parameters('filename'), parameters('filename'), variables('discoveryContainerName'), parameters('filename'))]"
                                              }
                                            }
                                          ],
                                          "outputs": {
                                            "fileURL": {
                                              "type": "string",
                                              "value": "[format('{0}{1}/{2}?{3}', reference(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01').primaryEndpoints.blob, parameters('containerName'), parameters('filename'), listAccountSAS(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2023-01-01', variables('sasConfig')).accountSasToken)]"
                                            }
                                          }
                                        }
                                      }
                                    },
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "addscollectionappversion",
                                      "subscriptionId": "[parameters('subscriptionId')]",
                                      "resourceGroup": "[variables('resourceGroupName')]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "aigname": {
                                            "value": "[parameters('imageGalleryName')]"
                                          },
                                          "appName": {
                                            "value": "[parameters('appName')]"
                                          },
                                          "appVersionName": {
                                            "value": "1.0.0"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "targetRegion": {
                                            "value": "[parameters('location')]"
                                          },
                                          "mediaLink": {
                                            "value": "[reference(extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), variables('resourceGroupName')), 'Microsoft.Resources/deployments', 'upload-addscollectionapp'), '2022-09-01').outputs.fileURL.value]"
                                          },
                                          "installCommands": {
                                            "value": "powershell -command \"ren addscollection addscollection.zip; expand-archive ./addscollection.zip . ; ./install.ps1\""
                                          },
                                          "removeCommands": {
                                            "value": "powershell -command \"Unregister-ScheduledTask -TaskName 'AD DS Collection Task' '\\' \""
                                          },
                                          "tags": {
                                            "value": "[parameters('tags')]"
                                          },
                                          "packageFileName": {
                                            "value": "addscollection.zip"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "12441285522123093851"
                                            }
                                          },
                                          "parameters": {
                                            "aigname": {
                                              "type": "string"
                                            },
                                            "appName": {
                                              "type": "string"
                                            },
                                            "appVersionName": {
                                              "type": "string"
                                            },
                                            "location": {
                                              "type": "string"
                                            },
                                            "targetRegion": {
                                              "type": "string"
                                            },
                                            "mediaLink": {
                                              "type": "string"
                                            },
                                            "packageFileName": {
                                              "type": "string"
                                            },
                                            "installCommands": {
                                              "type": "string"
                                            },
                                            "removeCommands": {
                                              "type": "string"
                                            },
                                            "tags": {
                                              "type": "object"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "type": "Microsoft.Compute/galleries/applications/versions",
                                              "apiVersion": "2022-03-03",
                                              "name": "[format('{0}/{1}/{2}', parameters('aigname'), parameters('appName'), parameters('appVersionName'))]",
                                              "location": "[parameters('location')]",
                                              "tags": "[parameters('tags')]",
                                              "properties": {
                                                "publishingProfile": {
                                                  "source": {
                                                    "mediaLink": "[parameters('mediaLink')]"
                                                  },
                                                  "manageActions": {
                                                    "install": "[parameters('installCommands')]",
                                                    "remove": "[parameters('removeCommands')]"
                                                  },
                                                  "settings": {
                                                    "packageFileName": "[parameters('packageFileName')]"
                                                  },
                                                  "enableHealthCheck": false,
                                                  "targetRegions": [
                                                    {
                                                      "name": "[parameters('targetRegion')]",
                                                      "regionalReplicaCount": 1,
                                                      "storageAccountType": "Standard_LRS"
                                                    }
                                                  ],
                                                  "replicaCount": 1,
                                                  "excludeFromLatest": false,
                                                  "storageAccountType": "Standard_LRS"
                                                }
                                              }
                                            }
                                          ],
                                          "outputs": {
                                            "appVersionId": {
                                              "type": "string",
                                              "value": "[resourceId('Microsoft.Compute/galleries/applications/versions', parameters('aigname'), parameters('appName'), parameters('appVersionName'))]"
                                            }
                                          }
                                        }
                                      },
                                      "dependsOn": [
                                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), variables('resourceGroupName')), 'Microsoft.Resources/deployments', 'addscollectionapp')]",
                                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), variables('resourceGroupName')), 'Microsoft.Resources/deployments', 'upload-addscollectionapp')]"
                                      ]
                                    },
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "[variables('tableNameToUse')]",
                                      "subscriptionId": "[parameters('subscriptionId')]",
                                      "resourceGroup": "[variables('resourceGroupName')]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "parentname": {
                                            "value": "[variables('lawFriendlyName')]"
                                          },
                                          "tableName": {
                                            "value": "[variables('tableNameToUse')]"
                                          },
                                          "retentionDays": {
                                            "value": 31
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "2081426938105913058"
                                            }
                                          },
                                          "parameters": {
                                            "parentname": {
                                              "type": "string"
                                            },
                                            "tableName": {
                                              "type": "string"
                                            },
                                            "retentionDays": {
                                              "type": "int",
                                              "defaultValue": 31
                                            }
                                          },
                                          "resources": [
                                            {
                                              "type": "Microsoft.OperationalInsights/workspaces/tables",
                                              "apiVersion": "2022-10-01",
                                              "name": "[format('{0}/{1}', parameters('parentname'), parameters('tableName'))]",
                                              "properties": {
                                                "totalRetentionInDays": "[parameters('retentionDays')]",
                                                "plan": "Analytics",
                                                "schema": {
                                                  "name": "[parameters('tableName')]",
                                                  "columns": [
                                                    {
                                                      "name": "TimeGenerated",
                                                      "type": "datetime"
                                                    },
                                                    {
                                                      "name": "RawData",
                                                      "type": "string"
                                                    }
                                                  ]
                                                },
                                                "retentionInDays": "[parameters('retentionDays')]"
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    },
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "addscollectionDCR",
                                      "subscriptionId": "[parameters('subscriptionId')]",
                                      "resourceGroup": "[variables('resourceGroupName')]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "endpointResourceId": {
                                            "value": "[parameters('dceId')]"
                                          },
                                          "filepatterns": {
                                            "value": [
                                              "C:\\WindowsAzure\\ADDS\\*.csv"
                                            ]
                                          },
                                          "kind": {
                                            "value": "Windows"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "lawResourceId": {
                                            "value": "[parameters('workspaceId')]"
                                          },
                                          "OS": {
                                            "value": "Windows"
                                          },
                                          "solutionTag": {
                                            "value": "[parameters('solutionTag')]"
                                          },
                                          "tableName": {
                                            "value": "[variables('tableNameToUse')]"
                                          },
                                          "packtag": {
                                            "value": "ADDS"
                                          },
                                          "packtype": {
                                            "value": "IaaS"
                                          },
                                          "instanceName": {
                                            "value": "[parameters('instanceName')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "1128108251442731456"
                                            }
                                          },
                                          "parameters": {
                                            "location": {
                                              "type": "string"
                                            },
                                            "solutionTag": {
                                              "type": "string"
                                            },
                                            "lawResourceId": {
                                              "type": "string"
                                            },
                                            "tableName": {
                                              "type": "string"
                                            },
                                            "packtag": {
                                              "type": "string"
                                            },
                                            "kind": {
                                              "type": "string"
                                            },
                                            "filepatterns": {
                                              "type": "array"
                                            },
                                            "OS": {
                                              "type": "string"
                                            },
                                            "packtype": {
                                              "type": "string"
                                            },
                                            "endpointResourceId": {
                                              "type": "string",
                                              "metadata": {
                                                "description": "Specifies the resource id of the data collection endpoint."
                                              }
                                            },
                                            "instanceName": {
                                              "type": "string"
                                            }
                                          },
                                          "variables": {
                                            "streamName": "[format('Custom-{0}', parameters('tableName'))]",
                                            "lawFriendlyName": "[split(parameters('lawResourceId'), '/')[8]]"
                                          },
                                          "resources": [
                                            {
                                              "type": "Microsoft.Insights/dataCollectionRules",
                                              "apiVersion": "2022-06-01",
                                              "name": "[format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS'))]",
                                              "location": "[parameters('location')]",
                                              "tags": {
                                                "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                                                "MonitoringPackType": "[parameters('packtype')]"
                                              },
                                              "kind": "[parameters('kind')]",
                                              "properties": {
                                                "dataSources": {
                                                  "logFiles": [
                                                    {
                                                      "streams": [
                                                        "[variables('streamName')]"
                                                      ],
                                                      "filePatterns": "[parameters('filepatterns')]",
                                                      "format": "text",
                                                      "settings": {
                                                        "text": {
                                                          "recordStartTimestampFormat": "ISO 8601"
                                                        }
                                                      },
                                                      "name": "[parameters('tableName')]"
                                                    }
                                                  ]
                                                },
                                                "destinations": {
                                                  "logAnalytics": [
                                                    {
                                                      "workspaceResourceId": "[parameters('lawResourceId')]",
                                                      "name": "[variables('lawFriendlyName')]"
                                                    }
                                                  ]
                                                },
                                                "dataFlows": [
                                                  {
                                                    "streams": [
                                                      "[variables('streamName')]"
                                                    ],
                                                    "destinations": [
                                                      "[variables('lawFriendlyName')]"
                                                    ],
                                                    "transformKql": "source",
                                                    "outputStream": "[variables('streamName')]"
                                                  }
                                                ],
                                                "dataCollectionEndpointId": "[parameters('endpointResourceId')]",
                                                "streamDeclarations": {
                                                  "[format('{0}', variables('streamName'))]": {
                                                    "columns": [
                                                      {
                                                        "name": "TimeGenerated",
                                                        "type": "datetime"
                                                      },
                                                      {
                                                        "name": "RawData",
                                                        "type": "string"
                                                      }
                                                    ]
                                                  }
                                                }
                                              }
                                            }
                                          ],
                                          "outputs": {
                                            "ruleId": {
                                              "type": "string",
                                              "value": "[resourceId('Microsoft.Insights/dataCollectionRules', format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS')))]"
                                            },
                                            "ruleName": {
                                              "type": "string",
                                              "value": "[format('AMP-{0}-FileColl-{1}-{2}', parameters('instanceName'), parameters('packtag'), parameters('OS'))]"
                                            }
                                          }
                                        }
                                      },
                                      "dependsOn": [
                                        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), variables('resourceGroupName')), 'Microsoft.Resources/deployments', variables('tableNameToUse'))]"
                                      ]
                                    }
                                  ]
                                }
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('VMInsightsPack-{0}-{1}', parameters('instanceName'), parameters('location'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "mgname": {
                            "value": "[parameters('mgname')]"
                          },
                          "resourceGroupId": {
                            "value": "[parameters('resourceGroupId')]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "solutionVersion": {
                            "value": "[parameters('solutionVersion')]"
                          },
                          "subscriptionId": {
                            "value": "[parameters('subscriptionId')]"
                          },
                          "userManagedIdentityResourceId": {
                            "value": "[parameters('userManagedIdentityResourceId')]"
                          },
                          "workspaceId": {
                            "value": "[parameters('workspaceId')]"
                          },
                          "customerTags": {
                            "value": "[parameters('customerTags')]"
                          },
                          "actionGroupResourceId": {
                            "value": "[parameters('actionGroupResourceId')]"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "9005525137683410162"
                            }
                          },
                          "parameters": {
                            "packtag": {
                              "type": "string",
                              "defaultValue": "VMI",
                              "metadata": {
                                "description": "The Tag value for this pack"
                              }
                            },
                            "actionGroupResourceId": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string",
                              "metadata": {
                                "description": "location for the deployment."
                              }
                            },
                            "workspaceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                              }
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "solutionVersion": {
                              "type": "string"
                            },
                            "dceId": {
                              "type": "string"
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string"
                            },
                            "mgname": {
                              "type": "string"
                            },
                            "subscriptionId": {
                              "type": "string"
                            },
                            "resourceGroupId": {
                              "type": "string"
                            },
                            "customerTags": {
                              "type": "object"
                            },
                            "instanceName": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "rulename": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "ruleshortname": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "tempTags": {
                              "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                              "MonitoringPackType": "IaaS",
                              "solutionVersion": "[parameters('solutionVersion')]"
                            },
                            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]"
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('vmInsightsDCR-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "workspaceResourceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "ruleName": {
                                    "value": "[variables('rulename')]"
                                  },
                                  "dceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "13954368441826719999"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "workspaceResourceId": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "ruleName": {
                                      "type": "string"
                                    },
                                    "dceId": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "wsfriendlyname": "[split(parameters('workspaceResourceId'), '/')[8]]"
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2021-09-01-preview",
                                      "name": "[format('{0}-VMI', parameters('ruleName'))]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "properties": {
                                        "description": "Data collection rule for VM Insights.",
                                        "dataCollectionEndpointId": "[parameters('dceId')]",
                                        "dataSources": {
                                          "performanceCounters": [
                                            {
                                              "name": "VMInsightsPerfCounters",
                                              "streams": [
                                                "Microsoft-InsightsMetrics"
                                              ],
                                              "samplingFrequencyInSeconds": 60,
                                              "counterSpecifiers": [
                                                "\\VmInsights\\DetailedMetrics"
                                              ]
                                            }
                                          ]
                                        },
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('workspaceResourceId')]",
                                              "name": "[variables('wsfriendlyname')]"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-InsightsMetrics"
                                            ],
                                            "destinations": [
                                              "[variables('wsfriendlyname')]"
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "VMIRuleId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', format('{0}-VMI', parameters('ruleName')))]"
                                    }
                                  }
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('Alerts-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "AGId": {
                                    "value": "[parameters('actionGroupResourceId')]"
                                  },
                                  "packtag": {
                                    "value": "[parameters('packtag')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "instanceName": {
                                    "value": "[parameters('instanceName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "17027824023029962763"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "AGId": {
                                      "type": "string"
                                    },
                                    "packtag": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "instanceName": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "moduleprefix": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                                    "alertlist": [
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Data Disk Read Latency (ms)",
                                        "alertRuleDisplayName": "Data Disk Read Latency (ms)",
                                        "alertRuleName": "DataDiskReadLatency(ms)",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "GreaterThan",
                                        "threshold": 30,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"LogicalDisk\" and Name == \"ReadLatencyMs\"\r\n| extend Disk=tostring(todynamic(Tags)[\"vm.azm.ms/mountId\"])\r\n| where Disk !in ('C:','/')\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated,15m), Computer, _ResourceId, Disk\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Data Disk Free Space Percentage",
                                        "alertRuleDisplayName": "Data Disk Free Space Percentage",
                                        "alertRuleName": "DataDiskFreeSpacePercentage",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "LessThan",
                                        "threshold": 10,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"LogicalDisk\"and Name == \"FreeSpacePercentage\"\r\n| extend Disk=tostring(todynamic(Tags)[\"vm.azm.ms/mountId\"])\r\n| where Disk !in ('C:','/')\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated,15m), Computer, _ResourceId, Disk\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Data Disk Write Latency (ms)",
                                        "alertRuleDisplayName": "Data Disk Write Latency (ms)",
                                        "alertRuleName": "DataDiskWriteLatency(ms)",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "GreaterThan",
                                        "threshold": 30,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"LogicalDisk\" and Name == \"WriteLatencyMs\"\r\n| extend Disk=tostring(todynamic(Tags)[\"vm.azm.ms/mountId\"])\r\n| where Disk !in ('C:','/')\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated,15m), Computer, _ResourceId, Disk\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Network Read (bytes-sec)",
                                        "alertRuleDisplayName": "Network Read (bytes-sec)",
                                        "alertRuleName": "NetworkRead(bytes-sec)",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "GreaterThan",
                                        "threshold": 10000000,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Network\" and Name == \"ReadBytesPerSecond\"\r\n| extend NetworkInterface=tostring(todynamic(Tags)[\"vm.azm.ms/networkDeviceId\"])\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Network Write (bytes-sec)",
                                        "alertRuleDisplayName": "Network Write (bytes-sec)",
                                        "alertRuleName": "NetworkWrite(bytes-sec)",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "GreaterThan",
                                        "threshold": 10000000,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Network\" and Name == \"WriteBytesPerSecond\"\r\n| extend NetworkInterface=tostring(todynamic(Tags)[\"vm.azm.ms/networkDeviceId\"])\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Data OS Read Latency (ms)",
                                        "alertRuleDisplayName": "OS Disk Read Latency (ms)",
                                        "alertRuleName": "OSDiskReadLatency(ms)",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "GreaterThan",
                                        "threshold": 30,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"LogicalDisk\" and Name == \"ReadLatencyMs\"\r\n| extend Disk=tostring(todynamic(Tags)[\"vm.azm.ms/mountId\"])\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine OS Disk Free Space Percentage",
                                        "alertRuleDisplayName": "OS Disk Free Space Percentage",
                                        "alertRuleName": "OSDiskFreeSpacePercentage",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "LessThan",
                                        "threshold": 10,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"LogicalDisk\" and Name == \"FreeSpacePercentage\"\r\n| extend Disk=tostring(todynamic(Tags)[\"vm.azm.ms/mountId\"])\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine OS Disk Write Latency (ms)",
                                        "alertRuleDisplayName": "OS Disk Write Latency (ms)",
                                        "alertRuleName": "OSDiskWriteLatency(ms)",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "GreaterThan",
                                        "threshold": 50,
                                        "query": "    InsightsMetrics| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"LogicalDisk\" and Name == \"WriteLatencyMs\"\r\n| extend Disk=tostring(todynamic(Tags)[\"vm.azm.ms/mountId\"])\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Processor Utilization Percentage",
                                        "alertRuleDisplayName": "Processor Utilization Percentage",
                                        "alertRuleName": "ProcessorUtilizationPercentage",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "GreaterThan",
                                        "threshold": 85,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Processor\" and Name == \"UtilizationPercentage\"\r\n| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId\r\n"
                                      },
                                      {
                                        "alertRuleDescription": "Log Alert for Virtual Machine Available Memory Percentage",
                                        "alertRuleDisplayName": "Available Memory Percentage",
                                        "alertRuleName": "AvailableMemoryPercentage",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT5M",
                                        "windowSize": "PT15M",
                                        "alertType": "Aggregated",
                                        "metricMeasureColumn": "AggregatedValue",
                                        "operator": "LessThan",
                                        "threshold": 10,
                                        "query": "    InsightsMetrics\r\n| where Origin == \"vm.azm.ms\"\r\n| where Namespace == \"Memory\" and Name == \"AvailableMB\"\r\n| extend TotalMemory = toreal(todynamic(Tags)[\"vm.azm.ms/memorySizeMB\"])\r\n| extend AvailableMemoryPercentage = (toreal(Val) / TotalMemory) * 100.0\r\n| summarize AggregatedValue = avg(AvailableMemoryPercentage) by bin(TimeGenerated, 15m), Computer, _ResourceId\r\n"
                                      }
                                    ]
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "[format('{0}-Alerts', variables('moduleprefix'))]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "alertlist": {
                                            "value": "[variables('alertlist')]"
                                          },
                                          "AGId": {
                                            "value": "[parameters('AGId')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "moduleprefix": {
                                            "value": "[variables('moduleprefix')]"
                                          },
                                          "packtag": {
                                            "value": "[parameters('packtag')]"
                                          },
                                          "Tags": {
                                            "value": "[parameters('Tags')]"
                                          },
                                          "workspaceId": {
                                            "value": "[parameters('workspaceId')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "17858688129795365440"
                                            }
                                          },
                                          "parameters": {
                                            "alertlist": {
                                              "type": "array"
                                            },
                                            "location": {
                                              "type": "string"
                                            },
                                            "workspaceId": {
                                              "type": "string"
                                            },
                                            "AGId": {
                                              "type": "string"
                                            },
                                            "packtag": {
                                              "type": "string"
                                            },
                                            "Tags": {
                                              "type": "object"
                                            },
                                            "moduleprefix": {
                                              "type": "string"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "copy": {
                                                "name": "Alerts",
                                                "count": "[length(parameters('alertlist'))]"
                                              },
                                              "type": "Microsoft.Resources/deployments",
                                              "apiVersion": "2022-09-01",
                                              "name": "[format('{0}-Alert-{1}', parameters('packtag'), copyIndex())]",
                                              "properties": {
                                                "expressionEvaluationOptions": {
                                                  "scope": "inner"
                                                },
                                                "mode": "Incremental",
                                                "parameters": {
                                                  "location": {
                                                    "value": "[parameters('location')]"
                                                  },
                                                  "actionGroupResourceId": {
                                                    "value": "[parameters('AGId')]"
                                                  },
                                                  "alertRuleDescription": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleDescription]"
                                                  },
                                                  "alertRuleDisplayName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleDisplayName)]"
                                                  },
                                                  "alertRuleName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleName)]"
                                                  },
                                                  "alertRuleSeverity": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleSeverity]"
                                                  },
                                                  "autoMitigate": {
                                                    "value": "[parameters('alertlist')[copyIndex()].autoMitigate]"
                                                  },
                                                  "evaluationFrequency": {
                                                    "value": "[parameters('alertlist')[copyIndex()].evaluationFrequency]"
                                                  },
                                                  "windowSize": {
                                                    "value": "[parameters('alertlist')[copyIndex()].windowSize]"
                                                  },
                                                  "scope": {
                                                    "value": "[parameters('workspaceId')]"
                                                  },
                                                  "query": {
                                                    "value": "[parameters('alertlist')[copyIndex()].query]"
                                                  },
                                                  "dimensions": "[if(contains(parameters('alertlist')[copyIndex()], 'dimensions'), createObject('value', parameters('alertlist')[copyIndex()].dimensions), createObject('value', null()))]",
                                                  "packtag": {
                                                    "value": "[parameters('packtag')]"
                                                  },
                                                  "Tags": {
                                                    "value": "[parameters('Tags')]"
                                                  },
                                                  "alertType": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertType]"
                                                  },
                                                  "metricMeasureColumn": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].metricMeasureColumn), createObject('value', null()))]",
                                                  "operator": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].operator), createObject('value', null()))]",
                                                  "threshold": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].threshold), createObject('value', null()))]"
                                                },
                                                "template": {
                                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                  "contentVersion": "1.0.0.0",
                                                  "metadata": {
                                                    "_generator": {
                                                      "name": "bicep",
                                                      "version": "0.32.4.45862",
                                                      "templateHash": "10159755056440989647"
                                                    }
                                                  },
                                                  "parameters": {
                                                    "alertType": {
                                                      "type": "string",
                                                      "allowedValues": [
                                                        "rows",
                                                        "Aggregated"
                                                      ]
                                                    },
                                                    "alertRuleName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDisplayName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDescription": {
                                                      "type": "string"
                                                    },
                                                    "scope": {
                                                      "type": "string"
                                                    },
                                                    "actionGroupResourceId": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleSeverity": {
                                                      "type": "int"
                                                    },
                                                    "location": {
                                                      "type": "string"
                                                    },
                                                    "windowSize": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "evaluationFrequency": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "autoMitigate": {
                                                      "type": "bool",
                                                      "defaultValue": false
                                                    },
                                                    "query": {
                                                      "type": "string"
                                                    },
                                                    "packtag": {
                                                      "type": "string"
                                                    },
                                                    "Tags": {
                                                      "type": "object"
                                                    },
                                                    "threshold": {
                                                      "type": "int",
                                                      "defaultValue": 0
                                                    },
                                                    "metricMeasureColumn": {
                                                      "type": "string",
                                                      "defaultValue": ""
                                                    },
                                                    "dimensions": {
                                                      "type": "array",
                                                      "defaultValue": [
                                                        {
                                                          "name": "Computer",
                                                          "operator": "Include",
                                                          "values": [
                                                            "*"
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    "operator": {
                                                      "type": "string",
                                                      "defaultValue": "GreaterThan",
                                                      "allowedValues": [
                                                        "GreaterThan",
                                                        "GreaterThanOrEqual",
                                                        "LessThan",
                                                        "LessThanOrEqual",
                                                        "Equal",
                                                        "NotEqual"
                                                      ]
                                                    }
                                                  },
                                                  "resources": [
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'rows')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "16566470716356207302"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Count",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "GreaterThan",
                                                                      "threshold": 0,
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    },
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'Aggregated')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          },
                                                          "threshold": {
                                                            "value": "[parameters('threshold')]"
                                                          },
                                                          "metricMeasureColumn": {
                                                            "value": "[parameters('metricMeasureColumn')]"
                                                          },
                                                          "operator": {
                                                            "value": "[parameters('operator')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "18444959286864838274"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "threshold": {
                                                              "type": "int"
                                                            },
                                                            "metricMeasureColumn": {
                                                              "type": "string"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            },
                                                            "operator": {
                                                              "type": "string",
                                                              "allowedValues": [
                                                                "GreaterThan",
                                                                "GreaterThanOrEqual",
                                                                "LessThan",
                                                                "LessThanOrEqual",
                                                                "Equal",
                                                                "NotEqual"
                                                              ]
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Average",
                                                                      "metricMeasureColumn": "[parameters('metricMeasureColumn')]",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "[parameters('operator')]",
                                                                      "threshold": "[parameters('threshold')]",
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    }
                                                  ]
                                                }
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  ]
                                }
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('IISPack-deployment-{0}-{1}', parameters('instanceName'), parameters('location'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "mgname": {
                            "value": "[parameters('mgname')]"
                          },
                          "resourceGroupId": {
                            "value": "[parameters('resourceGroupId')]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "solutionVersion": {
                            "value": "[parameters('solutionVersion')]"
                          },
                          "subscriptionId": {
                            "value": "[parameters('subscriptionId')]"
                          },
                          "userManagedIdentityResourceId": {
                            "value": "[parameters('userManagedIdentityResourceId')]"
                          },
                          "workspaceId": {
                            "value": "[parameters('workspaceId')]"
                          },
                          "customerTags": {
                            "value": "[parameters('customerTags')]"
                          },
                          "actionGroupResourceId": {
                            "value": "[parameters('actionGroupResourceId')]"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "16679733599436842141"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string",
                              "metadata": {
                                "description": "location for the deployment."
                              }
                            },
                            "workspaceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                              }
                            },
                            "packtag": {
                              "type": "string",
                              "defaultValue": "IIS"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "solutionVersion": {
                              "type": "string"
                            },
                            "dceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                              }
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the user managed identity to be used for the deployment"
                              }
                            },
                            "mgname": {
                              "type": "string"
                            },
                            "subscriptionId": {
                              "type": "string"
                            },
                            "resourceGroupId": {
                              "type": "string"
                            },
                            "customerTags": {
                              "type": "object"
                            },
                            "actionGroupResourceId": {
                              "type": "string"
                            },
                            "instanceName": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "rulename": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "tempTags": {
                              "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                              "MonitoringPackType": "IaaS",
                              "solutionVersion": "[parameters('solutionVersion')]"
                            },
                            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                            "workspaceFriendlyName": "[split(parameters('workspaceId'), '/')[8]]",
                            "ruleshortname": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
                            "kind": "Windows",
                            "xPathQueries": [
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2221)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5152)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5010 or EventID=5011 or EventID=5012 or EventID=5013)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5009)]]",
                              "Application!*[System[Provider[@Name='Active Server Pages'] and (EventID=500 or EventID=499 or EventID=23 or EventID=22 or EventID=21 or EventID=20 or EventID=19 or EventID=18 or EventID=17 or EventID=16 or EventID=9 or EventID=8 or EventID=7 or EventID=6 or EventID=5)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1037)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2208)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2206)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2201)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2203)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2204)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2274 or EventID=2268 or EventID=2220 or EventID=2219 or EventID=2214)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5088 or EventID=5061 or EventID=5060)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2296)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2295)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2293)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1133)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2261)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5036)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2264)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2298)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2218)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2258)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2227)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2233)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2226 or EventID=2230 or EventID=2231 or EventID=2232)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5174 or EventID=5179 or EventID=5180)]]"
                            ],
                            "performanceCounters": [
                              "\\Web Service(_Total)\\Bytes Received/sec",
                              "\\Web Service(_Total)\\Bytes Sent/sec",
                              "\\Web Service(_Total)\\Bytes Total/sec",
                              "\\Web Service(_Total)\\Connection Attempts/sec",
                              "\\Web Service(_Total)\\Current Connections",
                              "\\Web Service(_Total)\\Total Method Requests/sec",
                              "\\Microsoft FTP Service(_Total)\\Bytes Total/sec",
                              "\\Microsoft FTP Service(_Total)\\Current Connections",
                              "\\SMTP Server(_Total)\\Bytes Received/sec",
                              "\\SMTP Server(_Total)\\Bytes Sent/sec",
                              "\\SMTP Server(_Total)\\Bytes Total/sec",
                              "\\SMTP Server(_Total)\\Inbound Connections Current",
                              "\\SMTP Server(_Total)\\Message Bytes Received/sec",
                              "\\SMTP Server(_Total)\\Message Bytes Sent/sec",
                              "\\SMTP Server(_Total)\\Messages Delivered/sec",
                              "\\SMTP Server(_Total)\\Messages Received/sec",
                              "\\SMTP Server(_Total)\\Messages Sent/sec",
                              "\\SMTP Server(_Total)\\Outbound Connections Current",
                              "\\SMTP Server(_Total)\\Total Messages Submitted",
                              "\\SMTP Server(SMTP 1)\\Bytes Received/sec",
                              "\\SMTP Server(SMTP 1)\\Bytes Sent/sec",
                              "\\SMTP Server(SMTP 1)\\Bytes Total/sec",
                              "\\SMTP Server(SMTP 1)\\Inbound Connections Current",
                              "\\SMTP Server(SMTP 1)\\Message Bytes Received/sec",
                              "\\SMTP Server(SMTP 1)\\Message Bytes Sent/sec",
                              "\\SMTP Server(SMTP 1)\\Messages Delivered/sec",
                              "\\SMTP Server(SMTP 1)\\Messages Received/sec",
                              "\\SMTP Server(SMTP 1)\\Messages Sent/sec",
                              "\\SMTP Server(SMTP 1)\\Outbound Connections Current",
                              "\\SMTP Server(SMTP 1)\\Total Messages Submitted"
                            ]
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('Alerts-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "AGId": {
                                    "value": "[parameters('actionGroupResourceId')]"
                                  },
                                  "packtag": {
                                    "value": "[parameters('packtag')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "instanceName": {
                                    "value": "[parameters('instanceName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "9461356001780640398"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "AGId": {
                                      "type": "string"
                                    },
                                    "packtag": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "instanceName": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "moduleprefix": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                                    "alertlist": [
                                      {
                                        "alertRuleDescription": "A server side include file has included itself or the maximum depth of server side includes has been exceeded",
                                        "alertRuleDisplayName": "A server side include file has included itself or the maximum depth of server side includes has been exceeded",
                                        "alertRuleName": "AlertRule-IIS-2012-1",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2221) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Application Pool has an IdleTimeout equal to or greater than the PeriodicRestart time",
                                        "alertRuleDisplayName": "Application Pool has an IdleTimeout equal to or greater than the PeriodicRestart time",
                                        "alertRuleName": "AlertRule-IIS-2012-2",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5152) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "Application Pool worker process is unresponsive",
                                        "alertRuleDisplayName": "Application Pool worker process is unresponsive",
                                        "alertRuleName": "AlertRule-IIS-2012-3",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5010,5011,5012,5013) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "Application Pool worker process terminated unexpectedly",
                                        "alertRuleDisplayName": "Application Pool worker process terminated unexpectedly",
                                        "alertRuleName": "AlertRule-IIS-2012-4",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5009) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "ASP application error occurred",
                                        "alertRuleDisplayName": "ASP application error occurred",
                                        "alertRuleName": "AlertRule-IIS-2012-5",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (500,499,23,22,21,20,19,18,17,16,9,8,7,6,5) and EventLog == 'Application' and Source == 'Active Server Pages'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP control channel for the WWW Service did not open",
                                        "alertRuleDisplayName": "HTTP control channel for the WWW Service did not open",
                                        "alertRuleName": "AlertRule-IIS-2012-6",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1037) and EventLog == 'System' and Source == 'Microsoft-Windows-IIS-W3SVC'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not create a client connection object for user",
                                        "alertRuleDisplayName": "HTTP Server could not create a client connection object for user",
                                        "alertRuleName": "AlertRule-IIS-2012-7",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2208) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not create the main connection socket",
                                        "alertRuleDisplayName": "HTTP Server could not create the main connection socket",
                                        "alertRuleName": "AlertRule-IIS-2012-8",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2206) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not initialize its security",
                                        "alertRuleDisplayName": "HTTP Server could not initialize its security",
                                        "alertRuleName": "AlertRule-IIS-2012-9",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2201) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not initialize the socket library",
                                        "alertRuleDisplayName": "HTTP Server could not initialize the socket library",
                                        "alertRuleName": "AlertRule-IIS-2012-10",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2203) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server was unable to initialize due to a shortage of available memory",
                                        "alertRuleDisplayName": "HTTP Server was unable to initialize due to a shortage of available memory",
                                        "alertRuleName": "AlertRule-IIS-2012-11",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2204) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "ISAPI application error detected",
                                        "alertRuleDisplayName": "ISAPI application error detected",
                                        "alertRuleName": "AlertRule-IIS-2012-12",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2274,2268,2220,2219,2214) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Job object associated with the application pool encountered an error",
                                        "alertRuleDisplayName": "Job object associated with the application pool encountered an error",
                                        "alertRuleName": "AlertRule-IIS-2012-13",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5088,5061,5060) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "Module has an invalid precondition",
                                        "alertRuleDisplayName": "Module has an invalid precondition",
                                        "alertRuleName": "AlertRule-IIS-2012-14",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2296) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Module registration error detected (failed to find RegisterModule entrypoint)",
                                        "alertRuleDisplayName": "Module registration error detected (failed to find RegisterModule entrypoint)",
                                        "alertRuleName": "AlertRule-IIS-2012-15",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2295) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Module registration error detected (module returned an error during registration)",
                                        "alertRuleDisplayName": "Module registration error detected (module returned an error during registration)",
                                        "alertRuleName": "AlertRule-IIS-2012-16",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2293) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Only one type of logging can be enabled at a time",
                                        "alertRuleDisplayName": "Only one type of logging can be enabled at a time",
                                        "alertRuleName": "AlertRule-IIS-2012-17",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1133) and EventLog == 'System' and Source == 'Microsoft-Windows-IIS-W3SVC'"
                                      },
                                      {
                                        "alertRuleDescription": "SF_NOTIFY_READ_RAW_DATA filter notification is not supported in IIS 8",
                                        "alertRuleDisplayName": "SF_NOTIFY_READ_RAW_DATA filter notification is not supported in IIS 8",
                                        "alertRuleName": "AlertRule-IIS-2012-18",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2261) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The configuration manager for WAS did not initialize",
                                        "alertRuleDisplayName": "The configuration manager for WAS did not initialize",
                                        "alertRuleName": "AlertRule-IIS-2012-19",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5036) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "The directory specified for caching compressed content is invalid",
                                        "alertRuleDisplayName": "The directory specified for caching compressed content is invalid",
                                        "alertRuleName": "AlertRule-IIS-2012-20",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2264) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The Global Modules list is empty",
                                        "alertRuleDisplayName": "The Global Modules list is empty",
                                        "alertRuleName": "AlertRule-IIS-2012-21",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2298) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The HTTP server encountered an error processing the server side include file",
                                        "alertRuleDisplayName": "The HTTP server encountered an error processing the server side include file",
                                        "alertRuleName": "AlertRule-IIS-2012-22",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2218) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server failed to close client connections to URLs during shutdown",
                                        "alertRuleDisplayName": "The server failed to close client connections to URLs during shutdown",
                                        "alertRuleName": "AlertRule-IIS-2012-23",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2258) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server was unable to acquire a license for a SSL connection",
                                        "alertRuleDisplayName": "The server was unable to acquire a license for a SSL connection",
                                        "alertRuleName": "AlertRule-IIS-2012-24",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2227) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server was unable to allocate a buffer to read a file",
                                        "alertRuleDisplayName": "The server was unable to allocate a buffer to read a file",
                                        "alertRuleName": "AlertRule-IIS-2012-25",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2233) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server was unable to read a file",
                                        "alertRuleDisplayName": "The server was unable to read a file",
                                        "alertRuleName": "AlertRule-IIS-2012-26",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2226,2230,2231,2232) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "WAS detected invalid configuration data",
                                        "alertRuleDisplayName": "WAS detected invalid configuration data",
                                        "alertRuleName": "AlertRule-IIS-2012-27",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5174,5179,5180) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      }
                                    ]
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "[format('{0}-Alerts', variables('moduleprefix'))]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "alertlist": {
                                            "value": "[variables('alertlist')]"
                                          },
                                          "AGId": {
                                            "value": "[parameters('AGId')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "moduleprefix": {
                                            "value": "[variables('moduleprefix')]"
                                          },
                                          "packtag": {
                                            "value": "[parameters('packtag')]"
                                          },
                                          "Tags": {
                                            "value": "[parameters('Tags')]"
                                          },
                                          "workspaceId": {
                                            "value": "[parameters('workspaceId')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "17858688129795365440"
                                            }
                                          },
                                          "parameters": {
                                            "alertlist": {
                                              "type": "array"
                                            },
                                            "location": {
                                              "type": "string"
                                            },
                                            "workspaceId": {
                                              "type": "string"
                                            },
                                            "AGId": {
                                              "type": "string"
                                            },
                                            "packtag": {
                                              "type": "string"
                                            },
                                            "Tags": {
                                              "type": "object"
                                            },
                                            "moduleprefix": {
                                              "type": "string"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "copy": {
                                                "name": "Alerts",
                                                "count": "[length(parameters('alertlist'))]"
                                              },
                                              "type": "Microsoft.Resources/deployments",
                                              "apiVersion": "2022-09-01",
                                              "name": "[format('{0}-Alert-{1}', parameters('packtag'), copyIndex())]",
                                              "properties": {
                                                "expressionEvaluationOptions": {
                                                  "scope": "inner"
                                                },
                                                "mode": "Incremental",
                                                "parameters": {
                                                  "location": {
                                                    "value": "[parameters('location')]"
                                                  },
                                                  "actionGroupResourceId": {
                                                    "value": "[parameters('AGId')]"
                                                  },
                                                  "alertRuleDescription": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleDescription]"
                                                  },
                                                  "alertRuleDisplayName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleDisplayName)]"
                                                  },
                                                  "alertRuleName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleName)]"
                                                  },
                                                  "alertRuleSeverity": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleSeverity]"
                                                  },
                                                  "autoMitigate": {
                                                    "value": "[parameters('alertlist')[copyIndex()].autoMitigate]"
                                                  },
                                                  "evaluationFrequency": {
                                                    "value": "[parameters('alertlist')[copyIndex()].evaluationFrequency]"
                                                  },
                                                  "windowSize": {
                                                    "value": "[parameters('alertlist')[copyIndex()].windowSize]"
                                                  },
                                                  "scope": {
                                                    "value": "[parameters('workspaceId')]"
                                                  },
                                                  "query": {
                                                    "value": "[parameters('alertlist')[copyIndex()].query]"
                                                  },
                                                  "dimensions": "[if(contains(parameters('alertlist')[copyIndex()], 'dimensions'), createObject('value', parameters('alertlist')[copyIndex()].dimensions), createObject('value', null()))]",
                                                  "packtag": {
                                                    "value": "[parameters('packtag')]"
                                                  },
                                                  "Tags": {
                                                    "value": "[parameters('Tags')]"
                                                  },
                                                  "alertType": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertType]"
                                                  },
                                                  "metricMeasureColumn": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].metricMeasureColumn), createObject('value', null()))]",
                                                  "operator": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].operator), createObject('value', null()))]",
                                                  "threshold": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].threshold), createObject('value', null()))]"
                                                },
                                                "template": {
                                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                  "contentVersion": "1.0.0.0",
                                                  "metadata": {
                                                    "_generator": {
                                                      "name": "bicep",
                                                      "version": "0.32.4.45862",
                                                      "templateHash": "10159755056440989647"
                                                    }
                                                  },
                                                  "parameters": {
                                                    "alertType": {
                                                      "type": "string",
                                                      "allowedValues": [
                                                        "rows",
                                                        "Aggregated"
                                                      ]
                                                    },
                                                    "alertRuleName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDisplayName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDescription": {
                                                      "type": "string"
                                                    },
                                                    "scope": {
                                                      "type": "string"
                                                    },
                                                    "actionGroupResourceId": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleSeverity": {
                                                      "type": "int"
                                                    },
                                                    "location": {
                                                      "type": "string"
                                                    },
                                                    "windowSize": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "evaluationFrequency": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "autoMitigate": {
                                                      "type": "bool",
                                                      "defaultValue": false
                                                    },
                                                    "query": {
                                                      "type": "string"
                                                    },
                                                    "packtag": {
                                                      "type": "string"
                                                    },
                                                    "Tags": {
                                                      "type": "object"
                                                    },
                                                    "threshold": {
                                                      "type": "int",
                                                      "defaultValue": 0
                                                    },
                                                    "metricMeasureColumn": {
                                                      "type": "string",
                                                      "defaultValue": ""
                                                    },
                                                    "dimensions": {
                                                      "type": "array",
                                                      "defaultValue": [
                                                        {
                                                          "name": "Computer",
                                                          "operator": "Include",
                                                          "values": [
                                                            "*"
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    "operator": {
                                                      "type": "string",
                                                      "defaultValue": "GreaterThan",
                                                      "allowedValues": [
                                                        "GreaterThan",
                                                        "GreaterThanOrEqual",
                                                        "LessThan",
                                                        "LessThanOrEqual",
                                                        "Equal",
                                                        "NotEqual"
                                                      ]
                                                    }
                                                  },
                                                  "resources": [
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'rows')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "16566470716356207302"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Count",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "GreaterThan",
                                                                      "threshold": 0,
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    },
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'Aggregated')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          },
                                                          "threshold": {
                                                            "value": "[parameters('threshold')]"
                                                          },
                                                          "metricMeasureColumn": {
                                                            "value": "[parameters('metricMeasureColumn')]"
                                                          },
                                                          "operator": {
                                                            "value": "[parameters('operator')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "18444959286864838274"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "threshold": {
                                                              "type": "int"
                                                            },
                                                            "metricMeasureColumn": {
                                                              "type": "string"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            },
                                                            "operator": {
                                                              "type": "string",
                                                              "allowedValues": [
                                                                "GreaterThan",
                                                                "GreaterThanOrEqual",
                                                                "LessThan",
                                                                "LessThanOrEqual",
                                                                "Equal",
                                                                "NotEqual"
                                                              ]
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Average",
                                                                      "metricMeasureColumn": "[parameters('metricMeasureColumn')]",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "[parameters('operator')]",
                                                                      "threshold": "[parameters('threshold')]",
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    }
                                                  ]
                                                }
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('dcrPerformance-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "rulename": {
                                    "value": "[variables('rulename')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "wsfriendlyname": {
                                    "value": "[variables('workspaceFriendlyName')]"
                                  },
                                  "kind": {
                                    "value": "[variables('kind')]"
                                  },
                                  "xPathQueries": {
                                    "value": "[variables('xPathQueries')]"
                                  },
                                  "counterSpecifiers": {
                                    "value": "[variables('performanceCounters')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "dceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "15691414683408659274"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "rulename": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "kind": {
                                      "type": "string",
                                      "defaultValue": "Windows"
                                    },
                                    "wsfriendlyname": {
                                      "type": "string",
                                      "defaultValue": "TBD"
                                    },
                                    "xPathQueries": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "counterSpecifiers": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "samplingFrequencyInSeconds": {
                                      "type": "int",
                                      "defaultValue": 300
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "dceId": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('rulename')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "[parameters('kind')]",
                                      "properties": {
                                        "dataCollectionEndpointId": "[parameters('dceId')]",
                                        "description": "[format('Data Collection Rule for {0}}} - {1}}}', parameters('kind'), parameters('rulename'))]",
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('workspaceId')]",
                                              "name": "[parameters('wsfriendlyname')]"
                                            }
                                          ]
                                        },
                                        "dataSources": {
                                          "windowsEventLogs": "[if(empty(parameters('xPathQueries')), null(), createArray(createObject('streams', createArray('Microsoft-Event'), 'xPathQueries', parameters('xPathQueries'), 'name', 'EventLogsDataSource')))]",
                                          "performanceCounters": [
                                            {
                                              "streams": [
                                                "Microsoft-Perf"
                                              ],
                                              "samplingFrequencyInSeconds": "[parameters('samplingFrequencyInSeconds')]",
                                              "counterSpecifiers": "[parameters('counterSpecifiers')]",
                                              "name": "PerfCountersDataSource"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-Event",
                                              "Microsoft-Perf"
                                            ],
                                            "destinations": [
                                              "[parameters('wsfriendlyname')]"
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "dcrId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('rulename'))]"
                                    }
                                  }
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('dcrIISLogs-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "ruleName": {
                                    "value": "[format('{0}-IISLogs', variables('rulename'))]"
                                  },
                                  "lawResourceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "endpointResourceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "11212238793022467482"
                                    }
                                  },
                                  "parameters": {
                                    "ruleName": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the name of the data collection rule to create."
                                      }
                                    },
                                    "endpointResourceId": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the resource id of the data collection endpoint."
                                      }
                                    },
                                    "location": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the location in which to create the data collection rule."
                                      }
                                    },
                                    "lawResourceId": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    }
                                  },
                                  "variables": {
                                    "lawFriendlyName": "[split(parameters('lawResourceId'), '/')[8]]"
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('ruleName')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "Windows",
                                      "properties": {
                                        "dataCollectionEndpointId": "[parameters('endpointResourceId')]",
                                        "dataSources": {
                                          "iisLogs": [
                                            {
                                              "streams": [
                                                "Microsoft-W3CIISLog"
                                              ],
                                              "name": "iisLogsDataSource"
                                            }
                                          ]
                                        },
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('lawResourceId')]",
                                              "name": "[variables('lawFriendlyName')]"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-W3CIISLog"
                                            ],
                                            "destinations": [
                                              "[variables('lawFriendlyName')]"
                                            ],
                                            "transformKql": "source",
                                            "outputStream": "Microsoft-W3CIISLog"
                                          }
                                        ],
                                        "streamDeclarations": {
                                          "Custom-MyTable_CL": {
                                            "columns": [
                                              {
                                                "name": "TimeGenerated",
                                                "type": "datetime"
                                              },
                                              {
                                                "name": "RawData",
                                                "type": "string"
                                              }
                                            ]
                                          }
                                        }
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "dcrId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('ruleName'))]"
                                    }
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('IIS2016-deployment-{0}-{1}', parameters('instanceName'), parameters('location'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "mgname": {
                            "value": "[parameters('mgname')]"
                          },
                          "resourceGroupId": {
                            "value": "[parameters('resourceGroupId')]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "solutionVersion": {
                            "value": "[parameters('solutionVersion')]"
                          },
                          "subscriptionId": {
                            "value": "[parameters('subscriptionId')]"
                          },
                          "userManagedIdentityResourceId": {
                            "value": "[parameters('userManagedIdentityResourceId')]"
                          },
                          "workspaceId": {
                            "value": "[parameters('workspaceId')]"
                          },
                          "customerTags": {
                            "value": "[parameters('customerTags')]"
                          },
                          "actionGroupResourceId": {
                            "value": "[parameters('actionGroupResourceId')]"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "13900852997455490309"
                            }
                          },
                          "parameters": {
                            "actionGroupResourceId": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string",
                              "metadata": {
                                "description": "location for the deployment."
                              }
                            },
                            "workspaceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                              }
                            },
                            "packtag": {
                              "type": "string",
                              "defaultValue": "IIS2016"
                            },
                            "solutionTag": {
                              "type": "string",
                              "defaultValue": "MonitorStarterPacks"
                            },
                            "solutionVersion": {
                              "type": "string"
                            },
                            "dceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                              }
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the user managed identity to be used for the deployment"
                              }
                            },
                            "mgname": {
                              "type": "string"
                            },
                            "subscriptionId": {
                              "type": "string"
                            },
                            "resourceGroupId": {
                              "type": "string"
                            },
                            "instanceName": {
                              "type": "string"
                            },
                            "customerTags": {
                              "type": "object"
                            }
                          },
                          "variables": {
                            "rulename": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "ruleshortname": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "tempTags": {
                              "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                              "MonitoringPackType": "IaaS",
                              "solutionVersion": "[parameters('solutionVersion')]"
                            },
                            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                            "workspaceFriendlyName": "[split(parameters('workspaceId'), '/')[8]]",
                            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
                            "kind": "Windows",
                            "xPathQueries": [
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1071 or EventID=1073)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1135 or EventID=1134)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2226 or EventID=2230 or EventID=2231 or EventID=2232)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2274 or EventID=2268 or EventID=2220 or EventID=2219 or EventID=2214)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5172 or EventID=5173)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5174 or EventID=5179 or EventID=5180)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5152)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1037)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1062)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1126)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1133)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1173)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC'] and (EventID=1175)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2201)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2203)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2204)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2206)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2208)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2218)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2227)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2233)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2258)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2261)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2264)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2281)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2293)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2295)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2296)]]",
                              "Application!*[System[Provider[@Name='Microsoft-Windows-IIS-W3SVC-WP'] and (EventID=2298)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5005)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5030)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5036)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5053)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5063)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5066)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5067)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-WAS'] and (EventID=5153)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6001)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6002)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6003)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6004)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6005)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6006)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6007)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6008)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6009)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6010)]]",
                              "System!*[System[Provider[@Name='Microsoft-Windows-W3LOGSVC'] and (EventID=6011)]]",
                              "System!*[System[Provider[@Name='Service Control Manager'] and (EventID=7023 or EventID=7024)]]",
                              "System!*[System[Provider[@Name='Service Control Manager'] and (EventID=7031)]]",
                              "System!*[System[Provider[@Name='Service Control Manager'] and (EventID=7034)]]",
                              "System!*[System[Provider[@Name='Service Control Manager'] and (EventID=7043)]]"
                            ],
                            "performanceCounters": [
                              "\\Web Service(_Total)\\Bytes Received/sec",
                              "\\Web Service(_Total)\\Bytes Sent/sec",
                              "\\Web Service(_Total)\\Bytes Total/sec",
                              "\\Web Service(_Total)\\Connection Attempts/sec",
                              "\\Web Service(_Total)\\Current Connections",
                              "\\Web Service(_Total)\\Total Method Requests/sec",
                              "\\Microsoft FTP Service(_Total)\\Bytes Total/sec",
                              "\\Microsoft FTP Service(_Total)\\Current Connections",
                              "\\SMTP Server(_Total)\\Bytes Received/sec",
                              "\\SMTP Server(_Total)\\Bytes Sent/sec",
                              "\\SMTP Server(_Total)\\Bytes Total/sec",
                              "\\SMTP Server(_Total)\\Inbound Connections Current",
                              "\\SMTP Server(_Total)\\Message Bytes Received/sec",
                              "\\SMTP Server(_Total)\\Message Bytes Sent/sec",
                              "\\SMTP Server(_Total)\\Messages Delivered/sec",
                              "\\SMTP Server(_Total)\\Messages Received/sec",
                              "\\SMTP Server(_Total)\\Messages Sent/sec",
                              "\\SMTP Server(_Total)\\Outbound Connections Current",
                              "\\SMTP Server(_Total)\\Total Messages Submitted",
                              "\\SMTP Server(SMTP 1)\\Bytes Received/sec",
                              "\\SMTP Server(SMTP 1)\\Bytes Sent/sec",
                              "\\SMTP Server(SMTP 1)\\Bytes Total/sec",
                              "\\SMTP Server(SMTP 1)\\Inbound Connections Current",
                              "\\SMTP Server(SMTP 1)\\Message Bytes Received/sec",
                              "\\SMTP Server(SMTP 1)\\Message Bytes Sent/sec",
                              "\\SMTP Server(SMTP 1)\\Messages Delivered/sec",
                              "\\SMTP Server(SMTP 1)\\Messages Received/sec",
                              "\\SMTP Server(SMTP 1)\\Messages Sent/sec",
                              "\\SMTP Server(SMTP 1)\\Outbound Connections Current",
                              "\\SMTP Server(SMTP 1)\\Total Messages Submitted"
                            ]
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('Alerts-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "AGId": {
                                    "value": "[parameters('actionGroupResourceId')]"
                                  },
                                  "packtag": {
                                    "value": "[parameters('packtag')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "instanceName": {
                                    "value": "[parameters('instanceName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "9461356001780640398"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "AGId": {
                                      "type": "string"
                                    },
                                    "packtag": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "instanceName": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "moduleprefix": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                                    "alertlist": [
                                      {
                                        "alertRuleDescription": "A server side include file has included itself or the maximum depth of server side includes has been exceeded",
                                        "alertRuleDisplayName": "A server side include file has included itself or the maximum depth of server side includes has been exceeded",
                                        "alertRuleName": "AlertRule-IIS-2012-1",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2221) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Application Pool has an IdleTimeout equal to or greater than the PeriodicRestart time",
                                        "alertRuleDisplayName": "Application Pool has an IdleTimeout equal to or greater than the PeriodicRestart time",
                                        "alertRuleName": "AlertRule-IIS-2012-2",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5152) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "Application Pool worker process is unresponsive",
                                        "alertRuleDisplayName": "Application Pool worker process is unresponsive",
                                        "alertRuleName": "AlertRule-IIS-2012-3",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5010,5011,5012,5013) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "Application Pool worker process terminated unexpectedly",
                                        "alertRuleDisplayName": "Application Pool worker process terminated unexpectedly",
                                        "alertRuleName": "AlertRule-IIS-2012-4",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5009) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "ASP application error occurred",
                                        "alertRuleDisplayName": "ASP application error occurred",
                                        "alertRuleName": "AlertRule-IIS-2012-5",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (500,499,23,22,21,20,19,18,17,16,9,8,7,6,5) and EventLog == 'Application' and Source == 'Active Server Pages'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP control channel for the WWW Service did not open",
                                        "alertRuleDisplayName": "HTTP control channel for the WWW Service did not open",
                                        "alertRuleName": "AlertRule-IIS-2012-6",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1037) and EventLog == 'System' and Source == 'Microsoft-Windows-IIS-W3SVC'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not create a client connection object for user",
                                        "alertRuleDisplayName": "HTTP Server could not create a client connection object for user",
                                        "alertRuleName": "AlertRule-IIS-2012-7",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2208) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not create the main connection socket",
                                        "alertRuleDisplayName": "HTTP Server could not create the main connection socket",
                                        "alertRuleName": "AlertRule-IIS-2012-8",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2206) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not initialize its security",
                                        "alertRuleDisplayName": "HTTP Server could not initialize its security",
                                        "alertRuleName": "AlertRule-IIS-2012-9",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2201) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server could not initialize the socket library",
                                        "alertRuleDisplayName": "HTTP Server could not initialize the socket library",
                                        "alertRuleName": "AlertRule-IIS-2012-10",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2203) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "HTTP Server was unable to initialize due to a shortage of available memory",
                                        "alertRuleDisplayName": "HTTP Server was unable to initialize due to a shortage of available memory",
                                        "alertRuleName": "AlertRule-IIS-2012-11",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2204) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "ISAPI application error detected",
                                        "alertRuleDisplayName": "ISAPI application error detected",
                                        "alertRuleName": "AlertRule-IIS-2012-12",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2274,2268,2220,2219,2214) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Job object associated with the application pool encountered an error",
                                        "alertRuleDisplayName": "Job object associated with the application pool encountered an error",
                                        "alertRuleName": "AlertRule-IIS-2012-13",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5088,5061,5060) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "Module has an invalid precondition",
                                        "alertRuleDisplayName": "Module has an invalid precondition",
                                        "alertRuleName": "AlertRule-IIS-2012-14",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2296) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Module registration error detected (failed to find RegisterModule entrypoint)",
                                        "alertRuleDisplayName": "Module registration error detected (failed to find RegisterModule entrypoint)",
                                        "alertRuleName": "AlertRule-IIS-2012-15",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2295) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Module registration error detected (module returned an error during registration)",
                                        "alertRuleDisplayName": "Module registration error detected (module returned an error during registration)",
                                        "alertRuleName": "AlertRule-IIS-2012-16",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2293) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "Only one type of logging can be enabled at a time",
                                        "alertRuleDisplayName": "Only one type of logging can be enabled at a time",
                                        "alertRuleName": "AlertRule-IIS-2012-17",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1133) and EventLog == 'System' and Source == 'Microsoft-Windows-IIS-W3SVC'"
                                      },
                                      {
                                        "alertRuleDescription": "SF_NOTIFY_READ_RAW_DATA filter notification is not supported in IIS 8",
                                        "alertRuleDisplayName": "SF_NOTIFY_READ_RAW_DATA filter notification is not supported in IIS 8",
                                        "alertRuleName": "AlertRule-IIS-2012-18",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2261) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The configuration manager for WAS did not initialize",
                                        "alertRuleDisplayName": "The configuration manager for WAS did not initialize",
                                        "alertRuleName": "AlertRule-IIS-2012-19",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5036) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      },
                                      {
                                        "alertRuleDescription": "The directory specified for caching compressed content is invalid",
                                        "alertRuleDisplayName": "The directory specified for caching compressed content is invalid",
                                        "alertRuleName": "AlertRule-IIS-2012-20",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2264) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The Global Modules list is empty",
                                        "alertRuleDisplayName": "The Global Modules list is empty",
                                        "alertRuleName": "AlertRule-IIS-2012-21",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2298) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The HTTP server encountered an error processing the server side include file",
                                        "alertRuleDisplayName": "The HTTP server encountered an error processing the server side include file",
                                        "alertRuleName": "AlertRule-IIS-2012-22",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2218) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server failed to close client connections to URLs during shutdown",
                                        "alertRuleDisplayName": "The server failed to close client connections to URLs during shutdown",
                                        "alertRuleName": "AlertRule-IIS-2012-23",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2258) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server was unable to acquire a license for a SSL connection",
                                        "alertRuleDisplayName": "The server was unable to acquire a license for a SSL connection",
                                        "alertRuleName": "AlertRule-IIS-2012-24",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2227) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server was unable to allocate a buffer to read a file",
                                        "alertRuleDisplayName": "The server was unable to allocate a buffer to read a file",
                                        "alertRuleName": "AlertRule-IIS-2012-25",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2233) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "The server was unable to read a file",
                                        "alertRuleDisplayName": "The server was unable to read a file",
                                        "alertRuleName": "AlertRule-IIS-2012-26",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2226,2230,2231,2232) and EventLog == 'Application' and Source == 'Microsoft-Windows-IIS-W3SVC-WP'"
                                      },
                                      {
                                        "alertRuleDescription": "WAS detected invalid configuration data",
                                        "alertRuleDisplayName": "WAS detected invalid configuration data",
                                        "alertRuleName": "AlertRule-IIS-2012-27",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5174,5179,5180) and EventLog == 'System' and Source == 'Microsoft-Windows-WAS'"
                                      }
                                    ]
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "[format('{0}-Alerts', variables('moduleprefix'))]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "alertlist": {
                                            "value": "[variables('alertlist')]"
                                          },
                                          "AGId": {
                                            "value": "[parameters('AGId')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "moduleprefix": {
                                            "value": "[variables('moduleprefix')]"
                                          },
                                          "packtag": {
                                            "value": "[parameters('packtag')]"
                                          },
                                          "Tags": {
                                            "value": "[parameters('Tags')]"
                                          },
                                          "workspaceId": {
                                            "value": "[parameters('workspaceId')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "17858688129795365440"
                                            }
                                          },
                                          "parameters": {
                                            "alertlist": {
                                              "type": "array"
                                            },
                                            "location": {
                                              "type": "string"
                                            },
                                            "workspaceId": {
                                              "type": "string"
                                            },
                                            "AGId": {
                                              "type": "string"
                                            },
                                            "packtag": {
                                              "type": "string"
                                            },
                                            "Tags": {
                                              "type": "object"
                                            },
                                            "moduleprefix": {
                                              "type": "string"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "copy": {
                                                "name": "Alerts",
                                                "count": "[length(parameters('alertlist'))]"
                                              },
                                              "type": "Microsoft.Resources/deployments",
                                              "apiVersion": "2022-09-01",
                                              "name": "[format('{0}-Alert-{1}', parameters('packtag'), copyIndex())]",
                                              "properties": {
                                                "expressionEvaluationOptions": {
                                                  "scope": "inner"
                                                },
                                                "mode": "Incremental",
                                                "parameters": {
                                                  "location": {
                                                    "value": "[parameters('location')]"
                                                  },
                                                  "actionGroupResourceId": {
                                                    "value": "[parameters('AGId')]"
                                                  },
                                                  "alertRuleDescription": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleDescription]"
                                                  },
                                                  "alertRuleDisplayName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleDisplayName)]"
                                                  },
                                                  "alertRuleName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleName)]"
                                                  },
                                                  "alertRuleSeverity": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleSeverity]"
                                                  },
                                                  "autoMitigate": {
                                                    "value": "[parameters('alertlist')[copyIndex()].autoMitigate]"
                                                  },
                                                  "evaluationFrequency": {
                                                    "value": "[parameters('alertlist')[copyIndex()].evaluationFrequency]"
                                                  },
                                                  "windowSize": {
                                                    "value": "[parameters('alertlist')[copyIndex()].windowSize]"
                                                  },
                                                  "scope": {
                                                    "value": "[parameters('workspaceId')]"
                                                  },
                                                  "query": {
                                                    "value": "[parameters('alertlist')[copyIndex()].query]"
                                                  },
                                                  "dimensions": "[if(contains(parameters('alertlist')[copyIndex()], 'dimensions'), createObject('value', parameters('alertlist')[copyIndex()].dimensions), createObject('value', null()))]",
                                                  "packtag": {
                                                    "value": "[parameters('packtag')]"
                                                  },
                                                  "Tags": {
                                                    "value": "[parameters('Tags')]"
                                                  },
                                                  "alertType": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertType]"
                                                  },
                                                  "metricMeasureColumn": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].metricMeasureColumn), createObject('value', null()))]",
                                                  "operator": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].operator), createObject('value', null()))]",
                                                  "threshold": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].threshold), createObject('value', null()))]"
                                                },
                                                "template": {
                                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                  "contentVersion": "1.0.0.0",
                                                  "metadata": {
                                                    "_generator": {
                                                      "name": "bicep",
                                                      "version": "0.32.4.45862",
                                                      "templateHash": "10159755056440989647"
                                                    }
                                                  },
                                                  "parameters": {
                                                    "alertType": {
                                                      "type": "string",
                                                      "allowedValues": [
                                                        "rows",
                                                        "Aggregated"
                                                      ]
                                                    },
                                                    "alertRuleName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDisplayName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDescription": {
                                                      "type": "string"
                                                    },
                                                    "scope": {
                                                      "type": "string"
                                                    },
                                                    "actionGroupResourceId": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleSeverity": {
                                                      "type": "int"
                                                    },
                                                    "location": {
                                                      "type": "string"
                                                    },
                                                    "windowSize": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "evaluationFrequency": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "autoMitigate": {
                                                      "type": "bool",
                                                      "defaultValue": false
                                                    },
                                                    "query": {
                                                      "type": "string"
                                                    },
                                                    "packtag": {
                                                      "type": "string"
                                                    },
                                                    "Tags": {
                                                      "type": "object"
                                                    },
                                                    "threshold": {
                                                      "type": "int",
                                                      "defaultValue": 0
                                                    },
                                                    "metricMeasureColumn": {
                                                      "type": "string",
                                                      "defaultValue": ""
                                                    },
                                                    "dimensions": {
                                                      "type": "array",
                                                      "defaultValue": [
                                                        {
                                                          "name": "Computer",
                                                          "operator": "Include",
                                                          "values": [
                                                            "*"
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    "operator": {
                                                      "type": "string",
                                                      "defaultValue": "GreaterThan",
                                                      "allowedValues": [
                                                        "GreaterThan",
                                                        "GreaterThanOrEqual",
                                                        "LessThan",
                                                        "LessThanOrEqual",
                                                        "Equal",
                                                        "NotEqual"
                                                      ]
                                                    }
                                                  },
                                                  "resources": [
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'rows')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "16566470716356207302"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Count",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "GreaterThan",
                                                                      "threshold": 0,
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    },
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'Aggregated')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          },
                                                          "threshold": {
                                                            "value": "[parameters('threshold')]"
                                                          },
                                                          "metricMeasureColumn": {
                                                            "value": "[parameters('metricMeasureColumn')]"
                                                          },
                                                          "operator": {
                                                            "value": "[parameters('operator')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "18444959286864838274"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "threshold": {
                                                              "type": "int"
                                                            },
                                                            "metricMeasureColumn": {
                                                              "type": "string"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            },
                                                            "operator": {
                                                              "type": "string",
                                                              "allowedValues": [
                                                                "GreaterThan",
                                                                "GreaterThanOrEqual",
                                                                "LessThan",
                                                                "LessThanOrEqual",
                                                                "Equal",
                                                                "NotEqual"
                                                              ]
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Average",
                                                                      "metricMeasureColumn": "[parameters('metricMeasureColumn')]",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "[parameters('operator')]",
                                                                      "threshold": "[parameters('threshold')]",
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    }
                                                  ]
                                                }
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('dcrPerformance-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "rulename": {
                                    "value": "[variables('rulename')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "wsfriendlyname": {
                                    "value": "[variables('workspaceFriendlyName')]"
                                  },
                                  "kind": {
                                    "value": "[variables('kind')]"
                                  },
                                  "xPathQueries": {
                                    "value": "[variables('xPathQueries')]"
                                  },
                                  "counterSpecifiers": {
                                    "value": "[variables('performanceCounters')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "dceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "15691414683408659274"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "rulename": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "kind": {
                                      "type": "string",
                                      "defaultValue": "Windows"
                                    },
                                    "wsfriendlyname": {
                                      "type": "string",
                                      "defaultValue": "TBD"
                                    },
                                    "xPathQueries": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "counterSpecifiers": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "samplingFrequencyInSeconds": {
                                      "type": "int",
                                      "defaultValue": 300
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "dceId": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('rulename')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "[parameters('kind')]",
                                      "properties": {
                                        "dataCollectionEndpointId": "[parameters('dceId')]",
                                        "description": "[format('Data Collection Rule for {0}}} - {1}}}', parameters('kind'), parameters('rulename'))]",
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('workspaceId')]",
                                              "name": "[parameters('wsfriendlyname')]"
                                            }
                                          ]
                                        },
                                        "dataSources": {
                                          "windowsEventLogs": "[if(empty(parameters('xPathQueries')), null(), createArray(createObject('streams', createArray('Microsoft-Event'), 'xPathQueries', parameters('xPathQueries'), 'name', 'EventLogsDataSource')))]",
                                          "performanceCounters": [
                                            {
                                              "streams": [
                                                "Microsoft-Perf"
                                              ],
                                              "samplingFrequencyInSeconds": "[parameters('samplingFrequencyInSeconds')]",
                                              "counterSpecifiers": "[parameters('counterSpecifiers')]",
                                              "name": "PerfCountersDataSource"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-Event",
                                              "Microsoft-Perf"
                                            ],
                                            "destinations": [
                                              "[parameters('wsfriendlyname')]"
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "dcrId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('rulename'))]"
                                    }
                                  }
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('dcrIISLogs-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "ruleName": {
                                    "value": "[format('{0}-IISLogs', variables('rulename'))]"
                                  },
                                  "lawResourceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "endpointResourceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "11212238793022467482"
                                    }
                                  },
                                  "parameters": {
                                    "ruleName": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the name of the data collection rule to create."
                                      }
                                    },
                                    "endpointResourceId": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the resource id of the data collection endpoint."
                                      }
                                    },
                                    "location": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the location in which to create the data collection rule."
                                      }
                                    },
                                    "lawResourceId": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    }
                                  },
                                  "variables": {
                                    "lawFriendlyName": "[split(parameters('lawResourceId'), '/')[8]]"
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('ruleName')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "Windows",
                                      "properties": {
                                        "dataCollectionEndpointId": "[parameters('endpointResourceId')]",
                                        "dataSources": {
                                          "iisLogs": [
                                            {
                                              "streams": [
                                                "Microsoft-W3CIISLog"
                                              ],
                                              "name": "iisLogsDataSource"
                                            }
                                          ]
                                        },
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('lawResourceId')]",
                                              "name": "[variables('lawFriendlyName')]"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-W3CIISLog"
                                            ],
                                            "destinations": [
                                              "[variables('lawFriendlyName')]"
                                            ],
                                            "transformKql": "source",
                                            "outputStream": "Microsoft-W3CIISLog"
                                          }
                                        ],
                                        "streamDeclarations": {
                                          "Custom-MyTable_CL": {
                                            "columns": [
                                              {
                                                "name": "TimeGenerated",
                                                "type": "datetime"
                                              },
                                              {
                                                "name": "RawData",
                                                "type": "string"
                                              }
                                            ]
                                          }
                                        }
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "dcrId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('ruleName'))]"
                                    }
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('DNS2016-deployment-{0}-{1}', parameters('instanceName'), parameters('location'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "mgname": {
                            "value": "[parameters('mgname')]"
                          },
                          "resourceGroupId": {
                            "value": "[parameters('resourceGroupId')]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "solutionVersion": {
                            "value": "[parameters('solutionVersion')]"
                          },
                          "subscriptionId": {
                            "value": "[parameters('subscriptionId')]"
                          },
                          "userManagedIdentityResourceId": {
                            "value": "[parameters('userManagedIdentityResourceId')]"
                          },
                          "workspaceId": {
                            "value": "[parameters('workspaceId')]"
                          },
                          "customerTags": {
                            "value": "[parameters('customerTags')]"
                          },
                          "actionGroupResourceId": {
                            "value": "[parameters('actionGroupResourceId')]"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "5222498176192057785"
                            }
                          },
                          "parameters": {
                            "location": {
                              "type": "string",
                              "metadata": {
                                "description": "location for the deployment."
                              }
                            },
                            "workspaceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                              }
                            },
                            "packtag": {
                              "type": "string",
                              "defaultValue": "DNS2016"
                            },
                            "dceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                              }
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the user managed identity to be used for the deployment"
                              }
                            },
                            "mgname": {
                              "type": "string"
                            },
                            "subscriptionId": {
                              "type": "string"
                            },
                            "resourceGroupId": {
                              "type": "string"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "solutionVersion": {
                              "type": "string"
                            },
                            "customerTags": {
                              "type": "object"
                            },
                            "actionGroupResourceId": {
                              "type": "string"
                            },
                            "instanceName": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "rulename": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "tempTags": {
                              "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                              "MonitoringPackType": "IaaS",
                              "solutionVersion": "[parameters('solutionVersion')]"
                            },
                            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                            "workspaceFriendlyName": "[split(parameters('workspaceId'), '/')[8]]",
                            "ruleshortname": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
                            "kind": "Windows",
                            "xPathQueries": [
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=10)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=1000)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=1004)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=1200)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=1201)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=1203)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=131)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=140)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=150)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=1540)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4000)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4006)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4007)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4010)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4011)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4012)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4014)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4015)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4016)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4017)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=408)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=409)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=410)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=414)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4510)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4511)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4512)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=501)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=502)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=503)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=504)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=5051)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=6527)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=6702)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=706)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=7060)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=7616)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=7636)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=7642)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=7644)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=777)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=111 or EventID=6533)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4018 or EventID=4019)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4513 or EventID=4514)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=4520 or EventID=4521)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=707 or EventID=1003)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=7692 or EventID=790)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=796 or EventID=799)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=2200 or EventID=2202 or EventID=2203)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=7502 or EventID=7503 or EventID=7504)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=792 or EventID=795 or EventID=797)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=1001 or EventID=1008 or EventID=3151 or EventID=3152 or EventID=3153)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=403 or EventID=404 or EventID=405 or EventID=406 or EventID=407)]]",
                              "DNS Server!*[System[Provider[@Name='Microsoft-Windows-DNS-Server-Service'] and (EventID=500 or EventID=505 or EventID=506 or EventID=507 or EventID=2204)]]"
                            ],
                            "performanceCounters": [
                              "\\DNS\\AXFR Request Received",
                              "\\DNS\\AXFR Request Sent",
                              "\\DNS\\AXFR Response Received",
                              "\\DNS\\AXFR Success Received",
                              "\\DNS\\AXFR Success Sent",
                              "\\DNS\\Caching Memory",
                              "\\DNS\\Data Flush Pages/sec",
                              "\\DNS\\Data Flushes/sec",
                              "\\DNS\\Database Node Memory",
                              "\\DNS\\Dynamic Update NoOperation",
                              "\\DNS\\Dynamic Update NoOperation/sec",
                              "\\DNS\\Dynamic Update Queued",
                              "\\DNS\\Dynamic Update Received",
                              "\\DNS\\Dynamic Update Received/sec",
                              "\\DNS\\Dynamic Update Rejected",
                              "\\DNS\\Dynamic Update TimeOuts",
                              "\\DNS\\Dynamic Update Written to Database",
                              "\\DNS\\Dynamic Update Written to Database/sec",
                              "\\DNS\\IXFR Request Received",
                              "\\DNS\\IXFR Request Sent",
                              "\\DNS\\IXFR Response Received",
                              "\\DNS\\IXFR Success Received",
                              "\\DNS\\IXFR Success Sent",
                              "\\DNS\\IXFR TCP Success Received",
                              "\\DNS\\IXFR UDP Success Received",
                              "\\DNS\\Nbstat Memory",
                              "\\DNS\\Notify Received",
                              "\\DNS\\Notify Sent",
                              "\\DNS\\Query Dropped Bad Socket",
                              "\\DNS\\Query Dropped Bad Socket/sec",
                              "\\DNS\\Query Dropped By Policy",
                              "\\DNS\\Query Dropped By Policy/sec",
                              "\\DNS\\Query Dropped By Response Rate Limiting",
                              "\\DNS\\Query Dropped By Response Rate Limiting/sec",
                              "\\DNS\\Query Dropped Send",
                              "\\DNS\\Query Dropped Send/sec",
                              "\\DNS\\Query Dropped Total",
                              "\\DNS\\Query Dropped Total/sec",
                              "\\DNS\\Record Flow Memory",
                              "\\DNS\\Recursive Queries",
                              "\\DNS\\Recursive Queries/sec",
                              "\\DNS\\Recursive Query Failure",
                              "\\DNS\\Recursive Query Failure/sec",
                              "\\DNS\\Recursive Send TimeOuts",
                              "\\DNS\\Recursive TimeOut/sec",
                              "\\DNS\\Responses Suppressed",
                              "\\DNS\\Responses Suppressed/sec",
                              "\\DNS\\Secure Update Failure",
                              "\\DNS\\Secure Update Received",
                              "\\DNS\\Secure Update Received/sec",
                              "\\DNS\\TCP Message Memory",
                              "\\DNS\\TCP Query Received",
                              "\\DNS\\TCP Query Received/sec",
                              "\\DNS\\TCP Response Sent",
                              "\\DNS\\TCP Response Sent/sec",
                              "\\DNS\\Total Query Received",
                              "\\DNS\\Total Query Received/sec",
                              "\\DNS\\Total Remote Inflight Queries",
                              "\\DNS\\Total Response Sent",
                              "\\DNS\\Total Response Sent/sec",
                              "\\DNS\\UDP Message Memory",
                              "\\DNS\\UDP Query Received",
                              "\\DNS\\UDP Query Received/sec",
                              "\\DNS\\UDP Response Sent",
                              "\\DNS\\UDP Response Sent/sec",
                              "\\DNS\\Unmatched Responses Received",
                              "\\DNS\\WINS Lookup Received",
                              "\\DNS\\WINS Lookup Received/sec",
                              "\\DNS\\WINS Response Sent",
                              "\\DNS\\WINS Response Sent/sec",
                              "\\DNS\\WINS Reverse Lookup Received",
                              "\\DNS\\WINS Reverse Lookup Received/sec",
                              "\\DNS\\WINS Reverse Response Sent",
                              "\\DNS\\WINS Reverse Response Sent/sec",
                              "\\DNS\\Zone Transfer Failure",
                              "\\DNS\\Zone Transfer Request Received",
                              "\\DNS\\Zone Transfer SOA Request Sent",
                              "\\DNS\\Zone Transfer Success"
                            ]
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('Alerts-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "AGId": {
                                    "value": "[parameters('actionGroupResourceId')]"
                                  },
                                  "packtag": {
                                    "value": "[parameters('packtag')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "instanceName": {
                                    "value": "[parameters('instanceName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "10681976057115393931"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "AGId": {
                                      "type": "string"
                                    },
                                    "packtag": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "instanceName": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "moduleprefix": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                                    "alertlist": [
                                      {
                                        "alertRuleDescription": "Service.DependencyFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Service.DependencyFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-10",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (10) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.FileOpenError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.FileOpenError",
                                        "alertRuleName": "AlertRule-Dns-2016-1000",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1000) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.CouldNotOpenDatabase",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.CouldNotOpenDatabase",
                                        "alertRuleName": "AlertRule-Dns-2016-1004",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1004) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.BootFileNotFound",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.BootFileNotFound",
                                        "alertRuleName": "AlertRule-Dns-2016-1200",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1200) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.ZoneCreationFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.ZoneCreationFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-1201",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1201) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.NoForwardingAddresses",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.NoForwardingAddresses",
                                        "alertRuleName": "AlertRule-Dns-2016-1203",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1203) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "WINSConnector.Initialize.Failed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.WINSConnector.Initialize.Failed",
                                        "alertRuleName": "AlertRule-Dns-2016-131",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (131) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "RPC.Initialize.Failed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.RPC.Initialize.Failed",
                                        "alertRuleName": "AlertRule-Dns-2016-140",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (140) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.PluginInitFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.PluginInitFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-150",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (150) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.DomainNodeCreationError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.DomainNodeCreationError",
                                        "alertRuleName": "AlertRule-Dns-2016-1540",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1540) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.OpenFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.OpenFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4000",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4000) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.LoadFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.LoadFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4006",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4006) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.OpenPartitionFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.OpenPartitionFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4007",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4007) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.RecordLoadFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.RecordLoadFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4010",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4010) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.WriteFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.WriteFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4011",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4011) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.WriteTimeout",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.WriteTimeout",
                                        "alertRuleName": "AlertRule-Dns-2016-4012",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4012) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.SecurityInterfaceFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.SecurityInterfaceFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4014",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4014) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.InterfaceError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.InterfaceError",
                                        "alertRuleName": "AlertRule-Dns-2016-4015",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4015) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.LDAPTimeout",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.LDAPTimeout",
                                        "alertRuleName": "AlertRule-Dns-2016-4016",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4016) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.DNSAdminsError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.DNSAdminsError",
                                        "alertRuleName": "AlertRule-Dns-2016-4017",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4017) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.OpenSocketForAddress",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.OpenSocketForAddress",
                                        "alertRuleName": "AlertRule-Dns-2016-408",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (408) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.UpdateListenAddresses",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.UpdateListenAddresses",
                                        "alertRuleName": "AlertRule-Dns-2016-409",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (409) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.InvalidListenAddresses",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.InvalidListenAddresses",
                                        "alertRuleName": "AlertRule-Dns-2016-410",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (410) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.SingleLabelHostname",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.SingleLabelHostname",
                                        "alertRuleName": "AlertRule-Dns-2016-414",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (414) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.FSMOUnavailable",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.FSMOUnavailable",
                                        "alertRuleName": "AlertRule-Dns-2016-4510",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4510) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.DeleteError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.DeleteError",
                                        "alertRuleName": "AlertRule-Dns-2016-4511",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4511) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.PartitionCreateError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.PartitionCreateError",
                                        "alertRuleName": "AlertRule-Dns-2016-4512",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4512) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.InvalidZoneType",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.InvalidZoneType",
                                        "alertRuleName": "AlertRule-Dns-2016-501",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (501) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.NoZoneFile",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.NoZoneFile",
                                        "alertRuleName": "AlertRule-Dns-2016-502",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (502) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.SecondaryRequiresMasters",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.SecondaryRequiresMasters",
                                        "alertRuleName": "AlertRule-Dns-2016-503",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (503) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.RegZoneCreationFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.RegZoneCreationFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-504",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (504) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Service.Memory.Warning",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Service.Memory.Warning",
                                        "alertRuleName": "AlertRule-Dns-2016-5051",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (5051) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.ZoneExpiration",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.ZoneExpiration",
                                        "alertRuleName": "AlertRule-Dns-2016-6527",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (6527) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.UpdateDSPeersFailure",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.UpdateDSPeersFailure",
                                        "alertRuleName": "AlertRule-Dns-2016-6702",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (6702) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "RootHints.NoRootNameServer",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.RootHints.NoRootNameServer",
                                        "alertRuleName": "AlertRule-Dns-2016-706",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (706) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Service.ConnectionError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Service.ConnectionError",
                                        "alertRuleName": "AlertRule-Dns-2016-7060",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (7060) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "DNSSEC.TALoadFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.DNSSEC.TALoadFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-7616",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (7616) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "DNSSEC.TPDeleted",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.DNSSEC.TPDeleted",
                                        "alertRuleName": "AlertRule-Dns-2016-7636",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (7636) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "DNSSEC.InvalidTA",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.DNSSEC.InvalidTA",
                                        "alertRuleName": "AlertRule-Dns-2016-7642",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (7642) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "DNSSEC.TARefreshFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.DNSSEC.TARefreshFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-7644",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (7644) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "DNSSEC.ZoneUnSignFailure",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.DNSSEC.ZoneUnSignFailure",
                                        "alertRuleName": "AlertRule-Dns-2016-777",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (777) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Service.ThreadCreationFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Service.ThreadCreationFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-111",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (111,6533) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.BackgroundLoadFailure",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.BackgroundLoadFailure",
                                        "alertRuleName": "AlertRule-Dns-2016-4018",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4018,4019) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.EnlistmentFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.EnlistmentFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4513",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4513,4514) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ADI.RetryableZoneOperationFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.ADI.RetryableZoneOperationFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-4520",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (4520,4521) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "RootHints.CacheFileError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.RootHints.CacheFileError",
                                        "alertRuleName": "AlertRule-Dns-2016-707",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (707,1003) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Server.EDNS0.ZoneTransfer.OptionInvalid",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.Server.EDNS0.ZoneTransfer.OptionInvalid",
                                        "alertRuleName": "AlertRule-Dns-2016-7692",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (7692,790) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "ClientSubnet.LoadFail",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.ClientSubnet.LoadFail",
                                        "alertRuleName": "AlertRule-Dns-2016-796",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (796,799) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.RegistryOperationFailed",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.RegistryOperationFailed",
                                        "alertRuleName": "AlertRule-Dns-2016-2200",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (2200,2202,2203) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Service.Memory.Error",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Service.Memory.Error",
                                        "alertRuleName": "AlertRule-Dns-2016-7502",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (7502,7503,7504) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Policy.ServerLevel.LoadFail",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Rules.Policy.ServerLevel.LoadFail",
                                        "alertRuleName": "AlertRule-Dns-2016-792",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (792,795,797) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Service.FileError",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Service.FileError",
                                        "alertRuleName": "AlertRule-Dns-2016-1001",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (1001,1008,3151,3152,3153) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Service.SocketFailure",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Service.SocketFailure",
                                        "alertRuleName": "AlertRule-Dns-2016-403",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (403,404,405,406,407) and EventLog == 'DNS Server'"
                                      },
                                      {
                                        "alertRuleDescription": "Configuration.InvalidRegistrySetting",
                                        "alertRuleDisplayName": "Microsoft.Windows.DNSServer.2016.Configuration.InvalidRegistrySetting",
                                        "alertRuleName": "AlertRule-Dns-2016-500",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (500,505,506,507,2204) and EventLog == 'DNS Server'"
                                      }
                                    ]
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "[format('{0}-Alerts', variables('moduleprefix'))]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "alertlist": {
                                            "value": "[variables('alertlist')]"
                                          },
                                          "AGId": {
                                            "value": "[parameters('AGId')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "moduleprefix": {
                                            "value": "[variables('moduleprefix')]"
                                          },
                                          "packtag": {
                                            "value": "[parameters('packtag')]"
                                          },
                                          "Tags": {
                                            "value": "[parameters('Tags')]"
                                          },
                                          "workspaceId": {
                                            "value": "[parameters('workspaceId')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "17858688129795365440"
                                            }
                                          },
                                          "parameters": {
                                            "alertlist": {
                                              "type": "array"
                                            },
                                            "location": {
                                              "type": "string"
                                            },
                                            "workspaceId": {
                                              "type": "string"
                                            },
                                            "AGId": {
                                              "type": "string"
                                            },
                                            "packtag": {
                                              "type": "string"
                                            },
                                            "Tags": {
                                              "type": "object"
                                            },
                                            "moduleprefix": {
                                              "type": "string"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "copy": {
                                                "name": "Alerts",
                                                "count": "[length(parameters('alertlist'))]"
                                              },
                                              "type": "Microsoft.Resources/deployments",
                                              "apiVersion": "2022-09-01",
                                              "name": "[format('{0}-Alert-{1}', parameters('packtag'), copyIndex())]",
                                              "properties": {
                                                "expressionEvaluationOptions": {
                                                  "scope": "inner"
                                                },
                                                "mode": "Incremental",
                                                "parameters": {
                                                  "location": {
                                                    "value": "[parameters('location')]"
                                                  },
                                                  "actionGroupResourceId": {
                                                    "value": "[parameters('AGId')]"
                                                  },
                                                  "alertRuleDescription": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleDescription]"
                                                  },
                                                  "alertRuleDisplayName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleDisplayName)]"
                                                  },
                                                  "alertRuleName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleName)]"
                                                  },
                                                  "alertRuleSeverity": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleSeverity]"
                                                  },
                                                  "autoMitigate": {
                                                    "value": "[parameters('alertlist')[copyIndex()].autoMitigate]"
                                                  },
                                                  "evaluationFrequency": {
                                                    "value": "[parameters('alertlist')[copyIndex()].evaluationFrequency]"
                                                  },
                                                  "windowSize": {
                                                    "value": "[parameters('alertlist')[copyIndex()].windowSize]"
                                                  },
                                                  "scope": {
                                                    "value": "[parameters('workspaceId')]"
                                                  },
                                                  "query": {
                                                    "value": "[parameters('alertlist')[copyIndex()].query]"
                                                  },
                                                  "dimensions": "[if(contains(parameters('alertlist')[copyIndex()], 'dimensions'), createObject('value', parameters('alertlist')[copyIndex()].dimensions), createObject('value', null()))]",
                                                  "packtag": {
                                                    "value": "[parameters('packtag')]"
                                                  },
                                                  "Tags": {
                                                    "value": "[parameters('Tags')]"
                                                  },
                                                  "alertType": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertType]"
                                                  },
                                                  "metricMeasureColumn": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].metricMeasureColumn), createObject('value', null()))]",
                                                  "operator": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].operator), createObject('value', null()))]",
                                                  "threshold": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].threshold), createObject('value', null()))]"
                                                },
                                                "template": {
                                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                  "contentVersion": "1.0.0.0",
                                                  "metadata": {
                                                    "_generator": {
                                                      "name": "bicep",
                                                      "version": "0.32.4.45862",
                                                      "templateHash": "10159755056440989647"
                                                    }
                                                  },
                                                  "parameters": {
                                                    "alertType": {
                                                      "type": "string",
                                                      "allowedValues": [
                                                        "rows",
                                                        "Aggregated"
                                                      ]
                                                    },
                                                    "alertRuleName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDisplayName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDescription": {
                                                      "type": "string"
                                                    },
                                                    "scope": {
                                                      "type": "string"
                                                    },
                                                    "actionGroupResourceId": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleSeverity": {
                                                      "type": "int"
                                                    },
                                                    "location": {
                                                      "type": "string"
                                                    },
                                                    "windowSize": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "evaluationFrequency": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "autoMitigate": {
                                                      "type": "bool",
                                                      "defaultValue": false
                                                    },
                                                    "query": {
                                                      "type": "string"
                                                    },
                                                    "packtag": {
                                                      "type": "string"
                                                    },
                                                    "Tags": {
                                                      "type": "object"
                                                    },
                                                    "threshold": {
                                                      "type": "int",
                                                      "defaultValue": 0
                                                    },
                                                    "metricMeasureColumn": {
                                                      "type": "string",
                                                      "defaultValue": ""
                                                    },
                                                    "dimensions": {
                                                      "type": "array",
                                                      "defaultValue": [
                                                        {
                                                          "name": "Computer",
                                                          "operator": "Include",
                                                          "values": [
                                                            "*"
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    "operator": {
                                                      "type": "string",
                                                      "defaultValue": "GreaterThan",
                                                      "allowedValues": [
                                                        "GreaterThan",
                                                        "GreaterThanOrEqual",
                                                        "LessThan",
                                                        "LessThanOrEqual",
                                                        "Equal",
                                                        "NotEqual"
                                                      ]
                                                    }
                                                  },
                                                  "resources": [
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'rows')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "16566470716356207302"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Count",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "GreaterThan",
                                                                      "threshold": 0,
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    },
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'Aggregated')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          },
                                                          "threshold": {
                                                            "value": "[parameters('threshold')]"
                                                          },
                                                          "metricMeasureColumn": {
                                                            "value": "[parameters('metricMeasureColumn')]"
                                                          },
                                                          "operator": {
                                                            "value": "[parameters('operator')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "18444959286864838274"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "threshold": {
                                                              "type": "int"
                                                            },
                                                            "metricMeasureColumn": {
                                                              "type": "string"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            },
                                                            "operator": {
                                                              "type": "string",
                                                              "allowedValues": [
                                                                "GreaterThan",
                                                                "GreaterThanOrEqual",
                                                                "LessThan",
                                                                "LessThanOrEqual",
                                                                "Equal",
                                                                "NotEqual"
                                                              ]
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Average",
                                                                      "metricMeasureColumn": "[parameters('metricMeasureColumn')]",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "[parameters('operator')]",
                                                                      "threshold": "[parameters('threshold')]",
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    }
                                                  ]
                                                }
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('dcrPerformance-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "rulename": {
                                    "value": "[variables('rulename')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "wsfriendlyname": {
                                    "value": "[variables('workspaceFriendlyName')]"
                                  },
                                  "kind": {
                                    "value": "[variables('kind')]"
                                  },
                                  "xPathQueries": {
                                    "value": "[variables('xPathQueries')]"
                                  },
                                  "counterSpecifiers": {
                                    "value": "[variables('performanceCounters')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "dceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "15691414683408659274"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "rulename": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "kind": {
                                      "type": "string",
                                      "defaultValue": "Windows"
                                    },
                                    "wsfriendlyname": {
                                      "type": "string",
                                      "defaultValue": "TBD"
                                    },
                                    "xPathQueries": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "counterSpecifiers": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "samplingFrequencyInSeconds": {
                                      "type": "int",
                                      "defaultValue": 300
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "dceId": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('rulename')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "[parameters('kind')]",
                                      "properties": {
                                        "dataCollectionEndpointId": "[parameters('dceId')]",
                                        "description": "[format('Data Collection Rule for {0}}} - {1}}}', parameters('kind'), parameters('rulename'))]",
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('workspaceId')]",
                                              "name": "[parameters('wsfriendlyname')]"
                                            }
                                          ]
                                        },
                                        "dataSources": {
                                          "windowsEventLogs": "[if(empty(parameters('xPathQueries')), null(), createArray(createObject('streams', createArray('Microsoft-Event'), 'xPathQueries', parameters('xPathQueries'), 'name', 'EventLogsDataSource')))]",
                                          "performanceCounters": [
                                            {
                                              "streams": [
                                                "Microsoft-Perf"
                                              ],
                                              "samplingFrequencyInSeconds": "[parameters('samplingFrequencyInSeconds')]",
                                              "counterSpecifiers": "[parameters('counterSpecifiers')]",
                                              "name": "PerfCountersDataSource"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-Event",
                                              "Microsoft-Perf"
                                            ],
                                            "destinations": [
                                              "[parameters('wsfriendlyname')]"
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "dcrId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('rulename'))]"
                                    }
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('PS2016-deployment-{0}-{1}', parameters('instanceName'), parameters('location'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "mgname": {
                            "value": "[parameters('mgname')]"
                          },
                          "resourceGroupId": {
                            "value": "[parameters('resourceGroupId')]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "solutionVersion": {
                            "value": "[parameters('solutionVersion')]"
                          },
                          "subscriptionId": {
                            "value": "[parameters('subscriptionId')]"
                          },
                          "userManagedIdentityResourceId": {
                            "value": "[parameters('userManagedIdentityResourceId')]"
                          },
                          "workspaceId": {
                            "value": "[parameters('workspaceId')]"
                          },
                          "customerTags": {
                            "value": "[parameters('customerTags')]"
                          },
                          "actionGroupResourceId": {
                            "value": "[parameters('actionGroupResourceId')]"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "3719283826261946328"
                            }
                          },
                          "parameters": {
                            "packtag": {
                              "type": "string",
                              "defaultValue": "PS2016",
                              "metadata": {
                                "description": "The tag to be used for the solution."
                              }
                            },
                            "actionGroupResourceId": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string",
                              "metadata": {
                                "description": "location for the deployment."
                              }
                            },
                            "workspaceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                              }
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "solutionVersion": {
                              "type": "string"
                            },
                            "dceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                              }
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the user managed identity to be used for the deployment"
                              }
                            },
                            "mgname": {
                              "type": "string"
                            },
                            "subscriptionId": {
                              "type": "string"
                            },
                            "resourceGroupId": {
                              "type": "string"
                            },
                            "customerTags": {
                              "type": "object"
                            },
                            "instanceName": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "rulename": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "ruleshortname": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "tempTags": {
                              "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                              "MonitoringPackType": "IaaS",
                              "solutionVersion": "[parameters('solutionVersion')]"
                            },
                            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                            "workspaceFriendlyName": "[split(parameters('workspaceId'), '/')[8]]",
                            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
                            "kind": "Windows",
                            "xPathQueries": [
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=83) and (Provider[@Name='Microsoft-Windows-PrintBRM' or @Name='PrintBrm'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=360) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Operational!*[System[(EventID=701 or EventID=702 or EventID=703 or EventID=704) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=364 or EventID=365 or EventID=367) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=315) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=371) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=356) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=513 or EventID=514) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=600 or EventID=601) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=515 or EventID=516 or EventID=517 or EventID=518 or EventID=519 or EventID=520) and (Provider[@Name='Microsoft-Windows-PrintService'])]]",
                              "Microsoft-Windows-PrintService/Admin!*[System[(EventID=502 or EventID=503 or EventID=504 or EventID=505 or EventID=506 or EventID=507 or EventID=508 or EventID=509 or EventID=510 or EventID=511 or EventID=512) and (Provider[@Name='Microsoft-Windows-PrintService'])]]"
                            ],
                            "performanceCounters": [
                              "\\Print Queue(_Total)\\Jobs",
                              "\\Print Queue(_Total)\\Jobs Spooling",
                              "\\Print Queue(_Total)\\Total Jobs Printed",
                              "\\Print Queue(_Total)\\Total Pages Printed"
                            ]
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('dcrPerformance-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "rulename": {
                                    "value": "[variables('rulename')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "wsfriendlyname": {
                                    "value": "[variables('workspaceFriendlyName')]"
                                  },
                                  "kind": {
                                    "value": "[variables('kind')]"
                                  },
                                  "xPathQueries": {
                                    "value": "[variables('xPathQueries')]"
                                  },
                                  "counterSpecifiers": {
                                    "value": "[variables('performanceCounters')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "dceId": {
                                    "value": "[parameters('dceId')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "15691414683408659274"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "rulename": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "kind": {
                                      "type": "string",
                                      "defaultValue": "Windows"
                                    },
                                    "wsfriendlyname": {
                                      "type": "string",
                                      "defaultValue": "TBD"
                                    },
                                    "xPathQueries": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "counterSpecifiers": {
                                      "type": "array",
                                      "defaultValue": []
                                    },
                                    "samplingFrequencyInSeconds": {
                                      "type": "int",
                                      "defaultValue": 300
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "dceId": {
                                      "type": "string"
                                    }
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('rulename')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "[parameters('kind')]",
                                      "properties": {
                                        "dataCollectionEndpointId": "[parameters('dceId')]",
                                        "description": "[format('Data Collection Rule for {0}}} - {1}}}', parameters('kind'), parameters('rulename'))]",
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('workspaceId')]",
                                              "name": "[parameters('wsfriendlyname')]"
                                            }
                                          ]
                                        },
                                        "dataSources": {
                                          "windowsEventLogs": "[if(empty(parameters('xPathQueries')), null(), createArray(createObject('streams', createArray('Microsoft-Event'), 'xPathQueries', parameters('xPathQueries'), 'name', 'EventLogsDataSource')))]",
                                          "performanceCounters": [
                                            {
                                              "streams": [
                                                "Microsoft-Perf"
                                              ],
                                              "samplingFrequencyInSeconds": "[parameters('samplingFrequencyInSeconds')]",
                                              "counterSpecifiers": "[parameters('counterSpecifiers')]",
                                              "name": "PerfCountersDataSource"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-Event",
                                              "Microsoft-Perf"
                                            ],
                                            "destinations": [
                                              "[parameters('wsfriendlyname')]"
                                            ]
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "dcrId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('rulename'))]"
                                    }
                                  }
                                }
                              }
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('Alerts-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "AGId": {
                                    "value": "[parameters('actionGroupResourceId')]"
                                  },
                                  "packtag": {
                                    "value": "[parameters('packtag')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "instanceName": {
                                    "value": "[parameters('instanceName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "5768752023116223663"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "AGId": {
                                      "type": "string"
                                    },
                                    "packtag": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "instanceName": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "moduleprefix": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                                    "alertlist": [
                                      {
                                        "alertRuleDescription": "Ensure the server is accessible.",
                                        "alertRuleDisplayName": "Ensure the server is accessible.",
                                        "alertRuleName": "AlertRule-PS-2016-1",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (83) and EventLog == 'Microsoft-Windows-PrintService/Admin' and (Source == 'Microsoft-Windows-PrintBRM' or Source == 'PrintBrm')"
                                      },
                                      {
                                        "alertRuleDescription": "Manually install the color profile.",
                                        "alertRuleDisplayName": "Manually install the color profile.",
                                        "alertRuleName": "AlertRule-PS-2016-2",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (360) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Retry printing or restart the print server.",
                                        "alertRuleDisplayName": "Retry printing or restart the print server.",
                                        "alertRuleName": "AlertRule-PS-2016-3",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (701,702,703,704) and EventLog == 'Microsoft-Windows-PrintService/Operational!*' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Install the Printer Driver.",
                                        "alertRuleDisplayName": "Install the Printer Driver.",
                                        "alertRuleName": "AlertRule-PS-2016-4",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (364,365,367) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Restart the print spooler fix sharing problems and check Group Policy.",
                                        "alertRuleDisplayName": "Restart the print spooler fix sharing problems and check Group Policy.",
                                        "alertRuleName": "AlertRule-PS-2016-5",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (315) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Restart the print spooler and unshare the printer.",
                                        "alertRuleDisplayName": "Restart the print spooler and unshare the printer.",
                                        "alertRuleName": "AlertRule-PS-2016-6",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (371) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Update the printer driver.",
                                        "alertRuleDisplayName": "Update the printer driver.",
                                        "alertRuleName": "AlertRule-PS-2016-7",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (356) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Check Group Policy and network connectivity.",
                                        "alertRuleDisplayName": "Check Group Policy and network connectivity.",
                                        "alertRuleName": "AlertRule-PS-2016-8",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (513,514) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Try again or install an updated printer driver.",
                                        "alertRuleDisplayName": "Try again or install an updated printer driver.",
                                        "alertRuleName": "AlertRule-PS-2016-9",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (600,601) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Check network connectivity and Group Policy.",
                                        "alertRuleDisplayName": "Check network connectivity and Group Policy.",
                                        "alertRuleName": "AlertRule-PS-2016-10",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (515,516,517,518,519,520) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      },
                                      {
                                        "alertRuleDescription": "Check resource availability.",
                                        "alertRuleDisplayName": "Check resource availability.",
                                        "alertRuleName": "AlertRule-PS-2016-11",
                                        "alertRuleSeverity": 2,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Event | where  EventID in (502,503,504,505,506,507,508,509,510,511,512) and EventLog == 'Microsoft-Windows-PrintService/Admin' and Source == 'Microsoft-Windows-PrintService'"
                                      }
                                    ]
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "[format('{0}-Alerts', variables('moduleprefix'))]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "alertlist": {
                                            "value": "[variables('alertlist')]"
                                          },
                                          "AGId": {
                                            "value": "[parameters('AGId')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "moduleprefix": {
                                            "value": "[variables('moduleprefix')]"
                                          },
                                          "packtag": {
                                            "value": "[parameters('packtag')]"
                                          },
                                          "Tags": {
                                            "value": "[parameters('Tags')]"
                                          },
                                          "workspaceId": {
                                            "value": "[parameters('workspaceId')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "17858688129795365440"
                                            }
                                          },
                                          "parameters": {
                                            "alertlist": {
                                              "type": "array"
                                            },
                                            "location": {
                                              "type": "string"
                                            },
                                            "workspaceId": {
                                              "type": "string"
                                            },
                                            "AGId": {
                                              "type": "string"
                                            },
                                            "packtag": {
                                              "type": "string"
                                            },
                                            "Tags": {
                                              "type": "object"
                                            },
                                            "moduleprefix": {
                                              "type": "string"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "copy": {
                                                "name": "Alerts",
                                                "count": "[length(parameters('alertlist'))]"
                                              },
                                              "type": "Microsoft.Resources/deployments",
                                              "apiVersion": "2022-09-01",
                                              "name": "[format('{0}-Alert-{1}', parameters('packtag'), copyIndex())]",
                                              "properties": {
                                                "expressionEvaluationOptions": {
                                                  "scope": "inner"
                                                },
                                                "mode": "Incremental",
                                                "parameters": {
                                                  "location": {
                                                    "value": "[parameters('location')]"
                                                  },
                                                  "actionGroupResourceId": {
                                                    "value": "[parameters('AGId')]"
                                                  },
                                                  "alertRuleDescription": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleDescription]"
                                                  },
                                                  "alertRuleDisplayName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleDisplayName)]"
                                                  },
                                                  "alertRuleName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleName)]"
                                                  },
                                                  "alertRuleSeverity": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleSeverity]"
                                                  },
                                                  "autoMitigate": {
                                                    "value": "[parameters('alertlist')[copyIndex()].autoMitigate]"
                                                  },
                                                  "evaluationFrequency": {
                                                    "value": "[parameters('alertlist')[copyIndex()].evaluationFrequency]"
                                                  },
                                                  "windowSize": {
                                                    "value": "[parameters('alertlist')[copyIndex()].windowSize]"
                                                  },
                                                  "scope": {
                                                    "value": "[parameters('workspaceId')]"
                                                  },
                                                  "query": {
                                                    "value": "[parameters('alertlist')[copyIndex()].query]"
                                                  },
                                                  "dimensions": "[if(contains(parameters('alertlist')[copyIndex()], 'dimensions'), createObject('value', parameters('alertlist')[copyIndex()].dimensions), createObject('value', null()))]",
                                                  "packtag": {
                                                    "value": "[parameters('packtag')]"
                                                  },
                                                  "Tags": {
                                                    "value": "[parameters('Tags')]"
                                                  },
                                                  "alertType": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertType]"
                                                  },
                                                  "metricMeasureColumn": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].metricMeasureColumn), createObject('value', null()))]",
                                                  "operator": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].operator), createObject('value', null()))]",
                                                  "threshold": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].threshold), createObject('value', null()))]"
                                                },
                                                "template": {
                                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                  "contentVersion": "1.0.0.0",
                                                  "metadata": {
                                                    "_generator": {
                                                      "name": "bicep",
                                                      "version": "0.32.4.45862",
                                                      "templateHash": "10159755056440989647"
                                                    }
                                                  },
                                                  "parameters": {
                                                    "alertType": {
                                                      "type": "string",
                                                      "allowedValues": [
                                                        "rows",
                                                        "Aggregated"
                                                      ]
                                                    },
                                                    "alertRuleName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDisplayName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDescription": {
                                                      "type": "string"
                                                    },
                                                    "scope": {
                                                      "type": "string"
                                                    },
                                                    "actionGroupResourceId": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleSeverity": {
                                                      "type": "int"
                                                    },
                                                    "location": {
                                                      "type": "string"
                                                    },
                                                    "windowSize": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "evaluationFrequency": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "autoMitigate": {
                                                      "type": "bool",
                                                      "defaultValue": false
                                                    },
                                                    "query": {
                                                      "type": "string"
                                                    },
                                                    "packtag": {
                                                      "type": "string"
                                                    },
                                                    "Tags": {
                                                      "type": "object"
                                                    },
                                                    "threshold": {
                                                      "type": "int",
                                                      "defaultValue": 0
                                                    },
                                                    "metricMeasureColumn": {
                                                      "type": "string",
                                                      "defaultValue": ""
                                                    },
                                                    "dimensions": {
                                                      "type": "array",
                                                      "defaultValue": [
                                                        {
                                                          "name": "Computer",
                                                          "operator": "Include",
                                                          "values": [
                                                            "*"
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    "operator": {
                                                      "type": "string",
                                                      "defaultValue": "GreaterThan",
                                                      "allowedValues": [
                                                        "GreaterThan",
                                                        "GreaterThanOrEqual",
                                                        "LessThan",
                                                        "LessThanOrEqual",
                                                        "Equal",
                                                        "NotEqual"
                                                      ]
                                                    }
                                                  },
                                                  "resources": [
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'rows')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "16566470716356207302"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Count",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "GreaterThan",
                                                                      "threshold": 0,
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    },
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'Aggregated')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          },
                                                          "threshold": {
                                                            "value": "[parameters('threshold')]"
                                                          },
                                                          "metricMeasureColumn": {
                                                            "value": "[parameters('metricMeasureColumn')]"
                                                          },
                                                          "operator": {
                                                            "value": "[parameters('operator')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "18444959286864838274"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "threshold": {
                                                              "type": "int"
                                                            },
                                                            "metricMeasureColumn": {
                                                              "type": "string"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            },
                                                            "operator": {
                                                              "type": "string",
                                                              "allowedValues": [
                                                                "GreaterThan",
                                                                "GreaterThanOrEqual",
                                                                "LessThan",
                                                                "LessThanOrEqual",
                                                                "Equal",
                                                                "NotEqual"
                                                              ]
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Average",
                                                                      "metricMeasureColumn": "[parameters('metricMeasureColumn')]",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "[parameters('operator')]",
                                                                      "threshold": "[parameters('threshold')]",
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    }
                                                  ]
                                                }
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  ]
                                }
                              }
                            }
                          ]
                        }
                      }
                    },
                    {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('Nginx-deployment-{0}-{1}', parameters('instanceName'), parameters('location'))]",
                      "location": "[deployment().location]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dceId": {
                            "value": "[parameters('dceId')]"
                          },
                          "location": {
                            "value": "[parameters('location')]"
                          },
                          "mgname": {
                            "value": "[parameters('mgname')]"
                          },
                          "resourceGroupId": {
                            "value": "[parameters('resourceGroupId')]"
                          },
                          "solutionTag": {
                            "value": "[parameters('solutionTag')]"
                          },
                          "solutionVersion": {
                            "value": "[parameters('solutionVersion')]"
                          },
                          "subscriptionId": {
                            "value": "[parameters('subscriptionId')]"
                          },
                          "userManagedIdentityResourceId": {
                            "value": "[parameters('userManagedIdentityResourceId')]"
                          },
                          "workspaceId": {
                            "value": "[parameters('workspaceId')]"
                          },
                          "customerTags": {
                            "value": "[parameters('customerTags')]"
                          },
                          "actionGroupResourceId": {
                            "value": "[parameters('actionGroupResourceId')]"
                          },
                          "instanceName": {
                            "value": "[parameters('instanceName')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.32.4.45862",
                              "templateHash": "4733957926130615059"
                            }
                          },
                          "parameters": {
                            "actionGroupResourceId": {
                              "type": "string"
                            },
                            "location": {
                              "type": "string",
                              "metadata": {
                                "description": "location for the deployment."
                              }
                            },
                            "workspaceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the log analytics workspace to be used for the deployment."
                              }
                            },
                            "packtag": {
                              "type": "string",
                              "defaultValue": "Nginx"
                            },
                            "solutionTag": {
                              "type": "string"
                            },
                            "solutionVersion": {
                              "type": "string"
                            },
                            "dceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the data collection endpoint to be used for the deployment."
                              }
                            },
                            "userManagedIdentityResourceId": {
                              "type": "string",
                              "metadata": {
                                "description": "Full resource ID of the user managed identity to be used for the deployment"
                              }
                            },
                            "mgname": {
                              "type": "string"
                            },
                            "subscriptionId": {
                              "type": "string"
                            },
                            "resourceGroupId": {
                              "type": "string"
                            },
                            "customerTags": {
                              "type": "object"
                            },
                            "instanceName": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "tableName": "NginxLogs",
                            "tableNameToUse": "[format('{0}_CL', variables('tableName'))]",
                            "lawFriendlyName": "[split(parameters('workspaceId'), '/')[8]]",
                            "rulename": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "ruleshortname": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                            "tempTags": {
                              "[format('{0}', parameters('solutionTag'))]": "[parameters('packtag')]",
                              "MonitoringPackType": "IaaS",
                              "solutionVersion": "[parameters('solutionVersion')]"
                            },
                            "filePatterns": [
                              "/var/log/nginx/access.log",
                              "/var/log/nginx/error.log"
                            ],
                            "Tags": "[if(equals(parameters('customerTags'), createObject()), variables('tempTags'), union(variables('tempTags'), parameters('customerTags').All))]",
                            "resourceGroupName": "[split(parameters('resourceGroupId'), '/')[4]]",
                            "lawResourceGroup": "[split(parameters('workspaceId'), '/')[4]]",
                            "facilityNames": [
                              "daemon"
                            ],
                            "logLevels": [
                              "Debug",
                              "Info",
                              "Notice",
                              "Warning",
                              "Error",
                              "Critical",
                              "Alert",
                              "Emergency"
                            ]
                          },
                          "resources": [
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[variables('tableName')]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('lawResourceGroup')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "parentname": {
                                    "value": "[variables('lawFriendlyName')]"
                                  },
                                  "tableName": {
                                    "value": "[variables('tableNameToUse')]"
                                  },
                                  "retentionDays": {
                                    "value": 31
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "2081426938105913058"
                                    }
                                  },
                                  "parameters": {
                                    "parentname": {
                                      "type": "string"
                                    },
                                    "tableName": {
                                      "type": "string"
                                    },
                                    "retentionDays": {
                                      "type": "int",
                                      "defaultValue": 31
                                    }
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.OperationalInsights/workspaces/tables",
                                      "apiVersion": "2022-10-01",
                                      "name": "[format('{0}/{1}', parameters('parentname'), parameters('tableName'))]",
                                      "properties": {
                                        "totalRetentionInDays": "[parameters('retentionDays')]",
                                        "plan": "Analytics",
                                        "schema": {
                                          "name": "[parameters('tableName')]",
                                          "columns": [
                                            {
                                              "name": "TimeGenerated",
                                              "type": "datetime"
                                            },
                                            {
                                              "name": "RawData",
                                              "type": "string"
                                            }
                                          ]
                                        },
                                        "retentionInDays": "[parameters('retentionDays')]"
                                      }
                                    }
                                  ]
                                }
                              }
                            },
                            {
                              "copy": {
                                "name": "fileCollectionRule",
                                "count": "[length(variables('filePatterns'))]"
                              },
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('filecollectionrule-{0}-{1}', parameters('packtag'), copyIndex())]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "endpointResourceId": {
                                    "value": "[parameters('dceId')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "ruleName": {
                                    "value": "[format('{0}-{1}', variables('rulename'), copyIndex())]"
                                  },
                                  "filepatterns": {
                                    "value": [
                                      "[variables('filePatterns')[copyIndex()]]"
                                    ]
                                  },
                                  "lawResourceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "tableName": {
                                    "value": "[variables('tableNameToUse')]"
                                  },
                                  "facilityNames": {
                                    "value": "[variables('facilityNames')]"
                                  },
                                  "logLevels": {
                                    "value": "[variables('logLevels')]"
                                  },
                                  "syslogDataSourceName": {
                                    "value": "NginxLogs-1238219"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "1791385127478685010"
                                    }
                                  },
                                  "parameters": {
                                    "ruleName": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the name of the data collection rule to create."
                                      }
                                    },
                                    "endpointResourceId": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the resource id of the data collection endpoint."
                                      }
                                    },
                                    "tableName": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Name of the table."
                                      }
                                    },
                                    "location": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "Specifies the location in which to create the data collection rule."
                                      }
                                    },
                                    "filepatterns": {
                                      "type": "array"
                                    },
                                    "lawResourceId": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "facilityNames": {
                                      "type": "array"
                                    },
                                    "logLevels": {
                                      "type": "array"
                                    },
                                    "syslogDataSourceName": {
                                      "type": "string",
                                      "defaultValue": "sysLogsDataSource-1688419672"
                                    }
                                  },
                                  "variables": {
                                    "streamName": "[format('Custom-{0}', parameters('tableName'))]",
                                    "lawFriendlyName": "[split(parameters('lawResourceId'), '/')[8]]"
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Insights/dataCollectionRules",
                                      "apiVersion": "2022-06-01",
                                      "name": "[parameters('ruleName')]",
                                      "location": "[parameters('location')]",
                                      "tags": "[parameters('Tags')]",
                                      "kind": "Linux",
                                      "properties": {
                                        "dataSources": {
                                          "syslog": [
                                            {
                                              "streams": [
                                                "Microsoft-Syslog"
                                              ],
                                              "facilityNames": "[parameters('facilityNames')]",
                                              "logLevels": "[parameters('logLevels')]",
                                              "name": "[parameters('syslogDataSourceName')]"
                                            }
                                          ],
                                          "logFiles": [
                                            {
                                              "streams": [
                                                "[variables('streamName')]"
                                              ],
                                              "filePatterns": "[parameters('filepatterns')]",
                                              "format": "text",
                                              "settings": {
                                                "text": {
                                                  "recordStartTimestampFormat": "ISO 8601"
                                                }
                                              },
                                              "name": "[parameters('tableName')]"
                                            }
                                          ]
                                        },
                                        "destinations": {
                                          "logAnalytics": [
                                            {
                                              "workspaceResourceId": "[parameters('lawResourceId')]",
                                              "name": "[variables('lawFriendlyName')]"
                                            }
                                          ]
                                        },
                                        "dataFlows": [
                                          {
                                            "streams": [
                                              "Microsoft-Syslog"
                                            ],
                                            "destinations": [
                                              "[variables('lawFriendlyName')]"
                                            ],
                                            "transformKql": "source | where SyslogMessage == \"Stopped A high performance web server and a reverse proxy server.\" or SyslogMessage == \"Started A high performance web server and a reverse proxy server.\"",
                                            "outputStream": "Microsoft-Syslog"
                                          },
                                          {
                                            "streams": [
                                              "[variables('streamName')]"
                                            ],
                                            "destinations": [
                                              "[variables('lawFriendlyName')]"
                                            ],
                                            "transformKql": "source",
                                            "outputStream": "[variables('streamName')]"
                                          }
                                        ],
                                        "dataCollectionEndpointId": "[parameters('endpointResourceId')]",
                                        "streamDeclarations": {
                                          "[format('{0}', variables('streamName'))]": {
                                            "columns": [
                                              {
                                                "name": "TimeGenerated",
                                                "type": "datetime"
                                              },
                                              {
                                                "name": "RawData",
                                                "type": "string"
                                              }
                                            ]
                                          }
                                        }
                                      }
                                    }
                                  ],
                                  "outputs": {
                                    "ruleId": {
                                      "type": "string",
                                      "value": "[resourceId('Microsoft.Insights/dataCollectionRules', parameters('ruleName'))]"
                                    }
                                  }
                                }
                              },
                              "dependsOn": [
                                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), variables('lawResourceGroup')), 'Microsoft.Resources/deployments', variables('tableName'))]"
                              ]
                            },
                            {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "[format('Alerts-{0}', parameters('packtag'))]",
                              "subscriptionId": "[parameters('subscriptionId')]",
                              "resourceGroup": "[variables('resourceGroupName')]",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "location": {
                                    "value": "[parameters('location')]"
                                  },
                                  "workspaceId": {
                                    "value": "[parameters('workspaceId')]"
                                  },
                                  "AGId": {
                                    "value": "[parameters('actionGroupResourceId')]"
                                  },
                                  "packtag": {
                                    "value": "[parameters('packtag')]"
                                  },
                                  "Tags": {
                                    "value": "[variables('Tags')]"
                                  },
                                  "instanceName": {
                                    "value": "[parameters('instanceName')]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.32.4.45862",
                                      "templateHash": "17575300843145168501"
                                    }
                                  },
                                  "parameters": {
                                    "location": {
                                      "type": "string"
                                    },
                                    "workspaceId": {
                                      "type": "string"
                                    },
                                    "AGId": {
                                      "type": "string"
                                    },
                                    "packtag": {
                                      "type": "string"
                                    },
                                    "Tags": {
                                      "type": "object"
                                    },
                                    "instanceName": {
                                      "type": "string"
                                    }
                                  },
                                  "variables": {
                                    "moduleprefix": "[format('AMP-{0}-{1}', parameters('instanceName'), parameters('packtag'))]",
                                    "alertlist": [
                                      {
                                        "alertRuleDescription": "Nginx stopped.",
                                        "alertRuleDisplayName": "Nginx service stopped.",
                                        "alertRuleName": "AlertRule-Nginx-1",
                                        "alertRuleSeverity": 1,
                                        "autoMitigate": true,
                                        "evaluationFrequency": "PT15M",
                                        "windowSize": "PT15M",
                                        "alertType": "rows",
                                        "query": "Syslog | where SyslogMessage == \"Stopped A high performance web server and a reverse proxy server.\""
                                      }
                                    ]
                                  },
                                  "resources": [
                                    {
                                      "type": "Microsoft.Resources/deployments",
                                      "apiVersion": "2022-09-01",
                                      "name": "[format('{0}-Alerts', variables('moduleprefix'))]",
                                      "properties": {
                                        "expressionEvaluationOptions": {
                                          "scope": "inner"
                                        },
                                        "mode": "Incremental",
                                        "parameters": {
                                          "alertlist": {
                                            "value": "[variables('alertlist')]"
                                          },
                                          "AGId": {
                                            "value": "[parameters('AGId')]"
                                          },
                                          "location": {
                                            "value": "[parameters('location')]"
                                          },
                                          "moduleprefix": {
                                            "value": "[variables('moduleprefix')]"
                                          },
                                          "packtag": {
                                            "value": "[parameters('packtag')]"
                                          },
                                          "Tags": {
                                            "value": "[parameters('Tags')]"
                                          },
                                          "workspaceId": {
                                            "value": "[parameters('workspaceId')]"
                                          }
                                        },
                                        "template": {
                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                          "contentVersion": "1.0.0.0",
                                          "metadata": {
                                            "_generator": {
                                              "name": "bicep",
                                              "version": "0.32.4.45862",
                                              "templateHash": "17858688129795365440"
                                            }
                                          },
                                          "parameters": {
                                            "alertlist": {
                                              "type": "array"
                                            },
                                            "location": {
                                              "type": "string"
                                            },
                                            "workspaceId": {
                                              "type": "string"
                                            },
                                            "AGId": {
                                              "type": "string"
                                            },
                                            "packtag": {
                                              "type": "string"
                                            },
                                            "Tags": {
                                              "type": "object"
                                            },
                                            "moduleprefix": {
                                              "type": "string"
                                            }
                                          },
                                          "resources": [
                                            {
                                              "copy": {
                                                "name": "Alerts",
                                                "count": "[length(parameters('alertlist'))]"
                                              },
                                              "type": "Microsoft.Resources/deployments",
                                              "apiVersion": "2022-09-01",
                                              "name": "[format('{0}-Alert-{1}', parameters('packtag'), copyIndex())]",
                                              "properties": {
                                                "expressionEvaluationOptions": {
                                                  "scope": "inner"
                                                },
                                                "mode": "Incremental",
                                                "parameters": {
                                                  "location": {
                                                    "value": "[parameters('location')]"
                                                  },
                                                  "actionGroupResourceId": {
                                                    "value": "[parameters('AGId')]"
                                                  },
                                                  "alertRuleDescription": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleDescription]"
                                                  },
                                                  "alertRuleDisplayName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleDisplayName)]"
                                                  },
                                                  "alertRuleName": {
                                                    "value": "[format('{0}-{1}', parameters('moduleprefix'), parameters('alertlist')[copyIndex()].alertRuleName)]"
                                                  },
                                                  "alertRuleSeverity": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertRuleSeverity]"
                                                  },
                                                  "autoMitigate": {
                                                    "value": "[parameters('alertlist')[copyIndex()].autoMitigate]"
                                                  },
                                                  "evaluationFrequency": {
                                                    "value": "[parameters('alertlist')[copyIndex()].evaluationFrequency]"
                                                  },
                                                  "windowSize": {
                                                    "value": "[parameters('alertlist')[copyIndex()].windowSize]"
                                                  },
                                                  "scope": {
                                                    "value": "[parameters('workspaceId')]"
                                                  },
                                                  "query": {
                                                    "value": "[parameters('alertlist')[copyIndex()].query]"
                                                  },
                                                  "dimensions": "[if(contains(parameters('alertlist')[copyIndex()], 'dimensions'), createObject('value', parameters('alertlist')[copyIndex()].dimensions), createObject('value', null()))]",
                                                  "packtag": {
                                                    "value": "[parameters('packtag')]"
                                                  },
                                                  "Tags": {
                                                    "value": "[parameters('Tags')]"
                                                  },
                                                  "alertType": {
                                                    "value": "[parameters('alertlist')[copyIndex()].alertType]"
                                                  },
                                                  "metricMeasureColumn": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].metricMeasureColumn), createObject('value', null()))]",
                                                  "operator": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].operator), createObject('value', null()))]",
                                                  "threshold": "[if(equals(parameters('alertlist')[copyIndex()].alertType, 'Aggregated'), createObject('value', parameters('alertlist')[copyIndex()].threshold), createObject('value', null()))]"
                                                },
                                                "template": {
                                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                  "contentVersion": "1.0.0.0",
                                                  "metadata": {
                                                    "_generator": {
                                                      "name": "bicep",
                                                      "version": "0.32.4.45862",
                                                      "templateHash": "10159755056440989647"
                                                    }
                                                  },
                                                  "parameters": {
                                                    "alertType": {
                                                      "type": "string",
                                                      "allowedValues": [
                                                        "rows",
                                                        "Aggregated"
                                                      ]
                                                    },
                                                    "alertRuleName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDisplayName": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleDescription": {
                                                      "type": "string"
                                                    },
                                                    "scope": {
                                                      "type": "string"
                                                    },
                                                    "actionGroupResourceId": {
                                                      "type": "string"
                                                    },
                                                    "alertRuleSeverity": {
                                                      "type": "int"
                                                    },
                                                    "location": {
                                                      "type": "string"
                                                    },
                                                    "windowSize": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "evaluationFrequency": {
                                                      "type": "string",
                                                      "defaultValue": "PT15M"
                                                    },
                                                    "autoMitigate": {
                                                      "type": "bool",
                                                      "defaultValue": false
                                                    },
                                                    "query": {
                                                      "type": "string"
                                                    },
                                                    "packtag": {
                                                      "type": "string"
                                                    },
                                                    "Tags": {
                                                      "type": "object"
                                                    },
                                                    "threshold": {
                                                      "type": "int",
                                                      "defaultValue": 0
                                                    },
                                                    "metricMeasureColumn": {
                                                      "type": "string",
                                                      "defaultValue": ""
                                                    },
                                                    "dimensions": {
                                                      "type": "array",
                                                      "defaultValue": [
                                                        {
                                                          "name": "Computer",
                                                          "operator": "Include",
                                                          "values": [
                                                            "*"
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    "operator": {
                                                      "type": "string",
                                                      "defaultValue": "GreaterThan",
                                                      "allowedValues": [
                                                        "GreaterThan",
                                                        "GreaterThanOrEqual",
                                                        "LessThan",
                                                        "LessThanOrEqual",
                                                        "Equal",
                                                        "NotEqual"
                                                      ]
                                                    }
                                                  },
                                                  "resources": [
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'rows')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "16566470716356207302"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Count",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "GreaterThan",
                                                                      "threshold": 0,
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    },
                                                    {
                                                      "condition": "[equals(parameters('alertType'), 'Aggregated')]",
                                                      "type": "Microsoft.Resources/deployments",
                                                      "apiVersion": "2022-09-01",
                                                      "name": "[parameters('alertRuleName')]",
                                                      "properties": {
                                                        "expressionEvaluationOptions": {
                                                          "scope": "inner"
                                                        },
                                                        "mode": "Incremental",
                                                        "parameters": {
                                                          "alertRuleName": {
                                                            "value": "[parameters('alertRuleName')]"
                                                          },
                                                          "alertRuleDisplayName": {
                                                            "value": "[parameters('alertRuleDisplayName')]"
                                                          },
                                                          "alertRuleDescription": {
                                                            "value": "[parameters('alertRuleDescription')]"
                                                          },
                                                          "scope": {
                                                            "value": "[parameters('scope')]"
                                                          },
                                                          "dimensions": {
                                                            "value": "[parameters('dimensions')]"
                                                          },
                                                          "actionGroupResourceId": {
                                                            "value": "[parameters('actionGroupResourceId')]"
                                                          },
                                                          "alertRuleSeverity": {
                                                            "value": "[parameters('alertRuleSeverity')]"
                                                          },
                                                          "location": {
                                                            "value": "[parameters('location')]"
                                                          },
                                                          "windowSize": {
                                                            "value": "[parameters('windowSize')]"
                                                          },
                                                          "evaluationFrequency": {
                                                            "value": "[parameters('evaluationFrequency')]"
                                                          },
                                                          "autoMitigate": {
                                                            "value": "[parameters('autoMitigate')]"
                                                          },
                                                          "query": {
                                                            "value": "[parameters('query')]"
                                                          },
                                                          "Tags": {
                                                            "value": "[parameters('Tags')]"
                                                          },
                                                          "threshold": {
                                                            "value": "[parameters('threshold')]"
                                                          },
                                                          "metricMeasureColumn": {
                                                            "value": "[parameters('metricMeasureColumn')]"
                                                          },
                                                          "operator": {
                                                            "value": "[parameters('operator')]"
                                                          }
                                                        },
                                                        "template": {
                                                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                                          "contentVersion": "1.0.0.0",
                                                          "metadata": {
                                                            "_generator": {
                                                              "name": "bicep",
                                                              "version": "0.32.4.45862",
                                                              "templateHash": "18444959286864838274"
                                                            }
                                                          },
                                                          "parameters": {
                                                            "alertRuleName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDisplayName": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleDescription": {
                                                              "type": "string"
                                                            },
                                                            "scope": {
                                                              "type": "string"
                                                            },
                                                            "actionGroupResourceId": {
                                                              "type": "string"
                                                            },
                                                            "alertRuleSeverity": {
                                                              "type": "int"
                                                            },
                                                            "location": {
                                                              "type": "string"
                                                            },
                                                            "windowSize": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "evaluationFrequency": {
                                                              "type": "string",
                                                              "defaultValue": "PT15M"
                                                            },
                                                            "autoMitigate": {
                                                              "type": "bool",
                                                              "defaultValue": false
                                                            },
                                                            "query": {
                                                              "type": "string"
                                                            },
                                                            "dimensions": {
                                                              "type": "array"
                                                            },
                                                            "threshold": {
                                                              "type": "int"
                                                            },
                                                            "metricMeasureColumn": {
                                                              "type": "string"
                                                            },
                                                            "Tags": {
                                                              "type": "object"
                                                            },
                                                            "operator": {
                                                              "type": "string",
                                                              "allowedValues": [
                                                                "GreaterThan",
                                                                "GreaterThanOrEqual",
                                                                "LessThan",
                                                                "LessThanOrEqual",
                                                                "Equal",
                                                                "NotEqual"
                                                              ]
                                                            }
                                                          },
                                                          "resources": [
                                                            {
                                                              "type": "Microsoft.Insights/scheduledQueryRules",
                                                              "apiVersion": "2023-03-15-preview",
                                                              "name": "[parameters('alertRuleName')]",
                                                              "location": "[parameters('location')]",
                                                              "tags": "[parameters('Tags')]",
                                                              "properties": {
                                                                "description": "[parameters('alertRuleDescription')]",
                                                                "ruleResolveConfiguration": {},
                                                                "displayName": "[parameters('alertRuleDisplayName')]",
                                                                "enabled": true,
                                                                "scopes": [
                                                                  "[parameters('scope')]"
                                                                ],
                                                                "targetResourceTypes": [
                                                                  "Microsoft.OperationalInsights/workspaces"
                                                                ],
                                                                "windowSize": "[parameters('windowSize')]",
                                                                "evaluationFrequency": "[parameters('evaluationFrequency')]",
                                                                "severity": "[parameters('alertRuleSeverity')]",
                                                                "criteria": {
                                                                  "allOf": [
                                                                    {
                                                                      "query": "[parameters('query')]",
                                                                      "timeAggregation": "Average",
                                                                      "metricMeasureColumn": "[parameters('metricMeasureColumn')]",
                                                                      "dimensions": "[parameters('dimensions')]",
                                                                      "resourceIdColumn": "[if(empty(parameters('dimensions')), '_ResourceId', null())]",
                                                                      "operator": "[parameters('operator')]",
                                                                      "threshold": "[parameters('threshold')]",
                                                                      "failingPeriods": {
                                                                        "numberOfEvaluationPeriods": 1,
                                                                        "minFailingPeriodsToAlert": 1
                                                                      }
                                                                    }
                                                                  ]
                                                                },
                                                                "autoMitigate": "[parameters('autoMitigate')]",
                                                                "actions": {
                                                                  "actionGroups": [
                                                                    "[parameters('actionGroupResourceId')]"
                                                                  ],
                                                                  "customProperties": {}
                                                                }
                                                              }
                                                            }
                                                          ]
                                                        }
                                                      }
                                                    }
                                                  ]
                                                }
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  ]
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  ]
                }
              },
              "dependsOn": [
                "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), variables('resourceGroupName')), 'Microsoft.Resources/deployments', format('deployAG-new-{0}-{1}', parameters('actionGroupName'), parameters('location')))]"
              ]
            },
            {
              "condition": "[parameters('deployGrafana')]",
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "grafana",
              "subscriptionId": "[parameters('subscriptionId')]",
              "resourceGroup": "[variables('resourceGroupName')]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "fileName": {
                    "value": "grafana.zip"
                  },
                  "grafanaResourceId": {
                    "value": "[parameters('grafanaResourceId')]"
                  },
                  "location": {
                    "value": "[parameters('location')]"
                  },
                  "resourceGroupName": {
                    "value": "[variables('resourceGroupName')]"
                  },
                  "customerTags": {
                    "value": "[parameters('customerTags')]"
                  },
                  "packsManagedIdentityResourceId": {
                    "value": "[parameters('userManagedIdentityResourceId')]"
                  },
                  "solutionTag": {
                    "value": "[parameters('solutionTag')]"
                  },
                  "solutionVersion": {
                    "value": "[parameters('solutionVersion')]"
                  },
                  "instanceName": {
                    "value": "[parameters('instanceName')]"
                  },
                  "subscriptionId": {
                    "value": "[parameters('subscriptionId')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.32.4.45862",
                      "templateHash": "8858171580267209258"
                    }
                  },
                  "parameters": {
                    "location": {
                      "type": "string"
                    },
                    "resourceGroupName": {
                      "type": "string"
                    },
                    "grafanaResourceId": {
                      "type": "string"
                    },
                    "fileName": {
                      "type": "string"
                    },
                    "packsManagedIdentityResourceId": {
                      "type": "string"
                    },
                    "customerTags": {
                      "type": "object"
                    },
                    "solutionTag": {
                      "type": "string"
                    },
                    "solutionVersion": {
                      "type": "string"
                    },
                    "instanceName": {
                      "type": "string"
                    },
                    "subscriptionId": {
                      "type": "string"
                    }
                  },
                  "variables": {
                    "$fxv#0": "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",
                    "grafanaName": "[split(parameters('grafanaResourceId'), '/')[8]]",
                    "tempfilename": "[format('{0}.tmp', parameters('fileName'))]",
                    "Tags": "[if(equals(parameters('customerTags'), createObject()), createObject(format('{0}', parameters('solutionTag')), parameters('solutionTag'), 'solutionVersion', parameters('solutionVersion')), union(createObject(format('{0}', parameters('solutionTag')), parameters('solutionTag'), 'solutionVersion', parameters('solutionVersion'), 'instanceName', parameters('instanceName')), parameters('customerTags').All))]"
                  },
                  "resources": [
                    {
                      "type": "Microsoft.Resources/deploymentScripts",
                      "apiVersion": "2020-10-01",
                      "name": "deployscript-Grafana",
                      "tags": "[variables('Tags')]",
                      "location": "[parameters('location')]",
                      "identity": {
                        "type": "userAssigned",
                        "userAssignedIdentities": {
                          "[format('{0}', parameters('packsManagedIdentityResourceId'))]": {}
                        }
                      },
                      "kind": "AzureCLI",
                      "properties": {
                        "azCliVersion": "2.42.0",
                        "timeout": "PT5M",
                        "retentionInterval": "PT1H",
                        "environmentVariables": [
                          {
                            "name": "CONTENT",
                            "value": "[variables('$fxv#0')]"
                          }
                        ],
                        "scriptContent": "[format('echo \"$CONTENT\" > {0} && cat {1} | base64 -d > {2} && az extension add --name amg && az login --identity && unzip {3} && for file in *.json; do az grafana dashboard import -g {4} -n {5} --subscription {6} --definition \"$file\" --overwrite true;done', variables('tempfilename'), variables('tempfilename'), parameters('fileName'), parameters('fileName'), parameters('resourceGroupName'), variables('grafanaName'), parameters('subscriptionId'))]"
                      }
                    }
                  ]
                }
              }
            }
          ]
        }
      },
      "dependsOn": [
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', format('azureManagedGrafana-{0}', parameters('instanceName')))]",
        "[extensionResourceId(managementGroup().id, 'Microsoft.Resources/deployments', format('MonitoringPacks-backend-{0}', parameters('instanceName')))]",
        "[extensionResourceId(format('/subscriptions/{0}/resourceGroups/{1}', parameters('subscriptionId'), parameters('resourceGroupName')), 'Microsoft.Resources/deployments', 'logAnalytics-Deployment')]",
        "[subscriptionResourceId(parameters('subscriptionId'), 'Microsoft.Resources/deployments', format('RGMonitoringPacks-{0}-{1}', parameters('location'), parameters('instanceName')))]"
      ]
    }
  ]
}